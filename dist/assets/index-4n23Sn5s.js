const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-DE3DV3yI.js","assets/webworkerAll-Cg4ThL1j.js","assets/colorToUniform-CewHMd7J.js","assets/WebGPURenderer-D3d7mZWv.js","assets/SharedSystems-D9NMOUh9.js","assets/WebGLRenderer-Dn84z-A8.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();function ze(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}function va(i){if(Object.prototype.hasOwnProperty.call(i,"__esModule"))return i;var t=i.default;if(typeof t=="function"){var e=function s(){var r=!1;try{r=this instanceof s}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(i).forEach(function(s){var r=Object.getOwnPropertyDescriptor(i,s);Object.defineProperty(e,s,r.get?r:{enumerable:!0,get:function(){return i[s]}})}),e}var Ls,hr;function Aa(){if(hr)return Ls;hr=1;const i=t=>{const e=new Set;do for(const s of Reflect.ownKeys(t))e.add([t,s]);while((t=Reflect.getPrototypeOf(t))&&t!==Object.prototype);return e};return Ls=(t,{include:e,exclude:s}={})=>{const r=n=>{const o=a=>typeof a=="string"?n===a:a.test(n);return e?e.some(o):s?!s.some(o):!0};for(const[n,o]of i(t.constructor.prototype)){if(o==="constructor"||!r(o))continue;const a=Reflect.getOwnPropertyDescriptor(n,o);a&&typeof a.value=="function"&&(t[o]=t[o].bind(t))}return t},Ls}var Sa=Aa();const Fi=ze(Sa);var as={exports:{}},Pa=as.exports,cr;function Wn(){return cr||(cr=1,(function(i){(function(t,e,s){function r(l){var h=this,c=a();h.next=function(){var u=2091639*h.s0+h.c*23283064365386963e-26;return h.s0=h.s1,h.s1=h.s2,h.s2=u-(h.c=u|0)},h.c=1,h.s0=c(" "),h.s1=c(" "),h.s2=c(" "),h.s0-=c(l),h.s0<0&&(h.s0+=1),h.s1-=c(l),h.s1<0&&(h.s1+=1),h.s2-=c(l),h.s2<0&&(h.s2+=1),c=null}function n(l,h){return h.c=l.c,h.s0=l.s0,h.s1=l.s1,h.s2=l.s2,h}function o(l,h){var c=new r(l),u=h&&h.state,d=c.next;return d.int32=function(){return c.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,u&&(typeof u=="object"&&n(u,c),d.state=function(){return n(c,{})}),d}function a(){var l=4022871197,h=function(c){c=String(c);for(var u=0;u<c.length;u++){l+=c.charCodeAt(u);var d=.02519603282416938*l;l=d>>>0,d-=l,d*=l,l=d>>>0,d-=l,l+=d*4294967296}return(l>>>0)*23283064365386963e-26};return h}e&&e.exports?e.exports=o:this.alea=o})(Pa,i)})(as)),as.exports}var ls={exports:{}},Ca=ls.exports,ur;function Ta(){return ur||(ur=1,(function(i){(function(t,e,s){function r(a){var l=this,h="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var u=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^u^u>>>8},a===(a|0)?l.x=a:h+=a;for(var c=0;c<h.length+64;c++)l.x^=h.charCodeAt(c)|0,l.next()}function n(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function o(a,l){var h=new r(a),c=l&&l.state,u=function(){return(h.next()>>>0)/4294967296};return u.double=function(){do var d=h.next()>>>11,f=(h.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},u.int32=h.next,u.quick=u,c&&(typeof c=="object"&&n(c,h),u.state=function(){return n(h,{})}),u}e&&e.exports?e.exports=o:this.xor128=o})(Ca,i)})(ls)),ls.exports}var hs={exports:{}},Ma=hs.exports,dr;function ka(){return dr||(dr=1,(function(i){(function(t,e,s){function r(a){var l=this,h="";l.next=function(){var u=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(u^u<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:h+=a;for(var c=0;c<h.length+64;c++)l.x^=h.charCodeAt(c)|0,c==h.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function n(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function o(a,l){var h=new r(a),c=l&&l.state,u=function(){return(h.next()>>>0)/4294967296};return u.double=function(){do var d=h.next()>>>11,f=(h.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},u.int32=h.next,u.quick=u,c&&(typeof c=="object"&&n(c,h),u.state=function(){return n(h,{})}),u}e&&e.exports?e.exports=o:this.xorwow=o})(Ma,i)})(hs)),hs.exports}var cs={exports:{}},Ea=cs.exports,fr;function Ia(){return fr||(fr=1,(function(i){(function(t,e,s){function r(a){var l=this;l.next=function(){var c=l.x,u=l.i,d,f;return d=c[u],d^=d>>>7,f=d^d<<24,d=c[u+1&7],f^=d^d>>>10,d=c[u+3&7],f^=d^d>>>3,d=c[u+4&7],f^=d^d<<7,d=c[u+7&7],d=d^d<<13,f^=d^d<<9,c[u]=f,l.i=u+1&7,f};function h(c,u){var d,f=[];if(u===(u|0))f[0]=u;else for(u=""+u,d=0;d<u.length;++d)f[d&7]=f[d&7]<<15^u.charCodeAt(d)+f[d+1&7]<<13;for(;f.length<8;)f.push(0);for(d=0;d<8&&f[d]===0;++d);for(d==8?f[7]=-1:f[d],c.x=f,c.i=0,d=256;d>0;--d)c.next()}h(l,a)}function n(a,l){return l.x=a.x.slice(),l.i=a.i,l}function o(a,l){a==null&&(a=+new Date);var h=new r(a),c=l&&l.state,u=function(){return(h.next()>>>0)/4294967296};return u.double=function(){do var d=h.next()>>>11,f=(h.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},u.int32=h.next,u.quick=u,c&&(c.x&&n(c,h),u.state=function(){return n(h,{})}),u}e&&e.exports?e.exports=o:this.xorshift7=o})(Ea,i)})(cs)),cs.exports}var us={exports:{}},Ra=us.exports,pr;function Ba(){return pr||(pr=1,(function(i){(function(t,e,s){function r(a){var l=this;l.next=function(){var c=l.w,u=l.X,d=l.i,f,p;return l.w=c=c+1640531527|0,p=u[d+34&127],f=u[d=d+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=u[d]=p^f,l.i=d,p+(c^c>>>16)|0};function h(c,u){var d,f,p,y,m,g=[],x=128;for(u===(u|0)?(f=u,u=null):(u=u+"\0",f=0,x=Math.max(x,u.length)),p=0,y=-32;y<x;++y)u&&(f^=u.charCodeAt((y+32)%u.length)),y===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,y>=0&&(m=m+1640531527|0,d=g[y&127]^=f+m,p=d==0?p+1:0);for(p>=128&&(g[(u&&u.length||0)&127]=-1),p=127,y=512;y>0;--y)f=g[p+34&127],d=g[p=p+1&127],f^=f<<13,d^=d<<17,f^=f>>>15,d^=d>>>12,g[p]=f^d;c.w=m,c.X=g,c.i=p}h(l,a)}function n(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function o(a,l){a==null&&(a=+new Date);var h=new r(a),c=l&&l.state,u=function(){return(h.next()>>>0)/4294967296};return u.double=function(){do var d=h.next()>>>11,f=(h.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},u.int32=h.next,u.quick=u,c&&(c.X&&n(c,h),u.state=function(){return n(h,{})}),u}e&&e.exports?e.exports=o:this.xor4096=o})(Ra,i)})(us)),us.exports}var ds={exports:{}},La=ds.exports,mr;function Fa(){return mr||(mr=1,(function(i){(function(t,e,s){function r(a){var l=this,h="";l.next=function(){var u=l.b,d=l.c,f=l.d,p=l.a;return u=u<<25^u>>>7^d,d=d-f|0,f=f<<24^f>>>8^p,p=p-u|0,l.b=u=u<<20^u>>>12^d,l.c=d=d-f|0,l.d=f<<16^d>>>16^p,l.a=p-u|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):h+=a;for(var c=0;c<h.length+20;c++)l.b^=h.charCodeAt(c)|0,l.next()}function n(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function o(a,l){var h=new r(a),c=l&&l.state,u=function(){return(h.next()>>>0)/4294967296};return u.double=function(){do var d=h.next()>>>11,f=(h.next()>>>0)/4294967296,p=(d+f)/(1<<21);while(p===0);return p},u.int32=h.next,u.quick=u,c&&(typeof c=="object"&&n(c,h),u.state=function(){return n(h,{})}),u}e&&e.exports?e.exports=o:this.tychei=o})(La,i)})(ds)),ds.exports}var fs={exports:{}};const Oa={},ja=Object.freeze(Object.defineProperty({__proto__:null,default:Oa},Symbol.toStringTag,{value:"Module"})),Ga=va(ja);var za=fs.exports,gr;function Na(){return gr||(gr=1,(function(i){(function(t,e,s){var r=256,n=6,o=52,a="random",l=s.pow(r,n),h=s.pow(2,o),c=h*2,u=r-1,d;function f(b,A,v){var w=[];A=A==!0?{entropy:!0}:A||{};var T=g(m(A.entropy?[b,_(e)]:b??x(),3),w),P=new p(w),S=function(){for(var M=P.g(n),B=l,F=0;M<h;)M=(M+F)*r,B*=r,F=P.g(1);for(;M>=c;)M/=2,B/=2,F>>>=1;return(M+F)/B};return S.int32=function(){return P.g(4)|0},S.quick=function(){return P.g(4)/4294967296},S.double=S,g(_(P.S),e),(A.pass||v||function(M,B,F,G){return G&&(G.S&&y(G,P),M.state=function(){return y(P,{})}),F?(s[a]=M,B):M})(S,T,"global"in A?A.global:this==s,A.state)}function p(b){var A,v=b.length,w=this,T=0,P=w.i=w.j=0,S=w.S=[];for(v||(b=[v++]);T<r;)S[T]=T++;for(T=0;T<r;T++)S[T]=S[P=u&P+b[T%v]+(A=S[T])],S[P]=A;(w.g=function(M){for(var B,F=0,G=w.i,ct=w.j,k=w.S;M--;)B=k[G=u&G+1],F=F*r+k[u&(k[G]=k[ct=u&ct+B])+(k[ct]=B)];return w.i=G,w.j=ct,F})(r)}function y(b,A){return A.i=b.i,A.j=b.j,A.S=b.S.slice(),A}function m(b,A){var v=[],w=typeof b,T;if(A&&w=="object")for(T in b)try{v.push(m(b[T],A-1))}catch{}return v.length?v:w=="string"?b:b+"\0"}function g(b,A){for(var v=b+"",w,T=0;T<v.length;)A[u&T]=u&(w^=A[u&T]*19)+v.charCodeAt(T++);return _(A)}function x(){try{var b;return d&&(b=d.randomBytes)?b=b(r):(b=new Uint8Array(r),(t.crypto||t.msCrypto).getRandomValues(b)),_(b)}catch{var A=t.navigator,v=A&&A.plugins;return[+new Date,t,v,t.screen,_(e)]}}function _(b){return String.fromCharCode.apply(0,b)}if(g(s.random(),e),i.exports){i.exports=f;try{d=Ga}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:za,[],Math)})(fs)),fs.exports}var Fs,yr;function Da(){if(yr)return Fs;yr=1;var i=Wn(),t=Ta(),e=ka(),s=Ia(),r=Ba(),n=Fa(),o=Na();return o.alea=i,o.xor128=t,o.xorwow=e,o.xorshift7=s,o.xor4096=r,o.tychei=n,Fs=o,Fs}var Os,xr;function Wa(){if(xr)return Os;xr=1;var i=Da(),t=["ability","able","aboard","about","above","accept","accident","according","account","accurate","acres","across","act","action","active","activity","actual","actually","add","addition","additional","adjective","adult","adventure","advice","affect","afraid","after","afternoon","again","against","age","ago","agree","ahead","aid","air","airplane","alike","alive","all","allow","almost","alone","along","aloud","alphabet","already","also","although","am","among","amount","ancient","angle","angry","animal","announced","another","answer","ants","any","anybody","anyone","anything","anyway","anywhere","apart","apartment","appearance","apple","applied","appropriate","are","area","arm","army","around","arrange","arrangement","arrive","arrow","art","article","as","aside","ask","asleep","at","ate","atmosphere","atom","atomic","attached","attack","attempt","attention","audience","author","automobile","available","average","avoid","aware","away","baby","back","bad","badly","bag","balance","ball","balloon","band","bank","bar","bare","bark","barn","base","baseball","basic","basis","basket","bat","battle","be","bean","bear","beat","beautiful","beauty","became","because","become","becoming","bee","been","before","began","beginning","begun","behavior","behind","being","believed","bell","belong","below","belt","bend","beneath","bent","beside","best","bet","better","between","beyond","bicycle","bigger","biggest","bill","birds","birth","birthday","bit","bite","black","blank","blanket","blew","blind","block","blood","blow","blue","board","boat","body","bone","book","border","born","both","bottle","bottom","bound","bow","bowl","box","boy","brain","branch","brass","brave","bread","break","breakfast","breath","breathe","breathing","breeze","brick","bridge","brief","bright","bring","broad","broke","broken","brother","brought","brown","brush","buffalo","build","building","built","buried","burn","burst","bus","bush","business","busy","but","butter","buy","by","cabin","cage","cake","call","calm","came","camera","camp","can","canal","cannot","cap","capital","captain","captured","car","carbon","card","care","careful","carefully","carried","carry","case","cast","castle","cat","catch","cattle","caught","cause","cave","cell","cent","center","central","century","certain","certainly","chain","chair","chamber","chance","change","changing","chapter","character","characteristic","charge","chart","check","cheese","chemical","chest","chicken","chief","child","children","choice","choose","chose","chosen","church","circle","circus","citizen","city","class","classroom","claws","clay","clean","clear","clearly","climate","climb","clock","close","closely","closer","cloth","clothes","clothing","cloud","club","coach","coal","coast","coat","coffee","cold","collect","college","colony","color","column","combination","combine","come","comfortable","coming","command","common","community","company","compare","compass","complete","completely","complex","composed","composition","compound","concerned","condition","congress","connected","consider","consist","consonant","constantly","construction","contain","continent","continued","contrast","control","conversation","cook","cookies","cool","copper","copy","corn","corner","correct","correctly","cost","cotton","could","count","country","couple","courage","course","court","cover","cow","cowboy","crack","cream","create","creature","crew","crop","cross","crowd","cry","cup","curious","current","curve","customs","cut","cutting","daily","damage","dance","danger","dangerous","dark","darkness","date","daughter","dawn","day","dead","deal","dear","death","decide","declared","deep","deeply","deer","definition","degree","depend","depth","describe","desert","design","desk","detail","determine","develop","development","diagram","diameter","did","die","differ","difference","different","difficult","difficulty","dig","dinner","direct","direction","directly","dirt","dirty","disappear","discover","discovery","discuss","discussion","disease","dish","distance","distant","divide","division","do","doctor","does","dog","doing","doll","dollar","done","donkey","door","dot","double","doubt","down","dozen","draw","drawn","dream","dress","drew","dried","drink","drive","driven","driver","driving","drop","dropped","drove","dry","duck","due","dug","dull","during","dust","duty","each","eager","ear","earlier","early","earn","earth","easier","easily","east","easy","eat","eaten","edge","education","effect","effort","egg","eight","either","electric","electricity","element","elephant","eleven","else","empty","end","enemy","energy","engine","engineer","enjoy","enough","enter","entire","entirely","environment","equal","equally","equator","equipment","escape","especially","essential","establish","even","evening","event","eventually","ever","every","everybody","everyone","everything","everywhere","evidence","exact","exactly","examine","example","excellent","except","exchange","excited","excitement","exciting","exclaimed","exercise","exist","expect","experience","experiment","explain","explanation","explore","express","expression","extra","eye","face","facing","fact","factor","factory","failed","fair","fairly","fall","fallen","familiar","family","famous","far","farm","farmer","farther","fast","fastened","faster","fat","father","favorite","fear","feathers","feature","fed","feed","feel","feet","fell","fellow","felt","fence","few","fewer","field","fierce","fifteen","fifth","fifty","fight","fighting","figure","fill","film","final","finally","find","fine","finest","finger","finish","fire","fireplace","firm","first","fish","five","fix","flag","flame","flat","flew","flies","flight","floating","floor","flow","flower","fly","fog","folks","follow","food","foot","football","for","force","foreign","forest","forget","forgot","forgotten","form","former","fort","forth","forty","forward","fought","found","four","fourth","fox","frame","free","freedom","frequently","fresh","friend","friendly","frighten","frog","from","front","frozen","fruit","fuel","full","fully","fun","function","funny","fur","furniture","further","future","gain","game","garage","garden","gas","gasoline","gate","gather","gave","general","generally","gentle","gently","get","getting","giant","gift","girl","give","given","giving","glad","glass","globe","go","goes","gold","golden","gone","good","goose","got","government","grabbed","grade","gradually","grain","grandfather","grandmother","graph","grass","gravity","gray","great","greater","greatest","greatly","green","grew","ground","group","grow","grown","growth","guard","guess","guide","gulf","gun","habit","had","hair","half","halfway","hall","hand","handle","handsome","hang","happen","happened","happily","happy","harbor","hard","harder","hardly","has","hat","have","having","hay","he","headed","heading","health","heard","hearing","heart","heat","heavy","height","held","hello","help","helpful","her","herd","here","herself","hidden","hide","high","higher","highest","highway","hill","him","himself","his","history","hit","hold","hole","hollow","home","honor","hope","horn","horse","hospital","hot","hour","house","how","however","huge","human","hundred","hung","hungry","hunt","hunter","hurried","hurry","hurt","husband","ice","idea","identity","if","ill","image","imagine","immediately","importance","important","impossible","improve","in","inch","include","including","income","increase","indeed","independent","indicate","individual","industrial","industry","influence","information","inside","instance","instant","instead","instrument","interest","interior","into","introduced","invented","involved","iron","is","island","it","its","itself","jack","jar","jet","job","join","joined","journey","joy","judge","jump","jungle","just","keep","kept","key","kids","kill","kind","kitchen","knew","knife","know","knowledge","known","label","labor","lack","lady","laid","lake","lamp","land","language","large","larger","largest","last","late","later","laugh","law","lay","layers","lead","leader","leaf","learn","least","leather","leave","leaving","led","left","leg","length","lesson","let","letter","level","library","lie","life","lift","light","like","likely","limited","line","lion","lips","liquid","list","listen","little","live","living","load","local","locate","location","log","lonely","long","longer","look","loose","lose","loss","lost","lot","loud","love","lovely","low","lower","luck","lucky","lunch","lungs","lying","machine","machinery","mad","made","magic","magnet","mail","main","mainly","major","make","making","man","managed","manner","manufacturing","many","map","mark","market","married","mass","massage","master","material","mathematics","matter","may","maybe","me","meal","mean","means","meant","measure","meat","medicine","meet","melted","member","memory","men","mental","merely","met","metal","method","mice","middle","might","mighty","mile","military","milk","mill","mind","mine","minerals","minute","mirror","missing","mission","mistake","mix","mixture","model","modern","molecular","moment","money","monkey","month","mood","moon","more","morning","most","mostly","mother","motion","motor","mountain","mouse","mouth","move","movement","movie","moving","mud","muscle","music","musical","must","my","myself","mysterious","nails","name","nation","national","native","natural","naturally","nature","near","nearby","nearer","nearest","nearly","necessary","neck","needed","needle","needs","negative","neighbor","neighborhood","nervous","nest","never","new","news","newspaper","next","nice","night","nine","no","nobody","nodded","noise","none","noon","nor","north","nose","not","note","noted","nothing","notice","noun","now","number","numeral","nuts","object","observe","obtain","occasionally","occur","ocean","of","off","offer","office","officer","official","oil","old","older","oldest","on","once","one","only","onto","open","operation","opinion","opportunity","opposite","or","orange","orbit","order","ordinary","organization","organized","origin","original","other","ought","our","ourselves","out","outer","outline","outside","over","own","owner","oxygen","pack","package","page","paid","pain","paint","pair","palace","pale","pan","paper","paragraph","parallel","parent","park","part","particles","particular","particularly","partly","parts","party","pass","passage","past","path","pattern","pay","peace","pen","pencil","people","per","percent","perfect","perfectly","perhaps","period","person","personal","pet","phrase","physical","piano","pick","picture","pictured","pie","piece","pig","pile","pilot","pine","pink","pipe","pitch","place","plain","plan","plane","planet","planned","planning","plant","plastic","plate","plates","play","pleasant","please","pleasure","plenty","plural","plus","pocket","poem","poet","poetry","point","pole","police","policeman","political","pond","pony","pool","poor","popular","population","porch","port","position","positive","possible","possibly","post","pot","potatoes","pound","pour","powder","power","powerful","practical","practice","prepare","present","president","press","pressure","pretty","prevent","previous","price","pride","primitive","principal","principle","printed","private","prize","probably","problem","process","produce","product","production","program","progress","promised","proper","properly","property","protection","proud","prove","provide","public","pull","pupil","pure","purple","purpose","push","put","putting","quarter","queen","question","quick","quickly","quiet","quietly","quite","rabbit","race","radio","railroad","rain","raise","ran","ranch","range","rapidly","rate","rather","raw","rays","reach","read","reader","ready","real","realize","rear","reason","recall","receive","recent","recently","recognize","record","red","refer","refused","region","regular","related","relationship","religious","remain","remarkable","remember","remove","repeat","replace","replied","report","represent","require","research","respect","rest","result","return","review","rhyme","rhythm","rice","rich","ride","riding","right","ring","rise","rising","river","road","roar","rock","rocket","rocky","rod","roll","roof","room","root","rope","rose","rough","round","route","row","rubbed","rubber","rule","ruler","run","running","rush","sad","saddle","safe","safety","said","sail","sale","salmon","salt","same","sand","sang","sat","satellites","satisfied","save","saved","saw","say","scale","scared","scene","school","science","scientific","scientist","score","screen","sea","search","season","seat","second","secret","section","see","seed","seeing","seems","seen","seldom","select","selection","sell","send","sense","sent","sentence","separate","series","serious","serve","service","sets","setting","settle","settlers","seven","several","shade","shadow","shake","shaking","shall","shallow","shape","share","sharp","she","sheep","sheet","shelf","shells","shelter","shine","shinning","ship","shirt","shoe","shoot","shop","shore","short","shorter","shot","should","shoulder","shout","show","shown","shut","sick","sides","sight","sign","signal","silence","silent","silk","silly","silver","similar","simple","simplest","simply","since","sing","single","sink","sister","sit","sitting","situation","six","size","skill","skin","sky","slabs","slave","sleep","slept","slide","slight","slightly","slip","slipped","slope","slow","slowly","small","smaller","smallest","smell","smile","smoke","smooth","snake","snow","so","soap","social","society","soft","softly","soil","solar","sold","soldier","solid","solution","solve","some","somebody","somehow","someone","something","sometime","somewhere","son","song","soon","sort","sound","source","south","southern","space","speak","special","species","specific","speech","speed","spell","spend","spent","spider","spin","spirit","spite","split","spoken","sport","spread","spring","square","stage","stairs","stand","standard","star","stared","start","state","statement","station","stay","steady","steam","steel","steep","stems","step","stepped","stick","stiff","still","stock","stomach","stone","stood","stop","stopped","store","storm","story","stove","straight","strange","stranger","straw","stream","street","strength","stretch","strike","string","strip","strong","stronger","struck","structure","struggle","stuck","student","studied","studying","subject","substance","success","successful","such","sudden","suddenly","sugar","suggest","suit","sum","summer","sun","sunlight","supper","supply","support","suppose","sure","surface","surprise","surrounded","swam","sweet","swept","swim","swimming","swing","swung","syllable","symbol","system","table","tail","take","taken","tales","talk","tall","tank","tape","task","taste","taught","tax","tea","teach","teacher","team","tears","teeth","telephone","television","tell","temperature","ten","tent","term","terrible","test","than","thank","that","thee","them","themselves","then","theory","there","therefore","these","they","thick","thin","thing","think","third","thirty","this","those","thou","though","thought","thousand","thread","three","threw","throat","through","throughout","throw","thrown","thumb","thus","thy","tide","tie","tight","tightly","till","time","tin","tiny","tip","tired","title","to","tobacco","today","together","told","tomorrow","tone","tongue","tonight","too","took","tool","top","topic","torn","total","touch","toward","tower","town","toy","trace","track","trade","traffic","trail","train","transportation","trap","travel","treated","tree","triangle","tribe","trick","tried","trip","troops","tropical","trouble","truck","trunk","truth","try","tube","tune","turn","twelve","twenty","twice","two","type","typical","uncle","under","underline","understanding","unhappy","union","unit","universe","unknown","unless","until","unusual","up","upon","upper","upward","us","use","useful","using","usual","usually","valley","valuable","value","vapor","variety","various","vast","vegetable","verb","vertical","very","vessels","victory","view","village","visit","visitor","voice","volume","vote","vowel","voyage","wagon","wait","walk","wall","want","war","warm","warn","was","wash","waste","watch","water","wave","way","we","weak","wealth","wear","weather","week","weigh","weight","welcome","well","went","were","west","western","wet","whale","what","whatever","wheat","wheel","when","whenever","where","wherever","whether","which","while","whispered","whistle","white","who","whole","whom","whose","why","wide","widely","wife","wild","will","willing","win","wind","window","wing","winter","wire","wise","wish","with","within","without","wolf","women","won","wonder","wonderful","wood","wooden","wool","word","wore","work","worker","world","worried","worry","worse","worth","would","wrapped","write","writer","writing","written","wrong","wrote","yard","year","yellow","yes","yesterday","yet","you","young","younger","your","yourself","youth","zero","zebra","zipper","zoo","zulu"];function e(s){const r=s?.seed?new i(s.seed):null;function n(){return s&&s.maxLength>1?o():a()}function o(){for(var p=!1,y;!p;)y=a(),y.length<=s.maxLength&&(p=!0);return y}function a(){return t[l(t.length)]}function l(p){const y=r?r():Math.random();return Math.floor(y*p)}if(typeof s>"u")return n();typeof s=="number"&&(s={exactly:s}),s.exactly&&(s.min=s.exactly,s.max=s.exactly),typeof s.wordsPerString!="number"&&(s.wordsPerString=1),typeof s.formatter!="function"&&(s.formatter=p=>p),typeof s.separator!="string"&&(s.separator=" ");for(var h=s.min+l(s.max+1-s.min),c=[],u="",d=0,f=0;f<h*s.wordsPerString;f++)d===s.wordsPerString-1?u+=s.formatter(n(),d):u+=s.formatter(n(),d)+s.separator,d++,(f+1)%s.wordsPerString===0&&(c.push(u),u="",d=0);return typeof s.join=="string"&&(c=c.join(s.join)),c}return Os=e,e.wordList=t,Os}var $a=Wa();const Va=ze($a);var Ua=Wn();const Ha=ze(Ua);var qa="8.2.2";class xs{constructor(t,e){this.dependencies=t,this.extensionsConfiguration=e,this.extensions=Object.fromEntries(e.map(s=>[xs.getExtensionNameByClass(s.type),this.dependencies.instantiateExtension(s.type)]))}static getExtensionNameByClass(t){return t.info.name}getExtensionInstanceByClass(t){return this.extensions[xs.getExtensionNameByClass(t)]}async initializeExtensions(){await Promise.all(this.extensionsConfiguration.map(({type:t,params:e={}})=>{this.getExtensionInstanceByClass(t).initialize(e);const s=t.info;!("version"in s)&&!("data"in s)?console.warn(s.name,"is missing the 'version' and 'data' fields. Please update extension as 'version' and 'data' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details."):"version"in s?"data"in s||console.warn(s.name,"is missing the 'data' field. Please update extension as 'data' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details."):console.warn(s.name,"is missing the 'version' field. Please update extension as 'version' will be required in v9. See https://www.jspsych.org/latest/developers/extension-development/ for more details.")}))}onStart(t=[]){for(const{type:e,params:s}of t)this.getExtensionInstanceByClass(e)?.on_start(s)}onLoad(t=[]){for(const{type:e,params:s}of t)this.getExtensionInstanceByClass(e)?.on_load(s)}async onFinish(t=[]){const e=await Promise.all(t.map(({type:r,params:n})=>Promise.resolve(this.getExtensionInstanceByClass(r)?.on_finish(n)))),s=t.length?{extension_type:t.map(({type:r})=>r.info.name),extension_version:t.map(({type:r})=>r.info.version)}:{};return e.unshift(s),Object.assign({},...e)}}function ps(i){return[...new Set(i)]}function ft(i){if(!i)return i;let t;if(Array.isArray(i)){t=[];for(const e of i)t.push(ft(e));return t}else if(typeof i=="object"&&i!==null){t={};for(const e in i)i.hasOwnProperty(e)&&(t[e]=ft(i[e]));return t}else return i}function _s(i,t){let e={};for(const s in i)i.hasOwnProperty(s)&&(typeof i[s]=="object"&&t.hasOwnProperty(s)?e[s]=_s(i[s],t[s]):e[s]=i[s]);for(const s in t)t.hasOwnProperty(s)&&(e.hasOwnProperty(s)&&typeof t[s]=="object"?e[s]=_s(e[s],t[s]):e[s]=t[s]);return e}var Ya=Object.freeze({__proto__:null,deepCopy:ft,deepMerge:_s,unique:ps});class Oi{constructor(t=[]){this.values=t}sum(){let t=0;for(const e of this.values)t+=e;return t}mean(){let t=0,e=0;for(const s of this.values)typeof s<"u"&&s!==null&&(t+=s,e++);if(e!==0)return t/e}median(){if(this.values.length===0)return;const t=this.values.slice(0).sort(function(r,n){return r-n}),e=Math.floor(t.length/2);return t.length%2===0?(t[e]+t[e-1])/2:t[e]}min(){return Math.min.apply(null,this.values)}max(){return Math.max.apply(null,this.values)}count(){return this.values.length}variance(){const t=this.mean();let e=0;for(const r of this.values)e+=Math.pow(r-t,2);return e/(this.values.length-1)}sd(){const t=this.variance();return Math.sqrt(t)}frequencies(){const t={};for(const e of this.values)typeof t[e]>"u"?t[e]=1:t[e]++;return t}all(t){for(const e of this.values)if(!t(e))return!1;return!0}subset(t){const e=[];for(const s of this.values)t(s)&&e.push(s);return new Oi(e)}}function Xa(i,t){const e=new Blob([i],{type:"text/plain"});let s="";typeof window.webkitURL<"u"?s=window.webkitURL.createObjectURL(e):s=window.URL.createObjectURL(e);const r=document.createElement("a");r.id="jspsych-download-as-text-link",r.style.display="none",r.download=t,r.href=s,r.click()}function Ka(i){const t=typeof i!="object"?JSON.parse(i):i;let e="",s="";const r=[];for(const n of t)for(const o in n){let a=o+"";a='"'+a.replace(/"/g,'""')+'",',r.includes(o)||(r.push(o),e+=a)}e=e.slice(0,-1),s+=e+`\r
`;for(const n of t){e="";for(const o of r){let a=typeof n[o]>"u"?"":n[o];typeof a=="object"&&(a=JSON.stringify(a));const l=a+"";e+='"'+l.replace(/"/g,'""')+'",'}e=e.slice(0,-1),s+=e+`\r
`}return s}function Ja(){const i=window.location.search.substr(1).split("&"),t={};for(let e=0;e<i.length;++e){const s=i[e].split("=",2);s.length==1?t[s[0]]="":t[s[0]]=decodeURIComponent(s[1].replace(/\+/g," "))}return t}class st{constructor(t=[]){this.trials=t}push(t){return this.trials.push(t),this}join(t){return this.trials=this.trials.concat(t.values()),this}top(){return this.trials.length<=1?this:new st([this.trials[this.trials.length-1]])}first(t=1){if(t<1)throw`You must query with a positive nonzero integer. Please use a
               different value for n.`;return this.trials.length===0?new st:(t>this.trials.length&&(t=this.trials.length),new st(this.trials.slice(0,t)))}last(t=1){if(t<1)throw`You must query with a positive nonzero integer. Please use a
               different value for n.`;return this.trials.length===0?new st:(t>this.trials.length&&(t=this.trials.length),new st(this.trials.slice(this.trials.length-t,this.trials.length)))}values(){return this.trials}count(){return this.trials.length}readOnly(){return new st(ft(this.trials))}addToAll(t){for(const e of this.trials)Object.assign(e,t);return this}addToLast(t){return this.trials.length>0&&Object.assign(this.trials[this.trials.length-1],t),this}filter(t){let e;Array.isArray(t)?e=ft(t):e=ft([t]);const s=[];for(const r of this.trials){let n=!1;for(const o of e){let a=!0;for(const l of Object.keys(o))typeof r[l]<"u"&&r[l]===o[l]||(a=!1);if(a){n=!0;break}}n&&s.push(r)}return new st(s)}filterCustom(t){return new st(this.trials.filter(t))}filterColumns(t){return new st(this.trials.map(e=>Object.fromEntries(t.filter(s=>s in e).map(s=>[s,e[s]]))))}select(t){const e=[];for(const s of this.trials)typeof s[t]<"u"&&e.push(s[t]);return new Oi(e)}ignore(t){Array.isArray(t)||(t=[t]);const e=ft(this.trials);for(const s of e)for(const r of t)delete s[r];return new st(e)}uniqueNames(){const t=[];for(const e of this.trials)for(const s of Object.keys(e))t.includes(s)||t.push(s);return t}csv(){return Ka(this.trials)}json(t=!1){return t?JSON.stringify(this.trials,null,"	"):JSON.stringify(this.trials)}localSave(t,e){t=t.toLowerCase();let s;if(t==="json")s=this.json();else if(t==="csv")s=this.csv();else throw new Error('Invalid format specified for localSave. Must be "json" or "csv".');Xa(s,e)}}class Za{constructor(t){this.dependencies=t,this.dataProperties={},this.interactionListeners={blur:()=>{this.addInteractionRecord("blur")},focus:()=>{this.addInteractionRecord("focus")},fullscreenchange:()=>{this.addInteractionRecord(document.isFullScreen||document.webkitIsFullScreen||document.mozIsFullScreen||document.fullscreenElement?"fullscreenenter":"fullscreenexit")}},this.reset()}reset(){this.results=new st,this.resultToTrialMap=new WeakMap,this.interactionRecords=new st}get(){return this.results}getInteractionData(){return this.interactionRecords}write(t){const e=t.getResult();Object.assign(e,this.dataProperties),this.results.push(e),this.resultToTrialMap.set(e,t)}addProperties(t){this.results.addToAll(t),this.dataProperties=Object.assign({},this.dataProperties,t)}addDataToLastTrial(t){this.results.addToLast(t)}getLastTrialData(){return this.results.top()}getLastTimelineData(){const t=this.getLastTrialData().values()[0];return new st(t?this.resultToTrialMap.get(t).parent.getResults():[])}displayData(t="json"){t=t.toLowerCase(),t!=="json"&&t!=="csv"&&(console.log("Invalid format declared for displayData function. Using json as default."),t="json");const e=document.createElement("pre");e.id="jspsych-data-display",e.textContent=t==="json"?this.results.json(!0):this.results.csv(),this.dependencies.getDisplayElement().replaceChildren(e)}urlVariables(){return typeof this.query_string>"u"&&(this.query_string=Ja()),this.query_string}getURLVariable(t){return this.urlVariables()[t]}addInteractionRecord(t){const e={event:t,...this.dependencies.getProgress()};this.interactionRecords.push(e),this.dependencies.onInteractionRecordAdded(e)}createInteractionListeners(){window.addEventListener("blur",this.interactionListeners.blur),window.addEventListener("focus",this.interactionListeners.focus),document.addEventListener("fullscreenchange",this.interactionListeners.fullscreenchange),document.addEventListener("mozfullscreenchange",this.interactionListeners.fullscreenchange),document.addEventListener("webkitfullscreenchange",this.interactionListeners.fullscreenchange)}removeInteractionListeners(){window.removeEventListener("blur",this.interactionListeners.blur),window.removeEventListener("focus",this.interactionListeners.focus),document.removeEventListener("fullscreenchange",this.interactionListeners.fullscreenchange),document.removeEventListener("mozfullscreenchange",this.interactionListeners.fullscreenchange),document.removeEventListener("webkitfullscreenchange",this.interactionListeners.fullscreenchange)}}class Qa{constructor(t,e=!1,s=0){this.getRootElement=t,this.areResponsesCaseSensitive=e,this.minimumValidRt=s,this.listeners=new Set,this.heldKeys=new Set,this.areRootListenersRegistered=!1,Fi(this),this.registerRootListeners()}registerRootListeners(){if(!this.areRootListenersRegistered){const t=this.getRootElement();t&&(t.addEventListener("keydown",this.rootKeydownListener),t.addEventListener("keyup",this.rootKeyupListener),this.areRootListenersRegistered=!0)}}rootKeydownListener(t){for(const e of[...this.listeners])e(t);this.heldKeys.add(this.toLowerCaseIfInsensitive(t.key))}toLowerCaseIfInsensitive(t){return this.areResponsesCaseSensitive?t:t.toLowerCase()}rootKeyupListener(t){this.heldKeys.delete(this.toLowerCaseIfInsensitive(t.key))}isResponseValid(t,e,s){return!e&&this.heldKeys.has(s)?!1:t==="ALL_KEYS"?!0:t==="NO_KEYS"?!1:t.includes(s)}getKeyboardResponse({callback_function:t,valid_responses:e="ALL_KEYS",rt_method:s="performance",persist:r,audio_context:n,audio_context_start_time:o,allow_held_key:a=!1,minimum_valid_rt:l=this.minimumValidRt}){s!=="performance"&&s!=="audio"&&(console.log('Invalid RT method specified in getKeyboardResponse. Defaulting to "performance" method.'),s="performance");const c=s==="performance"?performance.now():o*1e3;this.registerRootListeners(),!this.areResponsesCaseSensitive&&typeof e!="string"&&(e=e.map(d=>d.toLowerCase()));const u=d=>{const f=Math.round((s=="performance"?performance.now():n.currentTime*1e3)-c);if(f<l)return;const p=this.toLowerCaseIfInsensitive(d.key);this.isResponseValid(e,a,p)&&(d.preventDefault(),r||this.cancelKeyboardResponse(u),t({key:d.key,rt:f}))};return this.listeners.add(u),u}cancelKeyboardResponse(t){this.listeners.delete(t)}cancelAllKeyboardResponses(){this.listeners.clear()}compareKeys(t,e){if(typeof t!="string"&&t!==null||typeof e!="string"&&e!==null){console.error("Error in jsPsych.pluginAPI.compareKeys: arguments must be key strings or null.");return}return typeof t=="string"&&typeof e=="string"?this.areResponsesCaseSensitive?t===e:t.toLowerCase()===e.toLowerCase():t===null&&e===null}}var C=(i=>(i[i.BOOL=0]="BOOL",i[i.STRING=1]="STRING",i[i.INT=2]="INT",i[i.FLOAT=3]="FLOAT",i[i.FUNCTION=4]="FUNCTION",i[i.KEY=5]="KEY",i[i.KEYS=6]="KEYS",i[i.SELECT=7]="SELECT",i[i.HTML_STRING=8]="HTML_STRING",i[i.IMAGE=9]="IMAGE",i[i.AUDIO=10]="AUDIO",i[i.VIDEO=11]="VIDEO",i[i.OBJECT=12]="OBJECT",i[i.COMPLEX=13]="COMPLEX",i[i.TIMELINE=14]="TIMELINE",i))(C||{});class Ve{constructor(t,e={useWebAudio:!1}){this.src=t,this.useWebAudio=e.useWebAudio,this.audioContext=e.audioContext||null}async load(){this.useWebAudio?this.webAudioBuffer=await this.preloadWebAudio(this.src):this.audio=await this.preloadHTMLAudio(this.src)}play(){this.audio instanceof HTMLAudioElement?this.audio.play():(this.audio||(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.start())}stop(){this.audio instanceof HTMLAudioElement?(this.audio.pause(),this.audio.currentTime=0):(this.audio.stop(),this.audio=this.getAudioSourceNode(this.webAudioBuffer))}addEventListener(t,e){!this.audio&&this.webAudioBuffer&&(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.addEventListener(t,e)}removeEventListener(t,e){!this.audio&&this.webAudioBuffer&&(this.audio=this.getAudioSourceNode(this.webAudioBuffer)),this.audio.removeEventListener(t,e)}getAudioSourceNode(t){const e=this.audioContext.createBufferSource();return e.buffer=t,e.connect(this.audioContext.destination),e}async preloadWebAudio(t){const s=await(await fetch(t)).arrayBuffer(),r=await this.audioContext.decodeAudioData(s),n=this.audioContext.createBufferSource();return n.buffer=r,n.connect(this.audioContext.destination),r}async preloadHTMLAudio(t){return new Promise((e,s)=>{const r=new Audio(t);r.addEventListener("canplaythrough",()=>{e(r)}),r.addEventListener("error",n=>{s(n)}),r.addEventListener("abort",n=>{s(n)})})}}const _r=[C.AUDIO,C.IMAGE,C.VIDEO];class tl{constructor(t){this.useWebaudio=t,this.video_buffers={},this.context=null,this.audio_buffers=[],this.preload_requests=[],this.img_cache={},this.preloadMap=new Map,this.microphone_recorder=null,this.camera_stream=null,this.camera_recorder=null,this.useWebaudio&&typeof window<"u"&&typeof window.AudioContext<"u"&&(this.context=new AudioContext)}getVideoBuffer(t){return t.startsWith("blob:")&&(this.video_buffers[t]=t),this.video_buffers[t]}audioContext(){return this.context&&this.context.state!=="running"&&this.context.resume(),this.context}async getAudioPlayer(t){return this.audio_buffers[t]instanceof Ve?this.audio_buffers[t]:(this.audio_buffers[t]=new Ve(t,{useWebAudio:this.useWebaudio,audioContext:this.context}),await this.audio_buffers[t].load(),this.audio_buffers[t])}preloadAudio(t,e=()=>{},s=n=>{},r=n=>{}){t=ps(t.flat());let n=0;if(t.length==0){e();return}for(const o of t)this.audio_buffers[o]instanceof Ve?(n++,s(o),n==t.length&&e()):(this.audio_buffers[o]=new Ve(o,{useWebAudio:this.useWebaudio,audioContext:this.context}),this.audio_buffers[o].load().then(()=>{n++,s(o),n==t.length&&e()}).catch(a=>{r(a)}))}preloadImages(t,e=()=>{},s=n=>{},r=n=>{}){t=ps(t.flat());var n=0;if(t.length===0){e();return}for(let o=0;o<t.length;o++){const a=new Image,l=t[o];a.onload=()=>{n++,s(l),n===t.length&&e()},a.onerror=h=>{r({source:l,error:h})},a.src=l,this.img_cache[l]=a,this.preload_requests.push(a)}}preloadVideo(t,e=()=>{},s=n=>{},r=n=>{}){t=ps(t.flat());let n=0;if(t.length===0){e();return}for(const o of t){const a=this.video_buffers,l=new XMLHttpRequest;l.open("GET",o,!0),l.responseType="blob",l.onload=()=>{if(l.status===200||l.status===0){const h=l.response;a[o]=URL.createObjectURL(h),n++,s(o),n===t.length&&e()}},l.onerror=h=>{let c=h;l.status==404&&(c="404"),r({source:o,error:c})},l.onloadend=h=>{l.status==404&&r({source:o,error:"404"})},l.send(),this.preload_requests.push(l)}}getAutoPreloadList(t){const e=Object.fromEntries(_r.map(r=>[r,new Set])),s=(r,n)=>{if(typeof r.timeline<"u")for(const a of r.timeline)s(a,r.type??n);else if((r.type??n)?.info){const{name:a,parameters:l}=(r.type??n).info;this.preloadMap.has(a)||this.preloadMap.set(a,Object.fromEntries(Object.entries(l).filter(([h,{type:c,preload:u}])=>_r.includes(c)&&(u??!0)).map(([h,{type:c}])=>[h,c])));for(const[h,c]of Object.entries(this.preloadMap.get(a))){const u=r[h],d=e[c];if(typeof u=="string")d.add(u);else if(Array.isArray(u))for(const f of u.flat())typeof f=="string"&&d.add(f)}}};return s({timeline:t}),{images:[...e[C.IMAGE]],audio:[...e[C.AUDIO]],video:[...e[C.VIDEO]]}}cancelPreloads(){for(const t of this.preload_requests)t.onload=()=>{},t.onerror=()=>{},t.oncanplaythrough=()=>{},t.onabort=()=>{};this.preload_requests=[]}initializeMicrophoneRecorder(t){const e=new MediaRecorder(t);this.microphone_recorder=e}getMicrophoneRecorder(){return this.microphone_recorder}initializeCameraRecorder(t,e){let s=this.getCompatibleMimeType()||"video/webm";const r={...e,mimeType:s};this.camera_stream=t;const n=new MediaRecorder(t,r);this.camera_recorder=n}getCompatibleMimeType(){const t=["video/webm;codecs=vp9,opus","video/webm;codecs=vp8,opus","video/mp4;codecs=avc1.42E01E,mp4a.40.2","video/mp4;codecs=h264,aac","video/mp4;codecs=hevc,aac"];for(const e of t)if(MediaRecorder.isTypeSupported(e))return e;return null}getCameraStream(){return this.camera_stream}getCameraRecorder(){return this.camera_recorder}}class el{constructor(t,e){this.getDisplayContainerElement=t,this.setJsPsychTimeout=e}dispatchEvent(t){this.getDisplayContainerElement().dispatchEvent(t)}keyDown(t){this.dispatchEvent(new KeyboardEvent("keydown",{key:t}))}keyUp(t){this.dispatchEvent(new KeyboardEvent("keyup",{key:t}))}pressKey(t,e=0){e>0?this.setJsPsychTimeout(()=>{this.keyDown(t),this.keyUp(t)},e):(this.keyDown(t),this.keyUp(t))}clickTarget(t,e=0){e>0?this.setJsPsychTimeout(()=>{t.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),t.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),t.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},e):(t.dispatchEvent(new MouseEvent("mousedown",{bubbles:!0})),t.dispatchEvent(new MouseEvent("mouseup",{bubbles:!0})),t.dispatchEvent(new MouseEvent("click",{bubbles:!0})))}fillTextInput(t,e,s=0){s>0?this.setJsPsychTimeout(()=>{t.value=e},s):t.value=e}getValidKey(t){const e=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"," "];let s;if(t=="NO_KEYS")s=null;else if(t=="ALL_KEYS")s=e[Math.floor(Math.random()*e.length)];else{const r=t.flat();s=r[Math.floor(Math.random()*r.length)]}return s}mergeSimulationData(t,e){return{...t,...e?.data}}ensureSimulationDataConsistency(t,e){if(e.rt&&(e.rt=Math.round(e.rt)),t.trial_duration&&e.rt&&e.rt>t.trial_duration&&(e.rt=null,e.response&&(e.response=null),e.correct&&(e.correct=!1)),t.choices&&t.choices=="NO_KEYS"&&(e.rt&&(e.rt=null),e.response&&(e.response=null)),t.allow_response_before_complete&&t.sequence_reps&&t.frame_time){const s=t.sequence_reps*t.frame_time*t.stimuli.length;e.rt<s&&(e.rt=null,e.response=null)}}}class sl{constructor(){this.timeout_handlers=[]}setTimeout(t,e){const s=window.setTimeout(t,e);return this.timeout_handlers.push(s),s}clearAllTimeouts(){for(const t of this.timeout_handlers)clearTimeout(t);this.timeout_handlers=[]}}function il(i){const t=i.getInitSettings(),e=new Qa(i.getDisplayContainerElement,t.case_sensitive_responses,t.minimum_valid_rt),s=new sl,r=new tl(t.use_webaudio),n=new el(i.getDisplayContainerElement,s.setTimeout.bind(s));return Object.assign({},...[e,s,r,n].map(o=>Fi(o)))}function rl(i=Math.random().toString()){return Math.random=Ha(i),i}function ji(i,t,e=!1){const s=Array.isArray(i),r=Array.isArray(t);if(!s)r?(t=[t[0]],console.log("Unclear parameters given to randomization.repeat. Multiple set sizes specified, but only one item exists to sample. Proceeding using the first set size.")):(i=[i],t=[t]);else if(r){if(i.length!=t.length)if(console.warn("Unclear parameters given to randomization.repeat. Items and repetitions are unequal lengths. Behavior may not be as expected."),t.length<i.length){let a=[];for(let l=0;l<i.length;l++)a.push(t);t=a}else t=t.slice(0,i.length)}else{let a=[];for(let l=0;l<i.length;l++)a.push(t);t=a}let n=[];for(let a=0;a<i.length;a++)for(let l=0;l<t[a];l++)i[a]==null||typeof i[a]!="object"?n.push(i[a]):n.push(Object.assign({},i[a]));let o=Rt(n);return e&&(o=fl(o)),o}function Rt(i){Array.isArray(i)||console.error("Argument to shuffle() must be an array.");const t=i.slice(0);let e=t.length,s,r;for(;e;)r=Math.floor(Math.random()*e--),s=t[e],t[e]=t[r],t[r]=s;return t}function nl(i,t){Array.isArray(i)||console.error("First argument to shuffleNoRepeats() must be an array."),typeof t<"u"&&typeof t!="function"&&console.error("Second argument to shuffleNoRepeats() must be a function."),typeof t>"u"&&(t=function(s,r){return s===r});const e=Rt(i);for(let s=0;s<e.length-1;s++)if(t(e[s],e[s+1])){let r=Math.floor(Math.random()*(e.length-2))+1;for(;t(e[s+1],e[r])||t(e[s+1],e[r+1])||t(e[s+1],e[r-1])||t(e[s],e[r]);)r=Math.floor(Math.random()*(e.length-2))+1;const n=e[r];e[r]=e[s+1],e[s+1]=n}return e}function $n(i,t=!1){const e=i.length;if(e==1)return console.warn("shuffleAlternateGroups() was called with only one group. Defaulting to simple shuffle."),Rt(i[0]);let s=[];for(let a=0;a<e;a++)s.push(a);t&&(s=Rt(s));const r=[];let n=null;for(let a=0;a<e;a++)n=n===null?i[a].length:Math.min(n,i[a].length),r.push(Rt(i[a]));const o=[];for(let a=0;a<n;a++)for(let l=0;l<s.length;l++)o.push(r[s[l]][a]);return o}function Vn(i,t){return Array.isArray(i)||console.error("First argument to sampleWithoutReplacement() must be an array"),t>i.length&&console.error("Cannot take a sample larger than the size of the set of items to sample."),Rt(i).slice(0,t)}function Un(i,t,e){Array.isArray(i)||console.error("First argument to sampleWithReplacement() must be an array");const s=[];if(typeof e<"u"){e.length!==i.length&&console.error("The length of the weights array must equal the length of the array to be sampled from.");let o=0;for(const a of e)o+=a;for(const a of e)s.push(a/o)}else for(let o=0;o<i.length;o++)s.push(1/i.length);const r=[s[0]];for(let o=1;o<s.length;o++)r.push(s[o]+r[o-1]);const n=[];for(let o=0;o<t;o++){const a=Math.random();let l=0;for(;a>r[l];)l++;n.push(i[l])}return n}function ol(i,t=1,e=!1){let s=[{}];for(const[r,n]of Object.entries(i)){const o=[];for(const a of n)for(const l of s)o.push({...l,[r]:a});s=o}return ji(s,t,e)}function al(i=32){let t="";const e="0123456789abcdefghjklmnopqrstuvwxyz";for(let s=0;s<i;s++)t+=e[Math.floor(Math.random()*e.length)];return t}function ll(i,t){if(t<i)throw new Error("Upper boundary must be greater than or equal to lower boundary");return i+Math.floor(Math.random()*(t-i+1))}function hl(i){return Math.random()<=i?1:0}function hi(i,t){return dl()*t+i}function ci(i){return-Math.log(Math.random())/i}function cl(i,t,e,s=!1){let r=hi(i,t)+ci(e);if(s)for(;r<=0;)r=hi(i,t)+ci(e);return r}function ul(i){return Va(i)}function dl(){for(var i=0,t=0;i===0;)i=Math.random();for(;t===0;)t=Math.random();return Math.sqrt(-2*Math.log(i))*Math.cos(2*Math.PI*t)}function fl(i){const t={};for(const e of i)for(const s of Object.keys(e))typeof t[s]>"u"&&(t[s]=[]),t[s].push(e[s]);return t}var pl=Object.freeze({__proto__:null,factorial:ol,randomID:al,randomInt:ll,randomWords:ul,repeat:ji,sampleBernoulli:hl,sampleExGaussian:cl,sampleExponential:ci,sampleNormal:hi,sampleWithReplacement:Un,sampleWithoutReplacement:Vn,setSeed:rl,shuffle:Rt,shuffleAlternateGroups:$n,shuffleNoRepeats:nl});function Hn(){const i={previewMode:!1,outsideTurk:!1,hitId:"INVALID_URL_PARAMETER",assignmentId:"INVALID_URL_PARAMETER",workerId:"INVALID_URL_PARAMETER",turkSubmitTo:"INVALID_URL_PARAMETER"},t=function(r,n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const o="[\\?&]"+n+"=([^&#]*)",l=new RegExp(o).exec(r);return l==null?"":l[1]},e=t(window.location.href,"assignmentId")?window.location.href:document.referrer;return["assignmentId","hitId","workerId","turkSubmitTo"].map(function(r){i[r]=unescape(t(e,r))}),i.previewMode=i.assignmentId=="ASSIGNMENT_ID_NOT_AVAILABLE",i.outsideTurk=!i.previewMode&&i.hitId===""&&i.assignmentId==""&&i.workerId=="",i}function ml(i){const t=Hn(),e=t.assignmentId,s=t.turkSubmitTo;if(!e||!s)return;const r=document.createElement("form");r.method="POST",r.action=s+"/mturk/externalSubmit?assignmentId="+e;for(const n in i)if(i.hasOwnProperty(n)){const o=document.createElement("input");o.type="hidden",o.name=n,o.id=n,o.value=i[n],r.appendChild(o)}document.body.appendChild(r),r.submit()}var gl=Object.freeze({__proto__:null,submitToTurk:ml,turkInfo:Hn});class yl{constructor(t,e){this.containerElement=t,this.message=e,this._progress=0,this.setupElements()}setupElements(){this.messageSpan=document.createElement("span"),this.innerDiv=document.createElement("div"),this.innerDiv.id="jspsych-progressbar-inner",this.update();const t=document.createElement("div");t.id="jspsych-progressbar-outer",t.appendChild(this.innerDiv),this.containerElement.appendChild(this.messageSpan),this.containerElement.appendChild(t)}update(){this.innerDiv.style.width=this._progress*100+"%",typeof this.message=="function"?this.messageSpan.innerHTML=this.message(this._progress):this.messageSpan.innerHTML=this.message}set progress(t){if(typeof t!="number"||t<0||t>1)throw new Error("jsPsych.progressBar.progress must be a number between 0 and 1");this._progress=t,this.update()}get progress(){return this._progress}}class ui{constructor(t){this.name=t}}const xl=["timeline","timeline_variables","name","repetitions","loop_function","conditional_function","randomize_order","sample","on_timeline_start","on_timeline_finish"];function _l(i){return!di(i)}function di(i){return!!i.timeline||Array.isArray(i)}var tt=(i=>(i[i.PENDING=0]="PENDING",i[i.RUNNING=1]="RUNNING",i[i.PAUSED=2]="PAUSED",i[i.COMPLETED=3]="COMPLETED",i[i.ABORTED=4]="ABORTED",i))(tt||{});class qn{constructor(){this.reset()}reset(){this.promise=new Promise(t=>{this.resolvePromise=t})}get(){return this.promise}resolve(t){this.resolvePromise(t),this.reset()}}function bl(i){return i&&typeof i.then=="function"}function wl(i){return new Promise(t=>setTimeout(t,i))}function br([i,...t]){let e=i??"";for(const s of t)e+=Number.isNaN(Number.parseInt(s))?`.${s}`:`[${s}]`;return e}function vl(i){return typeof i=="object"&&i!==null}class Gi{constructor(){this.cache=new Map}static lookupChild(t,e){let s=!1,r;return Number.isNaN(Number.parseInt(e))?Object.hasOwn(t,e)&&(s=!0,r=t[e]):Number.parseInt(e)<t.length&&(s=!0,r=t[e]),{doesPathExist:s,value:r}}get(t){return this.cache.get(t.join("."))}has(t){return this.cache.has(t.join("."))}initialize(t){this.rootObject=t,this.cache.set("",t)}reset(){this.cache.clear(),this.cache.set("",this.rootObject)}set(t,e){this.cache.set(t.join("."),e)}lookup(t){if(this.has(t))return{doesPathExist:!0,value:this.get(t)};const e=s=>{const r=s.slice(0,-1),n=s[s.length-1];if(!this.has(r)&&r.length>0&&!e(r).doesPathExist)return{doesPathExist:!1};const o=this.get(r);if(!vl(o))return{doesPathExist:!1};const a=Gi.lookupChild(o,n);return a.doesPathExist&&this.set(s,a.value),a};return e(t)}}class Yn{constructor(t){this.dependencies=t,this.status=tt.PENDING,this.parameterValueCache=new Gi}getStatus(){return this.status}initializeParameterValueCache(){this.parameterValueCache.initialize(this.description)}resetParameterValueCache(){this.parameterValueCache.reset(),this.parent?.resetParameterValueCache()}getParameterValue(t,e={}){const{evaluateFunctions:s=!0,recursive:r=!0,cacheResult:n=!0,replaceResult:o}=e;typeof t=="string"&&(t=[t]);let{doesPathExist:a,value:l}=this.parameterValueCache.lookup(t);return!a&&r&&this.parent&&(l=this.parent.getParameterValue(t,e)),typeof l=="function"&&s&&(l=l()),l instanceof ui&&(l=this.evaluateTimelineVariable(l)),typeof o=="function"&&(l=o(l)),n&&this.parameterValueCache.set(t,l),l}getDataParameter(){const t=this.getParameterValue("data",{recursive:!1});return{...Object.fromEntries(typeof t=="object"?Object.keys(t).map(e=>[e,this.getParameterValue(["data",e])]):[]),...this.parent?.getDataParameter()}}}class bs extends Yn{constructor(t,e,s){if(super(t),this.description=e,this.parent=s,this.onLoad=()=>{this.runParameterCallback("on_load"),this.dependencies.runOnLoadExtensionCallbacks(this.getParameterValue("extensions"))},this.initializeParameterValueCache(),this.trialObject=ft(e),this.pluginClass=this.getParameterValue("type",{evaluateFunctions:!1}),this.pluginInfo=this.pluginClass?.info,!this.pluginInfo)throw new Error("Plugin not recognized. Please provide a valid plugin using the 'type' parameter.");!("version"in this.pluginInfo)&&!("data"in this.pluginInfo)?console.warn(this.pluginInfo.name,"is missing the 'version' and 'data' fields. Please update plugin as 'version' and 'data' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details."):"version"in this.pluginInfo?"data"in this.pluginInfo||console.warn(this.pluginInfo.name,"is missing the 'data' field. Please update plugin as 'data' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details."):console.warn(this.pluginInfo.name,"is missing the 'version' field. Please update plugin as 'version' will be required in v9. See https://www.jspsych.org/latest/developers/plugin-development/ for more details.")}async run(){this.status=tt.RUNNING,this.processParameters(),this.onStart(),this.addCssClasses(),this.pluginInstance=this.dependencies.instantiatePlugin(this.pluginClass),this.result=this.processResult(await this.executeTrial()),this.dependencies.onTrialResultAvailable(this),this.status=tt.COMPLETED,await this.onFinish(),this.removeCssClasses();const t=this.getParameterValue("post_trial_gap")??this.dependencies.getDefaultIti();t!==0&&this.dependencies.getSimulationMode()!=="data-only"&&await wl(t),this.resetParameterValueCache()}async executeTrial(){const t=this.dependencies.finishTrialPromise.get();let e=!1;t.then(()=>{e=!0});const{trialReturnValue:s,hasTrialBeenSimulated:r}=this.invokeTrialMethod();let n;return bl(s)?(n=await Promise.race([s,t]),e&&(n=await t)):(r||this.onLoad(),n=await t),this.cleanupTrial(),n}invokeTrialMethod(){const t=this.dependencies.getSimulationMode();if(t&&typeof this.pluginInstance.simulate=="function"){const e=this.getSimulationOptions();if(e.simulate!==!1)return{hasTrialBeenSimulated:!0,trialReturnValue:this.pluginInstance.simulate(this.trialObject,e.mode??t,e,this.onLoad)}}return{hasTrialBeenSimulated:!1,trialReturnValue:this.pluginInstance.trial(this.dependencies.getDisplayElement(),this.trialObject,this.onLoad)}}cleanupTrial(){this.dependencies.clearAllTimeouts(),this.dependencies.getDisplayElement().innerHTML=""}addCssClasses(){const t=this.getParameterValue("css_classes"),e=this.dependencies.getDisplayElement().classList;typeof t=="string"?e.add(t):Array.isArray(t)&&e.add(...t)}removeCssClasses(){const t=this.getParameterValue("css_classes");t&&this.dependencies.getDisplayElement().classList.remove(...typeof t=="string"?[t]:t)}processResult(t){t||(t={});for(const[s,r]of Object.entries(this.getParameterValue("save_trial_parameters")??{}))if(this.pluginInfo.parameters[s])if(r&&!Object.hasOwn(t,s)){let n=this.trialObject[s];typeof n=="function"&&(n=n.toString()),t[s]=n}else!r&&Object.hasOwn(t,s)&&delete t[s];else console.warn(`Non-existent parameter "${s}" specified in save_trial_parameters.`);t={...this.getDataParameter(),...t,trial_type:this.pluginInfo.name,trial_index:this.index,plugin_version:this.pluginInfo.version?this.pluginInfo.version:null};const e=this.getParameterValue("save_timeline_variables");return e===!0?t.timeline_variables={...this.parent.getAllTimelineVariables()}:Array.isArray(e)&&(t.timeline_variables=Object.fromEntries(Object.entries(this.parent.getAllTimelineVariables()).filter(([s,r])=>e.includes(s)))),t}runParameterCallback(t,...e){const s=this.getParameterValue(t,{evaluateFunctions:!1});if(s)return s(...e)}onStart(){this.dependencies.onTrialStart(this),this.runParameterCallback("on_start",this.trialObject),this.dependencies.runOnStartExtensionCallbacks(this.getParameterValue("extensions"))}async onFinish(){const t=await this.dependencies.runOnFinishExtensionCallbacks(this.getParameterValue("extensions"));Object.assign(this.result,t),await Promise.resolve(this.runParameterCallback("on_finish",this.getResult())),this.dependencies.onTrialFinished(this)}evaluateTimelineVariable(t){return this.parent?.evaluateTimelineVariable(t)}getParameterValue(t,e={}){return xl.includes(typeof t=="string"?t:t[0])&&(e.recursive=!1),super.getParameterValue(t,e)}getSimulationOptions(){const t=this.getParameterValue("simulation_options",{replaceResult:(e={})=>{if(typeof e=="string"){const s=this.dependencies.getGlobalSimulationOptions();e=s[e]??s.default??{}}return _s(ft(this.dependencies.getGlobalSimulationOptions().default),ft(e))}});return typeof t>"u"?{}:(t.mode=this.getParameterValue(["simulation_options","mode"]),t.simulate=this.getParameterValue(["simulation_options","simulate"]),t.data=this.getParameterValue(["simulation_options","data"]),typeof t.data=="object"&&(t.data=Object.fromEntries(Object.keys(t.data).map(e=>[e,this.getParameterValue(["simulation_options","data",e])]))),t)}getResult(){return this.getParameterValue("record_data")===!1?void 0:this.result}getResults(){const t=this.getResult();return t?[t]:[]}processParameters(){const t=(s,r,n=[])=>{for(const[o,a]of Object.entries(r)){const l=[...n,o];let h=this.getParameterValue(l,{evaluateFunctions:a.type!==C.FUNCTION,replaceResult:c=>{if(typeof c>"u"){if(typeof a.default>"u")throw new Error(`You must specify a value for the "${br(l)}" parameter in the "${this.pluginInfo.name}" plugin.`);return a.default}else return c}});if(a.array&&!Array.isArray(h)){const c=br(l);throw new Error(`A non-array value (\`${h}\`) was provided for the array parameter "${c}" in the "${this.pluginInfo.name}" plugin. Please make sure that "${c}" is an array.`)}a.type===C.COMPLEX&&a.nested&&(a.array?h=h.map((c,u)=>{const d=[...l,u.toString()],f=this.getParameterValue(d);return t(f,a.nested,d),f}):t(h,a.nested,l)),s[o]=h}},e=ft(this.description);t(e,this.pluginInfo.parameters),this.trialObject=e}getLatestNode(){return this}getActiveTimelineByName(t){}}class Et extends Yn{constructor(t,e,s){super(t),this.parent=s,this.children=[],this.shouldAbort=!1,this.resumePromise=new qn,this.description=Array.isArray(e)?{timeline:e}:e,this.initializeParameterValueCache()}async run(){typeof this.index>"u"&&(this.index=0),this.status=tt.RUNNING;const{conditional_function:t,loop_function:e,repetitions:s=1}=this.description;let r=this.generateTimelineVariableOrder();this.setCurrentTimelineVariablesByIndex(r[0]);let n=!0,o;if(!t||t()){this.onStart();for(let a=0;a<s;a++)do{o=[],n?n=!1:r=this.generateTimelineVariableOrder();for(const l of r){this.setCurrentTimelineVariablesByIndex(l);for(const h of this.description.timeline){const c=this.instantiateChildNode(h),u=this.currentChild;if(this.currentChild=c,c.index=u?u.getLatestNode().index+1:this.index,await c.run(),this.status===tt.PAUSED&&await this.resumePromise.get(),this.shouldAbort){this.status=tt.ABORTED;return}o.push(...this.currentChild.getResults())}}}while(e&&e(new st(o)));this.onFinish()}this.status=tt.COMPLETED}onStart(){this.description.on_timeline_start&&this.description.on_timeline_start()}onFinish(){this.description.on_timeline_finish&&this.description.on_timeline_finish()}pause(){this.currentChild instanceof Et&&this.currentChild.pause(),this.status=tt.PAUSED}resume(){this.status==tt.PAUSED&&(this.currentChild instanceof Et&&this.currentChild.resume(),this.status=tt.RUNNING,this.resumePromise.resolve())}abort(){(this.status===tt.RUNNING||this.status===tt.PAUSED)&&(this.currentChild instanceof Et&&this.currentChild.abort(),this.shouldAbort=!0,this.status===tt.PAUSED&&this.resume())}instantiateChildNode(t){const e=di(t)?new Et(this.dependencies,t,this):new bs(this.dependencies,t,this);return this.children.push(e),e}setCurrentTimelineVariablesByIndex(t){this.currentTimelineVariables={...this.parent?.getAllTimelineVariables(),...t===null?void 0:this.description.timeline_variables[t]}}generateTimelineVariableOrder(){const t=this.description.timeline_variables?.length;if(!t)return[null];let e=[...Array(t).keys()];const s=this.description.sample;if(s)switch(s.type){case"custom":e=s.fn(e);break;case"with-replacement":e=Un(e,s.size,s.weights);break;case"without-replacement":e=Vn(e,s.size);break;case"fixed-repetitions":e=ji(e,s.size);break;case"alternate-groups":e=$n(s.groups,s.randomize_group_order);break;default:throw new Error(`Invalid type "${s.type}" in timeline sample parameters. Valid options for type are "custom", "with-replacement", "without-replacement", "fixed-repetitions", and "alternate-groups"`)}return this.description.randomize_order&&(e=Rt(e)),e}getAllTimelineVariables(){return this.currentTimelineVariables}evaluateTimelineVariable(t){if(this.currentTimelineVariables?.hasOwnProperty(t.name))return this.currentTimelineVariables[t.name];throw new Error(`Timeline variable ${t.name} not found.`)}getResults(){const t=[];for(const e of this.children)if(e instanceof bs){const s=e.getResult();s&&t.push(s)}else e instanceof Et&&t.push(...e.getResults());return t}getNaiveProgress(){if(this.status===tt.PENDING)return 0;const t=this.getLatestNode();if(!t)return 1;let e=t.index;return t.getStatus()===tt.COMPLETED&&e++,Math.min(e/this.getNaiveTrialCount(),1)}getNaiveTrialCount(){const t=e=>{const s=r=>r.map(n=>t(n)).reduce((n,o)=>n+o);if(Array.isArray(e))return s(e);if(_l(e))return 1;if(di(e)){let r=e.timeline_variables?.length||1;switch(e.sample?.type){case"with-replacement":case"without-replacement":r=e.sample.size;break;case"fixed-repetitions":r*=e.sample.size;break;case"alternate-groups":r=e.sample.groups.map(n=>n.length).reduce((n,o)=>n+o,0);break}return s(e.timeline)*(e.repetitions??1)*r}return 0};return t(this.description)}getLatestNode(){return this.currentChild?.getLatestNode()??this}getActiveTimelineByName(t){return this.description.name===t?this:this.currentChild?.getActiveTimelineByName(t)}}class Al{constructor(t){this.turk=gl,this.randomization=pl,this.utils=Ya,this.citation={apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '},this.options={},this.isFileProtocolUsed=!1,this.finishTrialPromise=new qn,this.timelineDependencies={onTrialStart:e=>{this.options.on_trial_start(e.trialObject),this.getDisplayContainerElement().focus(),this.getDisplayElement().scrollTop=0},onTrialResultAvailable:e=>{const s=e.getResult();s&&(s.time_elapsed=this.getTotalTime(),this.data.write(e))},onTrialFinished:e=>{const s=e.getResult();this.options.on_trial_finish(s),s&&this.options.on_data_update(s),this.progressBar&&this.options.auto_update_progress_bar&&(this.progressBar.progress=this.timeline.getNaiveProgress())},runOnStartExtensionCallbacks:e=>this.extensionManager.onStart(e),runOnLoadExtensionCallbacks:e=>this.extensionManager.onLoad(e),runOnFinishExtensionCallbacks:e=>this.extensionManager.onFinish(e),getSimulationMode:()=>this.simulationMode,getGlobalSimulationOptions:()=>this.simulationOptions,instantiatePlugin:e=>new e(this),getDisplayElement:()=>this.getDisplayElement(),getDefaultIti:()=>this.getInitSettings().default_iti,finishTrialPromise:this.finishTrialPromise,clearAllTimeouts:()=>this.pluginAPI.clearAllTimeouts()},this.extensionManagerDependencies={instantiateExtension:e=>new e(this)},this.dataDependencies={getProgress:()=>({time:this.getTotalTime(),trial:this.timeline?.getLatestNode().index??0}),onInteractionRecordAdded:e=>{this.options.on_interaction_data_update(e)},getDisplayElement:()=>this.getDisplayElement()},t={display_element:void 0,on_finish:()=>{},on_trial_start:()=>{},on_trial_finish:()=>{},on_data_update:()=>{},on_interaction_data_update:()=>{},on_close:()=>{},use_webaudio:!0,show_progress_bar:!1,message_progress_bar:"Completion Progress",auto_update_progress_bar:!0,default_iti:0,minimum_valid_rt:0,experiment_width:null,override_safe_mode:!1,case_sensitive_responses:!1,extensions:[],...t},this.options=t,Fi(this),window.location.protocol=="file:"&&(t.override_safe_mode===!1||typeof t.override_safe_mode>"u")&&(t.use_webaudio=!1,this.isFileProtocolUsed=!0,console.warn("jsPsych detected that it is running via the file:// protocol and not on a web server. To prevent issues with cross-origin requests, Web Audio and video preloading have been disabled. If you would like to override this setting, you can set 'override_safe_mode' to 'true' in initJsPsych. For more information, see: https://www.jspsych.org/overview/running-experiments")),this.data=new Za(this.dataDependencies),this.pluginAPI=il(this),this.extensionManager=new xs(this.extensionManagerDependencies,t.extensions)}version(){return qa}async run(t){typeof t>"u"&&console.error("No timeline declared in jsPsych.run(). Cannot start experiment."),t.length===0&&console.error("No trials have been added to the timeline (the timeline is an empty array). Cannot start experiment."),this.timeline=new Et(this.timelineDependencies,t),await this.prepareDom(),await this.extensionManager.initializeExtensions(),document.documentElement.setAttribute("jspsych","present"),this.experimentStartTime=new Date,await this.timeline.run(),await Promise.resolve(this.options.on_finish(this.data.get())),this.endMessage&&(this.getDisplayElement().innerHTML=this.endMessage),this.data.removeInteractionListeners()}async simulate(t,e="data-only",s={}){this.simulationMode=e,this.simulationOptions=s,await this.run(t)}getProgress(){return{total_trials:this.timeline?.getNaiveTrialCount(),current_trial_global:this.timeline?.getLatestNode().index??0,percent_complete:this.timeline?.getNaiveProgress()*100}}getStartTime(){return this.experimentStartTime}getTotalTime(){return this.experimentStartTime?new Date().getTime()-this.experimentStartTime.getTime():0}getDisplayElement(){return this.displayElement}getDisplayContainerElement(){return this.displayContainerElement}abortExperiment(t,e={}){this.endMessage=t,this.timeline.abort(),this.pluginAPI.cancelAllKeyboardResponses(),this.pluginAPI.clearAllTimeouts(),this.finishTrial(e)}abortCurrentTimeline(){let t=this.timeline?.getLatestNode();t instanceof bs&&(t=t.parent),t instanceof Et&&t.abort()}abortTimelineByName(t){const e=this.timeline?.getActiveTimelineByName(t);e&&e.abort()}getCurrentTrial(){const t=this.timeline?.getLatestNode();if(t instanceof bs)return t.description}getInitSettings(){return this.options}timelineVariable(t){return new ui(t)}evaluateTimelineVariable(t){return this.timeline?.getLatestNode()?.evaluateTimelineVariable(new ui(t))}pauseExperiment(){this.timeline?.pause()}resumeExperiment(){this.timeline?.resume()}getSafeModeStatus(){return this.isFileProtocolUsed}getTimeline(){return this.timeline?.description.timeline}getCitations(t=[],e="apa"){const s=["apa","bibtex"];if(e=e.toLowerCase(),Array.isArray(t))if(s.includes(e)){const r=this.citation[e],n=new Set([r]);for(const a of t)try{const l=a.info.citations[e];n.add(l)}catch{console.error(`${a} does not have citation in ${e} format.`)}return Array.from(n).join(`
`)}else throw new Error("Unsupported citation format");else throw new Error("Expected array of plugins/extensions")}get extensions(){return this.extensionManager?.extensions??{}}async prepareDom(){document.readyState!=="complete"&&await new Promise(r=>{window.addEventListener("load",r)});const t=this.options;if(typeof t.display_element>"u"){let r=document.body;r||(r=document.createElement("body"),document.documentElement.appendChild(r)),document.querySelector("html").style.height="100%",r.style.margin="0px",r.style.height="100%",r.style.width="100%",t.display_element=r}else{const r=t.display_element instanceof Element?t.display_element:document.querySelector("#"+t.display_element);r===null?console.error("The display_element specified in initJsPsych() does not exist in the DOM."):t.display_element=r}const e=document.createElement("div");e.id="jspsych-content";const s=document.createElement("div");if(s.className="jspsych-content-wrapper",s.appendChild(e),this.displayContainerElement=t.display_element,this.displayContainerElement.appendChild(s),this.displayElement=e,t.experiment_width!==null&&(this.displayElement.style.width=t.experiment_width+"px"),t.display_element.tabIndex=0,this.displayContainerElement.classList.add("jspsych-display-element"),this.displayElement.classList.add("jspsych-content"),this.data.createInteractionListeners(),window.addEventListener("beforeunload",t.on_close),this.options.show_progress_bar){const r=document.createElement("div");r.id="jspsych-progressbar-container",this.progressBar=new yl(r,this.options.message_progress_bar),this.getDisplayContainerElement().insertAdjacentElement("afterbegin",r)}}finishTrial(t){this.finishTrialPromise.resolve(t)}}class kt extends Error{constructor(t="The global `jsPsych` variable is no longer available in jsPsych v7."){super(`${t} Please follow the migration guide at https://www.jspsych.org/7.0/support/migration-v7/ to update your experiment.`),this.name="MigrationError"}}window.jsPsych={get init(){throw new kt("`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.")},get data(){throw new kt},get randomization(){throw new kt},get turk(){throw new kt},get pluginAPI(){throw new kt},get ALL_KEYS(){throw new kt('jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.')},get NO_KEYS(){throw new kt('jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.')}};typeof window<"u"&&window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext);function Sl(i){const t=new Al(i);return Object.defineProperties(t,Object.fromEntries(Object.entries({init:"`jsPsych.init()` was replaced by `initJsPsych()` in jsPsych v7.",ALL_KEYS:'jsPsych.ALL_KEYS was replaced by the "ALL_KEYS" string in jsPsych v7.',NO_KEYS:'jsPsych.NO_KEYS was replaced by the "NO_KEYS" string in jsPsych v7.',currentTimelineNodeID:"`currentTimelineNodeID()` was renamed to `getCurrentTimelineNodeID()` in jsPsych v7.",progress:"`progress()` was renamed to `getProgress()` in jsPsych v7.",startTime:"`startTime()` was renamed to `getStartTime()` in jsPsych v7.",totalTime:"`totalTime()` was renamed to `getTotalTime()` in jsPsych v7.",currentTrial:"`currentTrial()` was renamed to `getCurrentTrial()` in jsPsych v7.",initSettings:"`initSettings()` was renamed to `getInitSettings()` in jsPsych v7.",allTimelineVariables:"`allTimelineVariables()` was renamed to `getAllTimelineVariables()` in jsPsych v7."}).map(([s,r])=>[s,{get(){throw new kt(r)}}]))),t}var Pl="2.1.0";const Cl={name:"html-keyboard-response",version:Pl,parameters:{stimulus:{type:C.HTML_STRING,default:void 0},choices:{type:C.KEYS,default:"ALL_KEYS"},prompt:{type:C.HTML_STRING,default:null},stimulus_duration:{type:C.INT,default:null},trial_duration:{type:C.INT,default:null},response_ends_trial:{type:C.BOOL,default:!0}},data:{response:{type:C.STRING},rt:{type:C.INT},stimulus:{type:C.STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},tr=class tr{constructor(t){this.jsPsych=t}trial(t,e){var s='<div id="jspsych-html-keyboard-response-stimulus">'+e.stimulus+"</div>";e.prompt!==null&&(s+=e.prompt),t.innerHTML=s;var r={rt:null,key:null};const n=()=>{typeof a<"u"&&this.jsPsych.pluginAPI.cancelKeyboardResponse(a);var l={rt:r.rt,stimulus:e.stimulus,response:r.key};this.jsPsych.finishTrial(l)};var o=l=>{t.querySelector("#jspsych-html-keyboard-response-stimulus").className+=" responded",r.key==null&&(r=l),e.response_ends_trial&&n()};if(e.choices!="NO_KEYS")var a=this.jsPsych.pluginAPI.getKeyboardResponse({callback_function:o,valid_responses:e.choices,rt_method:"performance",persist:!1,allow_held_key:!1});e.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{t.querySelector("#jspsych-html-keyboard-response-stimulus").style.visibility="hidden"},e.stimulus_duration),e.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(n,e.trial_duration)}simulate(t,e,s,r){e=="data-only"&&(r(),this.simulate_data_only(t,s)),e=="visual"&&this.simulate_visual(t,s,r)}create_simulation_data(t,e){const s={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0),response:this.jsPsych.pluginAPI.getValidKey(t.choices)},r=this.jsPsych.pluginAPI.mergeSimulationData(s,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,r),r}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const r=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s(),r.rt!==null&&this.jsPsych.pluginAPI.pressKey(r.response,r.rt)}};tr.info=Cl;let ws=tr;var Tl="2.1.0";const Ml={name:"html-button-response",version:Tl,parameters:{stimulus:{type:C.HTML_STRING,default:void 0},choices:{type:C.STRING,default:void 0,array:!0},button_html:{type:C.FUNCTION,default:function(i,t){return`<button class="jspsych-btn">${i}</button>`}},prompt:{type:C.HTML_STRING,default:null},stimulus_duration:{type:C.INT,default:null},trial_duration:{type:C.INT,default:null},button_layout:{type:C.STRING,default:"grid"},grid_rows:{type:C.INT,default:1},grid_columns:{type:C.INT,default:null},response_ends_trial:{type:C.BOOL,default:!0},enable_button_after:{type:C.INT,default:0}},data:{rt:{type:C.INT},response:{type:C.INT},stimulus:{type:C.HTML_STRING}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},er=class er{constructor(t){this.jsPsych=t}trial(t,e){const s=document.createElement("div");s.id="jspsych-html-button-response-stimulus",s.innerHTML=e.stimulus,t.appendChild(s);const r=document.createElement("div");if(r.id="jspsych-html-button-response-btngroup",e.button_layout==="grid"){if(r.classList.add("jspsych-btn-group-grid"),e.grid_rows===null&&e.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const u=e.grid_columns===null?Math.ceil(e.choices.length/e.grid_rows):e.grid_columns,d=e.grid_rows===null?Math.ceil(e.choices.length/e.grid_columns):e.grid_rows;r.style.gridTemplateColumns=`repeat(${u}, 1fr)`,r.style.gridTemplateRows=`repeat(${d}, 1fr)`}else e.button_layout==="flex"&&r.classList.add("jspsych-btn-group-flex");for(const[u,d]of e.choices.entries()){r.insertAdjacentHTML("beforeend",e.button_html(d,u));const f=r.lastChild;f.dataset.choice=u.toString(),f.addEventListener("click",()=>{l(u)})}t.appendChild(r),e.prompt!==null&&t.insertAdjacentHTML("beforeend",e.prompt);var n=performance.now(),o={rt:null,button:null};const a=()=>{var u={rt:o.rt,stimulus:e.stimulus,response:o.button};this.jsPsych.finishTrial(u)};function l(u){var d=performance.now(),f=Math.round(d-n);o.button=parseInt(u),o.rt=f,s.classList.add("responded");for(const p of r.children)p.setAttribute("disabled","disabled");e.response_ends_trial&&a()}if(e.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{s.style.visibility="hidden"},e.stimulus_duration),e.enable_button_after>0){for(var h=document.querySelectorAll("#jspsych-html-button-response-btngroup button"),c=0;c<h.length;c++)h[c].setAttribute("disabled","disabled");this.jsPsych.pluginAPI.setTimeout(()=>{for(var u=document.querySelectorAll("#jspsych-html-button-response-btngroup button"),d=0;d<u.length;d++)u[d].removeAttribute("disabled")},e.enable_button_after)}e.trial_duration!==null&&this.jsPsych.pluginAPI.setTimeout(a,e.trial_duration)}simulate(t,e,s,r){e=="data-only"&&(r(),this.simulate_data_only(t,s)),e=="visual"&&this.simulate_visual(t,s,r)}create_simulation_data(t,e){const s={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+t.enable_button_after,response:this.jsPsych.randomization.randomInt(0,t.choices.length-1)},r=this.jsPsych.pluginAPI.mergeSimulationData(s,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,r),r}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const r=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s(),r.rt!==null&&this.jsPsych.pluginAPI.clickTarget(n.querySelector(`#jspsych-html-button-response-btngroup [data-choice="${r.response}"]`),r.rt)}};er.info=Ml;let Ht=er;var kl="2.2.0";const El={name:"image-button-response",version:kl,parameters:{stimulus:{type:C.IMAGE,default:void 0},stimulus_height:{type:C.INT,default:null},stimulus_width:{type:C.INT,default:null},maintain_aspect_ratio:{type:C.BOOL,default:!0},choices:{type:C.STRING,default:void 0,array:!0},button_html:{type:C.FUNCTION,default:function(i,t){return`<button class="jspsych-btn">${i}</button>`}},prompt:{type:C.HTML_STRING,default:null},stimulus_duration:{type:C.INT,default:null},trial_duration:{type:C.INT,default:null},button_layout:{type:C.STRING,default:"grid"},grid_rows:{type:C.INT,default:1},grid_columns:{type:C.INT,default:null},response_ends_trial:{type:C.BOOL,default:!0},render_on_canvas:{type:C.BOOL,default:!0},enable_button_after:{type:C.INT,default:0}},data:{stimulus:{type:C.STRING},response:{type:C.INT},rt:{type:C.INT}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},sr=class sr{constructor(t){this.jsPsych=t}trial(t,e){const s=m=>{let g,x;return e.stimulus_height!==null?(x=e.stimulus_height,e.stimulus_width==null&&e.maintain_aspect_ratio&&(g=m.naturalWidth*(e.stimulus_height/m.naturalHeight))):x=m.naturalHeight,e.stimulus_width!==null?(g=e.stimulus_width,e.stimulus_height==null&&e.maintain_aspect_ratio&&(x=m.naturalHeight*(e.stimulus_width/m.naturalWidth))):e.stimulus_height!==null&&e.maintain_aspect_ratio||(g=m.naturalWidth),[g,x]};t.innerHTML="";let r,n;const o=e.render_on_canvas?new Image:document.createElement("img");e.render_on_canvas?(n=document.createElement("canvas"),n.style.margin="0",n.style.padding="0",r=n):r=o;const a=()=>{const[m,g]=s(o);e.render_on_canvas?(n.width=m,n.height=g,n.getContext("2d").drawImage(o,0,0,m,g)):(o.style.width=`${m}px`,o.style.height=`${g}px`)};let l=!1;o.onload=()=>{l||a()},o.src=e.stimulus,o.complete&&o.naturalWidth!==0&&(a(),l=!0),r.id="jspsych-image-button-response-stimulus",t.appendChild(r);const h=document.createElement("div");if(h.id="jspsych-image-button-response-btngroup",e.button_layout==="grid"){if(h.classList.add("jspsych-btn-group-grid"),e.grid_rows===null&&e.grid_columns===null)throw new Error("You cannot set `grid_rows` to `null` without providing a value for `grid_columns`.");const m=e.grid_columns===null?Math.ceil(e.choices.length/e.grid_rows):e.grid_columns,g=e.grid_rows===null?Math.ceil(e.choices.length/e.grid_columns):e.grid_rows;h.style.gridTemplateColumns=`repeat(${m}, 1fr)`,h.style.gridTemplateRows=`repeat(${g}, 1fr)`}else e.button_layout==="flex"&&h.classList.add("jspsych-btn-group-flex");for(const[m,g]of e.choices.entries()){h.insertAdjacentHTML("beforeend",e.button_html(g,m));const x=h.lastChild;x.dataset.choice=m.toString(),x.addEventListener("click",()=>{f(m)})}t.appendChild(h),e.prompt!==null&&t.insertAdjacentHTML("beforeend",e.prompt);var c=performance.now(),u={rt:null,button:null};const d=()=>{var m={rt:u.rt,stimulus:e.stimulus,response:u.button};this.jsPsych.finishTrial(m)};function f(m){var g=performance.now(),x=Math.round(g-c);u.button=parseInt(m),u.rt=x,r.classList.add("responded");for(const _ of h.children)_.setAttribute("disabled","disabled");e.response_ends_trial&&d()}function p(){for(var m=document.querySelectorAll("#jspsych-image-button-response-btngroup button"),g=0;g<m.length;g++)m[g].removeAttribute("disabled")}function y(){for(var m=document.querySelectorAll("#jspsych-image-button-response-btngroup button"),g=0;g<m.length;g++)m[g].setAttribute("disabled","disabled")}e.enable_button_after>0&&(y(),this.jsPsych.pluginAPI.setTimeout(()=>{p()},e.enable_button_after)),e.stimulus_duration!==null&&this.jsPsych.pluginAPI.setTimeout(()=>{r.style.visibility="hidden"},e.stimulus_duration),e.trial_duration!==null?this.jsPsych.pluginAPI.setTimeout(()=>{d()},e.trial_duration):e.response_ends_trial===!1&&console.warn("The experiment may be deadlocked. Try setting a trial duration or set response_ends_trial to true.")}simulate(t,e,s,r){e=="data-only"&&(r(),this.simulate_data_only(t,s)),e=="visual"&&this.simulate_visual(t,s,r)}create_simulation_data(t,e){const s={stimulus:t.stimulus,rt:this.jsPsych.randomization.sampleExGaussian(500,50,.006666666666666667,!0)+t.enable_button_after,response:this.jsPsych.randomization.randomInt(0,t.choices.length-1)},r=this.jsPsych.pluginAPI.mergeSimulationData(s,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,r),r}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const r=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s(),r.rt!==null&&this.jsPsych.pluginAPI.clickTarget(n.querySelector(`#jspsych-image-button-response-btngroup [data-choice="${r.response}"]`),r.rt)}};sr.info=El;let fi=sr;var Il="2.1.0";const Rl={name:"survey-text",version:Il,parameters:{questions:{type:C.COMPLEX,array:!0,default:void 0,nested:{prompt:{type:C.HTML_STRING,default:void 0},placeholder:{type:C.STRING,default:""},rows:{type:C.INT,default:1},columns:{type:C.INT,default:40},required:{type:C.BOOL,default:!1},name:{type:C.STRING,default:""}}},randomize_question_order:{type:C.BOOL,default:!1},preamble:{type:C.HTML_STRING,default:null},button_label:{type:C.STRING,default:"Continue"},autocomplete:{type:C.BOOL,default:!1}},data:{response:{type:C.OBJECT},rt:{type:C.INT},question_order:{type:C.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},ir=class ir{constructor(t){this.jsPsych=t}trial(t,e){for(var s=0;s<e.questions.length;s++)typeof e.questions[s].rows>"u"&&(e.questions[s].rows=1);for(var s=0;s<e.questions.length;s++)typeof e.questions[s].columns>"u"&&(e.questions[s].columns=40);for(var s=0;s<e.questions.length;s++)typeof e.questions[s].value>"u"&&(e.questions[s].value="");var r="";e.preamble!==null&&(r+='<div id="jspsych-survey-text-preamble" class="jspsych-survey-text-preamble">'+e.preamble+"</div>"),e.autocomplete?r+='<form id="jspsych-survey-text-form">':r+='<form id="jspsych-survey-text-form" autocomplete="off">';for(var n=[],s=0;s<e.questions.length;s++)n.push(s);e.randomize_question_order&&(n=this.jsPsych.randomization.shuffle(n));for(var s=0;s<e.questions.length;s++){var o=e.questions[n[s]],a=n[s];r+='<div id="jspsych-survey-text-'+a+'" class="jspsych-survey-text-question" style="margin: 2em 0em;">',r+='<p class="jspsych-survey-text">'+o.prompt+"</p>";var l=s==0?"autofocus":"",h=o.required?"required":"";o.rows==1?r+='<input type="text" id="input-'+a+'"  name="#jspsych-survey-text-response-'+a+'" data-name="'+o.name+'" size="'+o.columns+'" '+l+" "+h+' placeholder="'+o.placeholder+'"></input>':r+='<textarea id="input-'+a+'" name="#jspsych-survey-text-response-'+a+'" data-name="'+o.name+'" cols="'+o.columns+'" rows="'+o.rows+'" '+l+" "+h+' placeholder="'+o.placeholder+'"></textarea>',r+="</div>"}r+='<input type="submit" id="jspsych-survey-text-next" class="jspsych-btn jspsych-survey-text" value="'+e.button_label+'"></input>',r+="</form>",t.innerHTML=r,t.querySelector("#input-"+n[0]).focus(),t.querySelector("#jspsych-survey-text-form").addEventListener("submit",u=>{u.preventDefault();for(var d=performance.now(),f=Math.round(d-c),p={},y=0;y<e.questions.length;y++){var m="Q"+y,g=document.querySelector("#jspsych-survey-text-"+y).querySelector("textarea, input"),x=g.value,_=g.attributes["data-name"].value;_==""&&(_=m);var b={};b[_]=x,Object.assign(p,b)}var A={rt:f,response:p};this.jsPsych.finishTrial(A)});var c=performance.now()}simulate(t,e,s,r){e=="data-only"&&(r(),this.simulate_data_only(t,s)),e=="visual"&&this.simulate_visual(t,s,r)}create_simulation_data(t,e){const s={};let r=1e3;for(const a of t.questions){const l=a.name?a.name:`Q${t.questions.indexOf(a)}`,h=a.rows==1?this.jsPsych.randomization.sampleExponential(.25):this.jsPsych.randomization.randomInt(1,10)*a.rows;s[l]=this.jsPsych.randomization.randomWords({exactly:h,join:" "}),r+=this.jsPsych.randomization.sampleExGaussian(2e3,400,.004,!0)}const n={response:s,rt:r},o=this.jsPsych.pluginAPI.mergeSimulationData(n,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,o),o}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const r=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s();const o=Object.entries(r.response).map(a=>a[1]);for(let a=0;a<o.length;a++)this.jsPsych.pluginAPI.fillTextInput(n.querySelector(`#input-${a}`),o[a],(r.rt-1e3)/o.length*(a+1));this.jsPsych.pluginAPI.clickTarget(n.querySelector("#jspsych-survey-text-next"),r.rt)}};ir.info=Rl;let pi=ir;var Bl="2.1.0";const Ll={name:"survey-multi-choice",version:Bl,parameters:{questions:{type:C.COMPLEX,array:!0,nested:{prompt:{type:C.HTML_STRING,default:void 0},options:{type:C.STRING,array:!0,default:void 0},required:{type:C.BOOL,default:!1},horizontal:{type:C.BOOL,default:!1},name:{type:C.STRING,default:""}}},randomize_question_order:{type:C.BOOL,default:!1},preamble:{type:C.HTML_STRING,default:null},button_label:{type:C.STRING,default:"Continue"},autocomplete:{type:C.BOOL,default:!1}},data:{response:{type:C.OBJECT},rt:{type:C.INT},question_order:{type:C.INT,array:!0}},citations:{apa:"de Leeuw, J. R., Gilbert, R. A., & Luchterhandt, B. (2023). jsPsych: Enabling an Open-Source Collaborative Ecosystem of Behavioral Experiments. Journal of Open Source Software, 8(85), 5351. https://doi.org/10.21105/joss.05351 ",bibtex:'@article{Leeuw2023jsPsych, 	author = {de Leeuw, Joshua R. and Gilbert, Rebecca A. and Luchterhandt, Bj{\\" o}rn}, 	journal = {Journal of Open Source Software}, 	doi = {10.21105/joss.05351}, 	issn = {2475-9066}, 	number = {85}, 	year = {2023}, 	month = {may 11}, 	pages = {5351}, 	publisher = {Open Journals}, 	title = {jsPsych: Enabling an {Open}-{Source} {Collaborative} {Ecosystem} of {Behavioral} {Experiments}}, 	url = {https://joss.theoj.org/papers/10.21105/joss.05351}, 	volume = {8}, }  '}},W="jspsych-survey-multi-choice",rr=class rr{constructor(t){this.jsPsych=t}trial(t,e){const s=`${W}_form`;var r="";r+=`
    <style id="${W}-css">
      .${W}-question { margin-top: 2em; margin-bottom: 2em; text-align: left; }
      .${W}-text span.required {color: darkred;}
      .${W}-horizontal .${W}-text {  text-align: center;}
      .${W}-option { line-height: 2; }
      .${W}-horizontal .${W}-option {  display: inline-block;  margin-left: 1em;  margin-right: 1em;  vertical-align: top;}
      label.${W}-text input[type='radio'] {margin-right: 1em;}
      </style>`,e.preamble!==null&&(r+=`<div id="${W}-preamble" class="${W}-preamble">${e.preamble}</div>`),e.autocomplete?r+=`<form id="${s}">`:r+=`<form id="${s}" autocomplete="off">`;for(var n=[],o=0;o<e.questions.length;o++)n.push(o);e.randomize_question_order&&(n=this.jsPsych.randomization.shuffle(n));for(var o=0;o<e.questions.length;o++){var a=e.questions[n[o]],l=n[o],h=[`${W}-question`];a.horizontal&&h.push(`${W}-horizontal`),r+=`<div id="${W}-${l}" class="${h.join(" ")}" data-name="${a.name}">`,r+=`<p class="${W}-text survey-multi-choice">${a.prompt}`,a.required&&(r+="<span class='required'>*</span>"),r+="</p>";for(var c=0;c<a.options.length;c++){var u=`${W}-option-${l}-${c}`,d=`${W}-response-${l}`,f=`${W}-response-${l}-${c}`,p=a.required?"required":"";r+=`
        <div id="${u}" class="${W}-option">
          <label class="${W}-text" for="${f}">
            <input type="radio" name="${d}" id="${f}" value="${a.options[c]}" ${p} />
            ${a.options[c]}
            </label>
        </div>`}r+="</div>"}r+=`<input type="submit" id="${W}-next" class="${W} jspsych-btn"${e.button_label?' value="'+e.button_label+'"':""} />`,r+="</form>",t.innerHTML=r,t.querySelector(`#${s}`).addEventListener("submit",g=>{g.preventDefault();for(var x=performance.now(),_=Math.round(x-m),b={},A=0;A<e.questions.length;A++){var v=t.querySelector(`#${W}-${A}`),w="Q"+A,T;v.querySelector("input[type=radio]:checked")!==null?T=v.querySelector("input[type=radio]:checked").value:T="";var P={},S=w;v.attributes["data-name"].value!==""&&(S=v.attributes["data-name"].value),P[S]=T,Object.assign(b,P)}var M={rt:_,response:b,question_order:n};this.jsPsych.finishTrial(M)});var m=performance.now()}simulate(t,e,s,r){e=="data-only"&&(r(),this.simulate_data_only(t,s)),e=="visual"&&this.simulate_visual(t,s,r)}create_simulation_data(t,e){const s={};let r=1e3;for(const a of t.questions){const l=a.name?a.name:`Q${t.questions.indexOf(a)}`;s[l]=this.jsPsych.randomization.sampleWithoutReplacement(a.options,1)[0],r+=this.jsPsych.randomization.sampleExGaussian(1500,400,1/200,!0)}const n={response:s,rt:r,question_order:t.randomize_question_order?this.jsPsych.randomization.shuffle([...Array(t.questions.length).keys()]):[...Array(t.questions.length).keys()]},o=this.jsPsych.pluginAPI.mergeSimulationData(n,e);return this.jsPsych.pluginAPI.ensureSimulationDataConsistency(t,o),o}simulate_data_only(t,e){const s=this.create_simulation_data(t,e);this.jsPsych.finishTrial(s)}simulate_visual(t,e,s){const r=this.create_simulation_data(t,e),n=this.jsPsych.getDisplayElement();this.trial(n,t),s();const o=Object.entries(r.response);for(let a=0;a<o.length;a++)this.jsPsych.pluginAPI.clickTarget(n.querySelector(`#${W}-response-${a}-${t.questions[a].options.indexOf(o[a][1])}`),(r.rt-1e3)/o.length*(a+1));this.jsPsych.pluginAPI.clickTarget(n.querySelector(`#${W}-next`),r.rt)}};rr.info=Ll;let mi=rr;const Fl="modulepreload",Ol=function(i){return"/"+i},wr={},vs=function(t,e,s){let r=Promise.resolve();if(e&&e.length>0){let l=function(h){return Promise.all(h.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");r=l(e.map(h=>{if(h=Ol(h),h in wr)return;wr[h]=!0;const c=h.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":Fl,c||(d.as="script"),d.crossOrigin="",d.href=h,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,p)=>{d.addEventListener("load",f),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function n(o){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o}return r.then(o=>{for(const a of o||[])a.status==="rejected"&&n(a.reason);return t().catch(n)})};var I=(i=>(i.Application="application",i.WebGLPipes="webgl-pipes",i.WebGLPipesAdaptor="webgl-pipes-adaptor",i.WebGLSystem="webgl-system",i.WebGPUPipes="webgpu-pipes",i.WebGPUPipesAdaptor="webgpu-pipes-adaptor",i.WebGPUSystem="webgpu-system",i.CanvasSystem="canvas-system",i.CanvasPipesAdaptor="canvas-pipes-adaptor",i.CanvasPipes="canvas-pipes",i.Asset="asset",i.LoadParser="load-parser",i.ResolveParser="resolve-parser",i.CacheParser="cache-parser",i.DetectionParser="detection-parser",i.MaskEffect="mask-effect",i.BlendMode="blend-mode",i.TextureSource="texture-source",i.Environment="environment",i.ShapeBuilder="shape-builder",i.Batcher="batcher",i))(I||{});const gi=i=>{if(typeof i=="function"||typeof i=="object"&&i.extension){if(!i.extension)throw new Error("Extension class must have an extension object");i={...typeof i.extension!="object"?{type:i.extension}:i.extension,ref:i}}if(typeof i=="object")i={...i};else throw new Error("Invalid extension type");return typeof i.type=="string"&&(i.type=[i.type]),i},Ue=(i,t)=>gi(i).priority??t,Q={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...i){return i.map(gi).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...i){return i.map(gi).forEach(t=>{t.type.forEach(e=>{const s=this._addHandlers,r=this._queue;s[e]?s[e]?.(t):(r[e]=r[e]||[],r[e]?.push(t))})}),this},handle(i,t,e){const s=this._addHandlers,r=this._removeHandlers;if(s[i]||r[i])throw new Error(`Extension type ${i} already has a handler`);s[i]=t,r[i]=e;const n=this._queue;return n[i]&&(n[i]?.forEach(o=>t(o)),delete n[i]),this},handleByMap(i,t){return this.handle(i,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(i,t,e=-1){return this.handle(i,s=>{t.findIndex(n=>n.name===s.name)>=0||(t.push({name:s.name,value:s.ref}),t.sort((n,o)=>Ue(o.value,e)-Ue(n.value,e)))},s=>{const r=t.findIndex(n=>n.name===s.name);r!==-1&&t.splice(r,1)})},handleByList(i,t,e=-1){return this.handle(i,s=>{t.includes(s.ref)||(t.push(s.ref),t.sort((r,n)=>Ue(n,e)-Ue(r,e)))},s=>{const r=t.indexOf(s.ref);r!==-1&&t.splice(r,1)})},mixin(i,...t){for(const e of t)Object.defineProperties(i.prototype,Object.getOwnPropertyDescriptors(e))}},jl={extension:{type:I.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await vs(()=>import("./browserAll-DE3DV3yI.js"),__vite__mapDeps([0,1,2]))}},Gl={extension:{type:I.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await vs(()=>import("./webworkerAll-Cg4ThL1j.js"),__vite__mapDeps([1,2]))}};class Z{constructor(t,e,s){this._x=e||0,this._y=s||0,this._observer=t}clone(t){return new Z(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}var js={exports:{}},vr;function zl(){return vr||(vr=1,(function(i){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(l,h,c){this.fn=l,this.context=h,this.once=c||!1}function n(l,h,c,u,d){if(typeof c!="function")throw new TypeError("The listener must be a function");var f=new r(c,u||l,d),p=e?e+h:h;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function o(l,h){--l._eventsCount===0?l._events=new s:delete l._events[h]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},a.prototype.listeners=function(h){var c=e?e+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,f=u.length,p=new Array(f);d<f;d++)p[d]=u[d].fn;return p},a.prototype.listenerCount=function(h){var c=e?e+h:h,u=this._events[c];return u?u.fn?1:u.length:0},a.prototype.emit=function(h,c,u,d,f,p){var y=e?e+h:h;if(!this._events[y])return!1;var m=this._events[y],g=arguments.length,x,_;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,d),!0;case 5:return m.fn.call(m.context,c,u,d,f),!0;case 6:return m.fn.call(m.context,c,u,d,f,p),!0}for(_=1,x=new Array(g-1);_<g;_++)x[_-1]=arguments[_];m.fn.apply(m.context,x)}else{var b=m.length,A;for(_=0;_<b;_++)switch(m[_].once&&this.removeListener(h,m[_].fn,void 0,!0),g){case 1:m[_].fn.call(m[_].context);break;case 2:m[_].fn.call(m[_].context,c);break;case 3:m[_].fn.call(m[_].context,c,u);break;case 4:m[_].fn.call(m[_].context,c,u,d);break;default:if(!x)for(A=1,x=new Array(g-1);A<g;A++)x[A-1]=arguments[A];m[_].fn.apply(m[_].context,x)}}return!0},a.prototype.on=function(h,c,u){return n(this,h,c,u,!1)},a.prototype.once=function(h,c,u){return n(this,h,c,u,!0)},a.prototype.removeListener=function(h,c,u,d){var f=e?e+h:h;if(!this._events[f])return this;if(!c)return o(this,f),this;var p=this._events[f];if(p.fn)p.fn===c&&(!d||p.once)&&(!u||p.context===u)&&o(this,f);else{for(var y=0,m=[],g=p.length;y<g;y++)(p[y].fn!==c||d&&!p[y].once||u&&p[y].context!==u)&&m.push(p[y]);m.length?this._events[f]=m.length===1?m[0]:m:o(this,f)}return this},a.prototype.removeAllListeners=function(h){var c;return h?(c=e?e+h:h,this._events[c]&&o(this,c)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,i.exports=a})(js)),js.exports}var Nl=zl();const gt=ze(Nl),Dl=Math.PI*2,Wl=180/Math.PI,$l=Math.PI/180;class et{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new et(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return Gs.x=0,Gs.y=0,Gs}}const Gs=new et;class O{constructor(t=1,e=0,s=0,r=1,n=0,o=0){this.array=null,this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,s,r,n,o){return this.a=t,this.b=e,this.c=s,this.d=r,this.tx=n,this.ty=o,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s}apply(t,e){e=e||new et;const s=t.x,r=t.y;return e.x=this.a*s+this.c*r+this.tx,e.y=this.b*s+this.d*r+this.ty,e}applyInverse(t,e){e=e||new et;const s=this.a,r=this.b,n=this.c,o=this.d,a=this.tx,l=this.ty,h=1/(s*o+n*-r),c=t.x,u=t.y;return e.x=o*h*c+-n*h*u+(l*n-a*o)*h,e.y=s*h*u+-r*h*c+(-l*s+a*r)*h,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),s=Math.sin(t),r=this.a,n=this.c,o=this.tx;return this.a=r*e-this.b*s,this.b=r*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=o*e-this.ty*s,this.ty=o*s+this.ty*e,this}append(t){const e=this.a,s=this.b,r=this.c,n=this.d;return this.a=t.a*e+t.b*r,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*r,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*r+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this}appendFrom(t,e){const s=t.a,r=t.b,n=t.c,o=t.d,a=t.tx,l=t.ty,h=e.a,c=e.b,u=e.c,d=e.d;return this.a=s*h+r*u,this.b=s*c+r*d,this.c=n*h+o*u,this.d=n*c+o*d,this.tx=a*h+l*u+e.tx,this.ty=a*c+l*d+e.ty,this}setTransform(t,e,s,r,n,o,a,l,h){return this.a=Math.cos(a+h)*n,this.b=Math.sin(a+h)*n,this.c=-Math.sin(a-l)*o,this.d=Math.cos(a-l)*o,this.tx=t-(s*this.a+r*this.c),this.ty=e-(s*this.b+r*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const s=this.a,r=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=r*t.a+this.d*t.c,this.d=r*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,s=this.b,r=this.c,n=this.d,o=t.pivot,a=-Math.atan2(-r,n),l=Math.atan2(s,e),h=Math.abs(a+l);return h<1e-5||Math.abs(Dl-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=a,t.skew.y=l),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(r*r+n*n),t.position.x=this.tx+(o.x*e+o.y*r),t.position.y=this.ty+(o.x*s+o.y*n),t}invert(){const t=this.a,e=this.b,s=this.c,r=this.d,n=this.tx,o=t*r-e*s;return this.a=r/o,this.b=-e/o,this.c=-s/o,this.d=t/o,this.tx=(s*this.ty-r*n)/o,this.ty=-(t*this.ty-e*n)/o,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new O;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return Ul.identity()}static get shared(){return Vl.identity()}}const Vl=new O,Ul=new O,Dt=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Wt=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],$t=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Vt=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],yi=[],Xn=[],He=Math.sign;function Hl(){for(let i=0;i<16;i++){const t=[];yi.push(t);for(let e=0;e<16;e++){const s=He(Dt[i]*Dt[e]+$t[i]*Wt[e]),r=He(Wt[i]*Dt[e]+Vt[i]*Wt[e]),n=He(Dt[i]*$t[e]+$t[i]*Vt[e]),o=He(Wt[i]*$t[e]+Vt[i]*Vt[e]);for(let a=0;a<16;a++)if(Dt[a]===s&&Wt[a]===r&&$t[a]===n&&Vt[a]===o){t.push(a);break}}}for(let i=0;i<16;i++){const t=new O;t.set(Dt[i],Wt[i],$t[i],Vt[i],0,0),Xn.push(t)}}Hl();const D={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:i=>Dt[i],uY:i=>Wt[i],vX:i=>$t[i],vY:i=>Vt[i],inv:i=>i&8?i&15:-i&7,add:(i,t)=>yi[i][t],sub:(i,t)=>yi[i][D.inv(t)],rotate180:i=>i^4,isVertical:i=>(i&3)===2,byDirection:(i,t)=>Math.abs(i)*2<=Math.abs(t)?t>=0?D.S:D.N:Math.abs(t)*2<=Math.abs(i)?i>0?D.E:D.W:t>0?i>0?D.SE:D.SW:i>0?D.NE:D.NW,matrixAppendRotationInv:(i,t,e=0,s=0)=>{const r=Xn[D.inv(t)];r.tx=e,r.ty=s,i.append(r)},transformRectCoords:(i,t,e,s)=>{const{x:r,y:n,width:o,height:a}=i,{x:l,y:h,width:c,height:u}=t;return e===D.E?(s.set(r+l,n+h,o,a),s):e===D.S?s.set(c-n-a+l,r+h,a,o):e===D.W?s.set(c-r-o+l,u-n-a+h,o,a):e===D.N?s.set(n+l,u-r-o+h,a,o):s.set(r+l,n+h,o,a)}},qe=[new et,new et,new et,new et];class H{constructor(t=0,e=0,s=0,r=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(r)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new H(0,0,0,0)}clone(){return new H(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,s,r=.5){const{width:n,height:o}=this;if(n<=0||o<=0)return!1;const a=this.x,l=this.y,h=s*(1-r),c=s-h,u=a-h,d=a+n+h,f=l-h,p=l+o+h,y=a+c,m=a+n-c,g=l+c,x=l+o-c;return t>=u&&t<=d&&e>=f&&e<=p&&!(t>y&&t<m&&e>g&&e<x)}intersects(t,e){if(!e){const T=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=T)return!1;const S=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>S}const s=this.left,r=this.right,n=this.top,o=this.bottom;if(r<=s||o<=n)return!1;const a=qe[0].set(t.left,t.top),l=qe[1].set(t.left,t.bottom),h=qe[2].set(t.right,t.top),c=qe[3].set(t.right,t.bottom);if(h.x<=a.x||l.y<=a.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(a,a),e.apply(l,l),e.apply(h,h),e.apply(c,c),Math.max(a.x,l.x,h.x,c.x)<=s||Math.min(a.x,l.x,h.x,c.x)>=r||Math.max(a.y,l.y,h.y,c.y)<=n||Math.min(a.y,l.y,h.y,c.y)>=o))return!1;const d=u*(l.y-a.y),f=u*(a.x-l.x),p=d*s+f*n,y=d*r+f*n,m=d*s+f*o,g=d*r+f*o;if(Math.max(p,y,m,g)<=d*a.x+f*a.y||Math.min(p,y,m,g)>=d*c.x+f*c.y)return!1;const x=u*(a.y-h.y),_=u*(h.x-a.x),b=x*s+_*n,A=x*r+_*n,v=x*s+_*o,w=x*r+_*o;return!(Math.max(b,A,v,w)<=x*a.x+_*a.y||Math.min(b,A,v,w)>=x*c.x+_*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),r=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=r,this.height=Math.max(n-r,0),this}ceil(t=1,e=.001){const s=Math.ceil((this.x+this.width-e)*t)/t,r=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=r-this.y,this}scale(t,e=t){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}enlarge(t){const e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),r=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=r,this.height=n-r,this}getBounds(t){return t||(t=new H),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,s=t.y,r=t.x+t.width,n=t.y+t.height;return e>=this.x&&e<this.x+this.width&&s>=this.y&&s<this.y+this.height&&r>=this.x&&r<this.x+this.width&&n>=this.y&&n<this.y+this.height}set(t,e,s,r){return this.x=t,this.y=e,this.width=s,this.height=r,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const zs={default:-1};function X(i="default"){return zs[i]===void 0&&(zs[i]=-1),++zs[i]}const Ar=new Set,N="8.0.0",ql="8.3.4",Zt={quiet:!1,noColor:!1},L=(i,t,e=3)=>{if(Zt.quiet||Ar.has(t))return;let s=new Error().stack;const r=`${t}
Deprecated since v${i}`,n=typeof console.groupCollapsed=="function"&&!Zt.noColor;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",r):(s=s.split(`
`).splice(e).join(`
`),n?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",r),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",r),console.warn(s))),Ar.add(t)};Object.defineProperties(L,{quiet:{get:()=>Zt.quiet,set:i=>{Zt.quiet=i},enumerable:!0,configurable:!1},noColor:{get:()=>Zt.noColor,set:i=>{Zt.noColor=i},enumerable:!0,configurable:!1}});const Kn=()=>{};function se(i){return i+=i===0?1:0,--i,i|=i>>>1,i|=i>>>2,i|=i>>>4,i|=i>>>8,i|=i>>>16,i+1}function Sr(i){return!(i&i-1)&&!!i}function Jn(i){const t={};for(const e in i)i[e]!==void 0&&(t[e]=i[e]);return t}const Pr=Object.create(null);function Yl(i){const t=Pr[i];return t===void 0&&(Pr[i]=X("resource")),t}const Zn=class Qn extends gt{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Qn.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){L(N,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this.emit("change",this),this._sharedResourceId=null}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=Yl(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};Zn.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let ie=Zn;const to=class eo extends gt{constructor(t={}){super(),this.options=t,this.uid=X("textureSource"),this._resourceType="textureSource",this._resourceId=X("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...eo.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new ie(Jn(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){this.style!==t&&(this._style?.off("change",this._onStyleChange,this),this._style=t,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(t){this._style.maxAnisotropy=t}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=X("resource"),this.emit("change",this),this.emit("unload",this)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,s){s||(s=this._resolution),t||(t=this.width),e||(e=this.height);const r=Math.round(t*s),n=Math.round(e*s);return this.width=r/s,this.height=n/s,this._resolution=s,this.pixelWidth===r&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=r,this.pixelHeight=n,this.emit("resize",this),this._resourceId=X("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Sr(this.pixelWidth)&&Sr(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};to.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let yt=to;class zi extends yt{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let s=t.format;s||(e instanceof Float32Array?s="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?s="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?s="rgba16uint":(e instanceof Int8Array,s="bgra8unorm")),super({...t,resource:e,format:s}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}zi.extension=I.TextureSource;const Cr=new O;class Xl{constructor(t,e){this.mapCoord=new O,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){this.texture!==t&&(this._texture?.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const s=this.mapCoord;for(let r=0;r<t.length;r+=2){const n=t[r],o=t[r+1];e[r]=n*s.a+o*s.c+s.tx,e[r+1]=n*s.b+o*s.d+s.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const s=t.orig,r=t.trim;r&&(Cr.set(s.width/r.width,0,0,s.height/r.height,-r.x/r.width,-r.y/r.height),this.mapCoord.append(Cr));const n=t.source,o=this.uClampFrame,a=this.clampMargin/n._resolution,l=this.clampOffset/n._resolution;return o[0]=(t.frame.x+a+l)/n.width,o[1]=(t.frame.y+a+l)/n.height,o[2]=(t.frame.x+t.frame.width-a+l)/n.width,o[3]=(t.frame.y+t.frame.height-a+l)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}}class j extends gt{constructor({source:t,label:e,frame:s,orig:r,trim:n,defaultAnchor:o,defaultBorders:a,rotate:l,dynamic:h}={}){if(super(),this.uid=X("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new H,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=t?.source??new yt,this.noFrame=!s,s)this.frame.copyFrom(s);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=r||this.frame,this.trim=n,this.rotate=l??0,this.defaultAnchor=o,this.defaultBorders=a,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new Xl(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:s,height:r}=this._source,n=e.x/s,o=e.y/r,a=e.width/s,l=e.height/r;let h=this.rotate;if(h){const c=a/2,u=l/2,d=n+c,f=o+u;h=D.add(h,D.NW),t.x0=d+c*D.uX(h),t.y0=f+u*D.uY(h),h=D.add(h,2),t.x1=d+c*D.uX(h),t.y1=f+u*D.uY(h),h=D.add(h,2),t.x2=d+c*D.uX(h),t.y2=f+u*D.uY(h),h=D.add(h,2),t.x3=d+c*D.uX(h),t.y3=f+u*D.uY(h)}else t.x0=n,t.y0=o,t.x1=n+a,t.y1=o,t.x2=n+a,t.y2=o+l,t.x3=n,t.y3=o+l}destroy(t=!1){this._source&&(this._source.off("resize",this.update,this),t&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return L(N,"Texture.baseTexture is now Texture.source"),this._source}}j.EMPTY=new j({label:"EMPTY",source:new yt({label:"EMPTY"})});j.EMPTY.destroy=Kn;j.WHITE=new j({source:new zi({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});j.WHITE.destroy=Kn;function Kl(i,t,e){const{width:s,height:r}=e.orig,n=e.trim;if(n){const o=n.width,a=n.height;i.minX=n.x-t._x*s,i.maxX=i.minX+o,i.minY=n.y-t._y*r,i.maxY=i.minY+a}else i.minX=-t._x*s,i.maxX=i.minX+s,i.minY=-t._y*r,i.maxY=i.minY+r}const Tr=new O;class mt{constructor(t=1/0,e=1/0,s=-1/0,r=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Tr,this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new H);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Tr,this}set(t,e,s,r){this.minX=t,this.minY=e,this.maxX=s,this.maxY=r}addFrame(t,e,s,r,n){n||(n=this.matrix);const o=n.a,a=n.b,l=n.c,h=n.d,c=n.tx,u=n.ty;let d=this.minX,f=this.minY,p=this.maxX,y=this.maxY,m=o*t+l*e+c,g=a*t+h*e+u;m<d&&(d=m),g<f&&(f=g),m>p&&(p=m),g>y&&(y=g),m=o*s+l*e+c,g=a*s+h*e+u,m<d&&(d=m),g<f&&(f=g),m>p&&(p=m),g>y&&(y=g),m=o*t+l*r+c,g=a*t+h*r+u,m<d&&(d=m),g<f&&(f=g),m>p&&(p=m),g>y&&(y=g),m=o*s+l*r+c,g=a*s+h*r+u,m<d&&(d=m),g<f&&(f=g),m>p&&(p=m),g>y&&(y=g),this.minX=d,this.minY=f,this.maxX=p,this.maxY=y}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,s=this.minY,r=this.maxX,n=this.maxY,{a:o,b:a,c:l,d:h,tx:c,ty:u}=t;let d=o*e+l*s+c,f=a*e+h*s+u;this.minX=d,this.minY=f,this.maxX=d,this.maxY=f,d=o*r+l*s+c,f=a*r+h*s+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*e+l*n+c,f=a*e+h*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY,d=o*r+l*n+c,f=a*r+h*n+u,this.minX=d<this.minX?d:this.minX,this.minY=f<this.minY?f:this.minY,this.maxX=d>this.maxX?d:this.maxX,this.maxY=f>this.maxY?f:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,s,r){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<s&&(this.minY=s),this.maxY>r&&(this.maxY=r),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new mt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,s,r){let n=this.minX,o=this.minY,a=this.maxX,l=this.maxY;r||(r=this.matrix);const h=r.a,c=r.b,u=r.c,d=r.d,f=r.tx,p=r.ty;for(let y=e;y<s;y+=2){const m=t[y],g=t[y+1],x=h*m+u*g+f,_=c*m+d*g+p;n=x<n?x:n,o=_<o?_:o,a=x>a?x:a,l=_>l?_:l}this.minX=n,this.minY=o,this.maxX=a,this.maxY=l}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var Jl={grad:.9,turn:360,rad:360/(2*Math.PI)},vt=function(i){return typeof i=="string"?i.length>0:typeof i=="number"},J=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*i)/e+0},lt=function(i,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),i>e?e:i>t?i:t},so=function(i){return(i=isFinite(i)?i%360:0)>0?i:i+360},Mr=function(i){return{r:lt(i.r,0,255),g:lt(i.g,0,255),b:lt(i.b,0,255),a:lt(i.a)}},Ns=function(i){return{r:J(i.r),g:J(i.g),b:J(i.b),a:J(i.a,3)}},Zl=/^#([0-9a-f]{3,8})$/i,Ye=function(i){var t=i.toString(16);return t.length<2?"0"+t:t},io=function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=Math.max(t,e,s),o=n-Math.min(t,e,s),a=o?n===t?(e-s)/o:n===e?2+(s-t)/o:4+(t-e)/o:0;return{h:60*(a<0?a+6:a),s:n?o/n*100:0,v:n/255*100,a:r}},ro=function(i){var t=i.h,e=i.s,s=i.v,r=i.a;t=t/360*6,e/=100,s/=100;var n=Math.floor(t),o=s*(1-e),a=s*(1-(t-n)*e),l=s*(1-(1-t+n)*e),h=n%6;return{r:255*[s,a,o,o,l,s][h],g:255*[l,s,s,a,o,o][h],b:255*[o,o,l,s,s,a][h],a:r}},kr=function(i){return{h:so(i.h),s:lt(i.s,0,100),l:lt(i.l,0,100),a:lt(i.a)}},Er=function(i){return{h:J(i.h),s:J(i.s),l:J(i.l),a:J(i.a,3)}},Ir=function(i){return ro((e=(t=i).s,{h:t.h,s:(e*=((s=t.l)<50?s:100-s)/100)>0?2*e/(s+e)*100:0,v:s+e,a:t.a}));var t,e,s},Pe=function(i){return{h:(t=io(i)).h,s:(r=(200-(e=t.s))*(s=t.v)/100)>0&&r<200?e*s/100/(r<=100?r:200-r)*100:0,l:r/2,a:t.a};var t,e,s,r},Ql=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,th=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,eh=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,sh=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xi={string:[[function(i){var t=Zl.exec(i);return t?(i=t[1]).length<=4?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16),a:i.length===4?J(parseInt(i[3]+i[3],16)/255,2):1}:i.length===6||i.length===8?{r:parseInt(i.substr(0,2),16),g:parseInt(i.substr(2,2),16),b:parseInt(i.substr(4,2),16),a:i.length===8?J(parseInt(i.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(i){var t=eh.exec(i)||sh.exec(i);return t?t[2]!==t[4]||t[4]!==t[6]?null:Mr({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(i){var t=Ql.exec(i)||th.exec(i);if(!t)return null;var e,s,r=kr({h:(e=t[1],s=t[2],s===void 0&&(s="deg"),Number(e)*(Jl[s]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Ir(r)},"hsl"]],object:[[function(i){var t=i.r,e=i.g,s=i.b,r=i.a,n=r===void 0?1:r;return vt(t)&&vt(e)&&vt(s)?Mr({r:Number(t),g:Number(e),b:Number(s),a:Number(n)}):null},"rgb"],[function(i){var t=i.h,e=i.s,s=i.l,r=i.a,n=r===void 0?1:r;if(!vt(t)||!vt(e)||!vt(s))return null;var o=kr({h:Number(t),s:Number(e),l:Number(s),a:Number(n)});return Ir(o)},"hsl"],[function(i){var t=i.h,e=i.s,s=i.v,r=i.a,n=r===void 0?1:r;if(!vt(t)||!vt(e)||!vt(s))return null;var o=(function(a){return{h:so(a.h),s:lt(a.s,0,100),v:lt(a.v,0,100),a:lt(a.a)}})({h:Number(t),s:Number(e),v:Number(s),a:Number(n)});return ro(o)},"hsv"]]},Rr=function(i,t){for(var e=0;e<t.length;e++){var s=t[e][0](i);if(s)return[s,t[e][1]]}return[null,void 0]},ih=function(i){return typeof i=="string"?Rr(i.trim(),xi.string):typeof i=="object"&&i!==null?Rr(i,xi.object):[null,void 0]},Ds=function(i,t){var e=Pe(i);return{h:e.h,s:lt(e.s+100*t,0,100),l:e.l,a:e.a}},Ws=function(i){return(299*i.r+587*i.g+114*i.b)/1e3/255},Br=function(i,t){var e=Pe(i);return{h:e.h,s:e.s,l:lt(e.l+100*t,0,100),a:e.a}},_i=(function(){function i(t){this.parsed=ih(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return i.prototype.isValid=function(){return this.parsed!==null},i.prototype.brightness=function(){return J(Ws(this.rgba),2)},i.prototype.isDark=function(){return Ws(this.rgba)<.5},i.prototype.isLight=function(){return Ws(this.rgba)>=.5},i.prototype.toHex=function(){return t=Ns(this.rgba),e=t.r,s=t.g,r=t.b,o=(n=t.a)<1?Ye(J(255*n)):"","#"+Ye(e)+Ye(s)+Ye(r)+o;var t,e,s,r,n,o},i.prototype.toRgb=function(){return Ns(this.rgba)},i.prototype.toRgbString=function(){return t=Ns(this.rgba),e=t.r,s=t.g,r=t.b,(n=t.a)<1?"rgba("+e+", "+s+", "+r+", "+n+")":"rgb("+e+", "+s+", "+r+")";var t,e,s,r,n},i.prototype.toHsl=function(){return Er(Pe(this.rgba))},i.prototype.toHslString=function(){return t=Er(Pe(this.rgba)),e=t.h,s=t.s,r=t.l,(n=t.a)<1?"hsla("+e+", "+s+"%, "+r+"%, "+n+")":"hsl("+e+", "+s+"%, "+r+"%)";var t,e,s,r,n},i.prototype.toHsv=function(){return t=io(this.rgba),{h:J(t.h),s:J(t.s),v:J(t.v),a:J(t.a,3)};var t},i.prototype.invert=function(){return _t({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},i.prototype.saturate=function(t){return t===void 0&&(t=.1),_t(Ds(this.rgba,t))},i.prototype.desaturate=function(t){return t===void 0&&(t=.1),_t(Ds(this.rgba,-t))},i.prototype.grayscale=function(){return _t(Ds(this.rgba,-1))},i.prototype.lighten=function(t){return t===void 0&&(t=.1),_t(Br(this.rgba,t))},i.prototype.darken=function(t){return t===void 0&&(t=.1),_t(Br(this.rgba,-t))},i.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},i.prototype.alpha=function(t){return typeof t=="number"?_t({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):J(this.rgba.a,3);var e},i.prototype.hue=function(t){var e=Pe(this.rgba);return typeof t=="number"?_t({h:t,s:e.s,l:e.l,a:e.a}):J(e.h)},i.prototype.isEqual=function(t){return this.toHex()===_t(t).toHex()},i})(),_t=function(i){return i instanceof _i?i:new _i(i)},Lr=[],rh=function(i){i.forEach(function(t){Lr.indexOf(t)<0&&(t(_i,xi),Lr.push(t))})};function nh(i,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},s={};for(var r in e)s[e[r]]=r;var n={};i.prototype.toName=function(o){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var a,l,h=s[this.toHex()];if(h)return h;if(o?.closest){var c=this.toRgb(),u=1/0,d="black";if(!n.length)for(var f in e)n[f]=new i(e[f]).toRgb();for(var p in e){var y=(a=c,l=n[p],Math.pow(a.r-l.r,2)+Math.pow(a.g-l.g,2)+Math.pow(a.b-l.b,2));y<u&&(u=y,d=p)}return d}},t.string.push([function(o){var a=o.toLowerCase(),l=a==="transparent"?"#0000":e[a];return l?new i(l).toRgb():null},"name"])}rh([nh]);const re=class we{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof we)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const s=typeof t;if(s!==typeof e)return!1;if(s==="number"||s==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,o)=>n===e[o]);if(t!==null&&e!==null){const n=Object.keys(t),o=Object.keys(e);return n.length!==o.length?!1:n.every(a=>t[a]===e[a])}return t===e}toRgba(){const[t,e,s,r]=this._components;return{r:t,g:e,b:s,a:r}}toRgb(){const[t,e,s]=this._components;return{r:t,g:e,b:s}}toRgbaString(){const[t,e,s]=this.toUint8RgbArray();return`rgba(${t},${e},${s},${this.alpha})`}toUint8RgbArray(t){const[e,s,r]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(s*255),t[2]=Math.round(r*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,s,r,n]=this._components;return t[0]=e,t[1]=s,t[2]=r,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,s,r]=this._components;return t[0]=e,t[1]=s,t[2]=r,t}toNumber(){return this._int}toBgrNumber(){const[t,e,s]=this.toUint8RgbArray();return(s<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,s,r,n]=we._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=s,this._components[2]*=r,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let s=this._int>>16&255,r=this._int>>8&255,n=this._int&255;return e&&(s=s*t+.5|0,r=r*t+.5|0,n=n*t+.5|0),(t*255<<24)+(s<<16)+(r<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,s,r,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const o=t;e=(o>>16&255)/255,s=(o>>8&255)/255,r=(o&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,s,r,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,s,r,n=255]=t,e/=255,s/=255,r/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const a=we.HEX_PATTERN.exec(t);a&&(t=`#${a[2]}`)}const o=_t(t);o.isValid()&&({r:e,g:s,b:r,a:n}=o.rgba,e/=255,s/=255,r/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=s,this._components[2]=r,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,s]=this._components;this._int=(t*255<<16)+(e*255<<8)+(s*255|0)}_clamp(t,e=0,s=1){return typeof t=="number"?Math.min(Math.max(t,e),s):(t.forEach((r,n)=>{t[n]=Math.min(Math.max(r,e),s)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof we||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};re.shared=new re;re._temp=new re;re.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let K=re;const oh={cullArea:null,cullable:!1,cullableChildren:!0};let $s=0;const Fr=500;function U(...i){$s!==Fr&&($s++,$s===Fr?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...i))}const Ne={_registeredResources:new Set,register(i){this._registeredResources.add(i)},unregister(i){this._registeredResources.delete(i)},release(){this._registeredResources.forEach(i=>i.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(i){return this._registeredResources.has(i)},reset(){this._registeredResources.clear()}};class ah{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let e;return this._index>0?e=this._pool[--this._index]:(e=new this._classType,this._count++),e.init?.(t),e}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let t=0;t<this._index;t++)this._pool[t].destroy();this._pool.length=0,this._count=0,this._index=0}}class lh{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new ah(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const s=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[s]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}clear(){this._poolsByClass.forEach(t=>t.clear()),this._poolsByClass.clear()}}const ht=new lh;Ne.register(ht);const hh={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(i){typeof i=="boolean"&&i===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(i===!0?{}:i))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(i){L("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(i)}};function ch(i,t,e){const s=i.length;let r;if(t>=s||e===0)return;e=t+e>s?s-t:e;const n=s-e;for(r=t;r<n;++r)i[r]=i[r+e];i.length=n}const uh={allowChildren:!0,removeChildren(i=0,t){const e=t??this.children.length,s=e-i,r=[];if(s>0&&s<=e){for(let o=e-1;o>=i;o--){const a=this.children[o];a&&(r.push(a),a.parent=null)}ch(this.children,i,e);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(r);for(let o=0;o<r.length;++o){const a=r[o];a.parentRenderLayer?.detach(a),this.emit("childRemoved",a,this,o),r[o].emit("removed",this)}return r.length>0&&this._didViewChangeTick++,r}else if(s===0&&this.children.length===0)return r;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(i){const t=this.getChildAt(i);return this.removeChild(t)},getChildAt(i){if(i<0||i>=this.children.length)throw new Error(`getChildAt: Index (${i}) does not exist.`);return this.children[i]},setChildIndex(i,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(i),this.addChildAt(i,t)},getChildIndex(i){const t=this.children.indexOf(i);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(i,t){this.allowChildren||L(N,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${i}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(i.parent){const r=i.parent.children.indexOf(i);if(i.parent===this&&r===t)return i;r!==-1&&i.parent.children.splice(r,1)}t===e.length?e.push(i):e.splice(t,0,i),i.parent=this,i.didChange=!0,i._updateFlags=15;const s=this.renderGroup||this.parentRenderGroup;return s&&s.addChild(i),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",i,this,t),i.emit("added",this),i},swapChildren(i,t){if(i===t)return;const e=this.getChildIndex(i),s=this.getChildIndex(t);this.children[e]=t,this.children[s]=i;const r=this.renderGroup||this.parentRenderGroup;r&&(r.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...i){return i.length===1?this.reparentChildAt(i[0],this.children.length):(i.forEach(t=>this.reparentChildAt(t,this.children.length)),i[0])},reparentChildAt(i,t){if(i.parent===this)return this.setChildIndex(i,t),i;const e=i.worldTransform.clone();i.removeFromParent(),this.addChildAt(i,t);const s=this.worldTransform.clone();return s.invert(),e.prepend(s),i.setFromMatrix(e),i},replaceChild(i,t){i.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(i)),t.setFromMatrix(i.localTransform),t.updateLocalTransform(),this.removeChild(i)}},dh={collectRenderables(i,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(i,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,i):this.collectRenderablesWithEffects(i,t,e))},collectRenderablesSimple(i,t,e){const s=this.children,r=s.length;for(let n=0;n<r;n++)s[n].collectRenderables(i,t,e)},collectRenderablesWithEffects(i,t,e){const{renderPipes:s}=t;for(let r=0;r<this.effects.length;r++){const n=this.effects[r];s[n.pipe].push(n,this,i)}this.collectRenderablesSimple(i,t,e);for(let r=this.effects.length-1;r>=0;r--){const n=this.effects[r];s[n.pipe].pop(n,this,i)}}};class Or{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class fh{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const s=this._tests[e];if(s.test(t))return ht.get(s.maskClass,t)}return t}returnMaskEffect(t){ht.return(t)}}const bi=new fh;Q.handleByList(I.MaskEffect,bi._effectClasses);const ph={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0)},addEffect(i){this.effects.indexOf(i)===-1&&(this.effects.push(i),this.effects.sort((e,s)=>e.priority-s.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(i){const t=this.effects.indexOf(i);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(i){const t=this._maskEffect;t?.mask!==i&&(t&&(this.removeEffect(t),bi.returnMaskEffect(t),this._maskEffect=null),i!=null&&(this._maskEffect=bi.getMaskEffect(i),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(i){this._maskOptions={...this._maskOptions,...i},i.mask&&(this.mask=i.mask),this._markStructureAsChanged()},set filters(i){!Array.isArray(i)&&i&&(i=[i]);const t=this._filterEffect||(this._filterEffect=new Or);i=i;const e=i?.length>0,s=t.filters?.length>0,r=e!==s;i=Array.isArray(i)?i.slice(0):i,t.filters=Object.freeze(i),r&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=i??null))},get filters(){return this._filterEffect?.filters},set filterArea(i){this._filterEffect||(this._filterEffect=new Or),this._filterEffect.filterArea=i},get filterArea(){return this._filterEffect?.filterArea}},mh={label:null,get name(){return L(N,"Container.name property has been removed, use Container.label instead"),this.label},set name(i){L(N,"Container.name property has been removed, use Container.label instead"),this.label=i},getChildByName(i,t=!1){return this.getChildByLabel(i,t)},getChildByLabel(i,t=!1){const e=this.children;for(let s=0;s<e.length;s++){const r=e[s];if(r.label===i||i instanceof RegExp&&i.test(r.label))return r}if(t)for(let s=0;s<e.length;s++){const n=e[s].getChildByLabel(i,!0);if(n)return n}return null},getChildrenByLabel(i,t=!1,e=[]){const s=this.children;for(let r=0;r<s.length;r++){const n=s[r];(n.label===i||i instanceof RegExp&&i.test(n.label))&&e.push(n)}if(t)for(let r=0;r<s.length;r++)s[r].getChildrenByLabel(i,!0,e);return e}},it=ht.getPool(O),St=ht.getPool(mt),gh=new O,yh={getFastGlobalBounds(i,t){t||(t=new mt),t.clear(),this._getGlobalBoundsRecursive(!!i,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(i,t,e){let s=t;if(i&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const r=!!this.effects.length;if((this.renderGroup||r)&&(s=St.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const o=this.bounds;s.addFrame(o.minX,o.minY,o.maxX,o.maxY,this.groupTransform)}const n=this.children;for(let o=0;o<n.length;o++)n[o]._getGlobalBoundsRecursive(i,s,e)}if(r){let n=!1;const o=this.renderGroup||this.parentRenderGroup;for(let a=0;a<this.effects.length;a++)this.effects[a].addBounds&&(n||(n=!0,s.applyMatrix(o.worldTransform)),this.effects[a].addBounds(s,!0));n&&s.applyMatrix(o.worldTransform.copyTo(gh).invert()),t.addBounds(s),St.return(s)}else this.renderGroup&&(t.addBounds(s,this.relativeGroupTransform),St.return(s))}};function no(i,t,e){e.clear();let s,r;return i.parent?t?s=i.parent.worldTransform:(r=it.get().identity(),s=Ni(i,r)):s=O.IDENTITY,oo(i,e,s,t),r&&it.return(r),e.isValid||e.set(0,0,0,0),e}function oo(i,t,e,s){if(!i.visible||!i.measurable)return;let r;s?r=i.worldTransform:(i.updateLocalTransform(),r=it.get(),r.appendFrom(i.localTransform,e));const n=t,o=!!i.effects.length;if(o&&(t=St.get().clear()),i.boundsArea)t.addRect(i.boundsArea,r);else{const a=i.bounds;a&&!a.isEmpty()&&(t.matrix=r,t.addBounds(a));for(let l=0;l<i.children.length;l++)oo(i.children[l],t,r,s)}if(o){for(let a=0;a<i.effects.length;a++)i.effects[a].addBounds?.(t);n.addBounds(t,O.IDENTITY),St.return(t)}s||it.return(r)}function Ni(i,t){const e=i.parent;return e&&(Ni(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function ao(i,t){if(i===16777215||!t)return t;if(t===16777215||!i)return i;const e=i>>16&255,s=i>>8&255,r=i&255,n=t>>16&255,o=t>>8&255,a=t&255,l=e*n/255|0,h=s*o/255|0,c=r*a/255|0;return(l<<16)+(h<<8)+c}const jr=16777215;function Gr(i,t){return i===jr?t:t===jr?i:ao(i,t)}function ms(i){return((i&255)<<16)+(i&65280)+(i>>16&255)}const xh={getGlobalAlpha(i){if(i)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(i=new O,t){if(t)return i.copyFrom(this.worldTransform);this.updateLocalTransform();const e=Ni(this,it.get().identity());return i.appendFrom(this.localTransform,e),it.return(e),i},getGlobalTint(i){if(i)return this.renderGroup?ms(this.renderGroup.worldColor):this.parentRenderGroup?ms(Gr(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=Gr(t,e.localColor),e=e.parent;return ms(t)}};function lo(i,t,e){return t.clear(),e||(e=O.IDENTITY),ho(i,t,e,i,!0),t.isValid||t.set(0,0,0,0),t}function ho(i,t,e,s,r){let n;if(r)n=it.get(),n=e.copyTo(n);else{if(!i.visible||!i.measurable)return;i.updateLocalTransform();const l=i.localTransform;n=it.get(),n.appendFrom(l,e)}const o=t,a=!!i.effects.length;if(a&&(t=St.get().clear()),i.boundsArea)t.addRect(i.boundsArea,n);else{i.renderPipeId&&(t.matrix=n,t.addBounds(i.bounds));const l=i.children;for(let h=0;h<l.length;h++)ho(l[h],t,n,s,!1)}if(a){for(let l=0;l<i.effects.length;l++)i.effects[l].addLocalBounds?.(t,s);o.addBounds(t,O.IDENTITY),St.return(t)}it.return(n)}function co(i,t){const e=i.children;for(let s=0;s<e.length;s++){const r=e[s],n=r.uid,o=(r._didViewChangeTick&65535)<<16|r._didContainerChangeTick&65535,a=t.index;(t.data[a]!==n||t.data[a+1]!==o)&&(t.data[t.index]=n,t.data[t.index+1]=o,t.didChange=!0),t.index=a+2,r.children.length&&co(r,t)}return t.didChange}const _h=new O,bh={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(i,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=i/t*e:this.scale.x=e},_setHeight(i,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=i/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new mt});const i=this._localBoundsCacheData;return i.index=1,i.didChange=!1,i.data[0]!==this._didViewChangeTick&&(i.didChange=!0,i.data[0]=this._didViewChangeTick),co(this,i),i.didChange&&lo(this,i.localBounds,_h),i.localBounds},getBounds(i,t){return no(this,i,t||new mt)}},wh={_onRender:null,set onRender(i){const t=this.renderGroup||this.parentRenderGroup;if(!i){this._onRender&&t?.removeOnRender(this),this._onRender=null;return}this._onRender||t?.addOnRender(this),this._onRender=i},get onRender(){return this._onRender}},vh={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(i){this._zIndex!==i&&(this._zIndex=i,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Ah))}};function Ah(i,t){return i._zIndex-t._zIndex}const Sh={getGlobalPosition(i=new et,t=!1){return this.parent?this.parent.toGlobal(this._position,i,t):(i.x=this._position.x,i.y=this._position.y),i},toGlobal(i,t,e=!1){const s=this.getGlobalTransform(it.get(),e);return t=s.apply(i,t),it.return(s),t},toLocal(i,t,e,s){t&&(i=t.toGlobal(i,e,s));const r=this.getGlobalTransform(it.get(),s);return e=r.applyInverse(i,e),it.return(r),e}};class uo{constructor(){this.uid=X("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let Ph=0;class Ch{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new ie(this.textureOptions)}createTexture(t,e,s){const r=new yt({...this.textureOptions,width:t,height:e,resolution:1,antialias:s,autoGarbageCollect:!1});return new j({source:r,label:`texturePool_${Ph++}`})}getOptimalTexture(t,e,s=1,r){let n=Math.ceil(t*s-1e-6),o=Math.ceil(e*s-1e-6);n=se(n),o=se(o);const a=(n<<17)+(o<<1)+(r?1:0);this._texturePool[a]||(this._texturePool[a]=[]);let l=this._texturePool[a].pop();return l||(l=this.createTexture(n,o,r)),l.source._resolution=s,l.source.width=n/s,l.source.height=o/s,l.source.pixelWidth=n,l.source.pixelHeight=o,l.frame.x=0,l.frame.y=0,l.frame.width=t,l.frame.height=e,l.updateUvs(),this._poolKeyHash[l.uid]=a,l}getSameSizeTexture(t,e=!1){const s=t.source;return this.getOptimalTexture(t.width,t.height,s._resolution,e)}returnTexture(t,e=!1){const s=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[s].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const s=this._texturePool[e];if(s)for(let r=0;r<s.length;r++)s[r].destroy(!0)}this._texturePool={}}}const fo=new Ch;Ne.register(fo);class Th{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new O,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new uo,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let s=0;s<e.length;s++){const r=e[s];r._updateFlags=15,this.addChild(r)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(fo.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const t=this._parentCacheAsTextureRenderGroup;t&&!t.textureNeedsUpdate&&t.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let s=0;s<e.length;s++)this.addChild(e[s])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let s=0;s<e.length;s++)this.removeChild(e[s])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let s=0;s<e.length;s++)this._getChildren(e[s],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const s=t.children;for(let r=0;r<s.length;r++)this._getChildren(s[r],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new O),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new O),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new O),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Mh(i,t,e={}){for(const s in t)!e[s]&&t[s]!==void 0&&(i[s]=t[s])}const Vs=new Z(null),Xe=new Z(null),Us=new Z(null,1,1),Ke=new Z(null),zr=1,kh=2,Hs=4;class Bt extends gt{constructor(t={}){super(),this.uid=X("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new O,this.relativeGroupTransform=new O,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new Z(this,0,0),this._scale=Us,this._pivot=Xe,this._origin=Ke,this._skew=Vs,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Mh(this,t,{children:!0,parent:!0,effects:!0}),t.children?.forEach(e=>this.addChild(e)),t.parent?.addChild(this)}static mixin(t){L("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),Q.mixin(Bt,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||L(N,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let r=0;r<t.length;r++)this.addChild(t[r]);return t[0]}const e=t[0],s=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),s&&(s.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,s&&s.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let r=0;r<t.length;r++)this.removeChild(t[r]);return t[0]}const e=t[0],s=this.children.indexOf(e);return s>-1&&(this._didViewChangeTick++,this.children.splice(s,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,s),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),this.renderGroup=ht.get(Th,this),this.groupTransform=O.IDENTITY,t?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),ht.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new O),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*Wl}set angle(t){this.rotation=t*$l}get pivot(){return this._pivot===Xe&&(this._pivot=new Z(this,0,0)),this._pivot}set pivot(t){this._pivot===Xe&&(this._pivot=new Z(this,0,0),this._origin!==Ke&&U("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===Vs&&(this._skew=new Z(this,0,0)),this._skew}set skew(t){this._skew===Vs&&(this._skew=new Z(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===Us&&(this._scale=new Z(this,1,1)),this._scale}set scale(t){this._scale===Us&&(this._scale=new Z(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===Ke&&(this._origin=new Z(this,0,0)),this._origin}set origin(t){this._origin===Ke&&(this._origin=new Z(this,0,0),this._pivot!==Xe&&U("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const s=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,s.width),e!==void 0&&this._setHeight(e,s.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,s=this._scale,r=this._pivot,n=this._origin,o=this._position,a=s._x,l=s._y,h=r._x,c=r._y,u=-n._x,d=-n._y;e.a=this._cx*a,e.b=this._sx*a,e.c=this._cy*l,e.d=this._sy*l,e.tx=o._x-(h*e.a+c*e.c)+(u*e.a+d*e.c)-u,e.ty=o._y-(h*e.b+c*e.d)+(u*e.b+d*e.d)-d}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=zr,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const s=K.shared.setValue(t??16777215).toBgrNumber();s!==this.localColor&&(this.localColor=s,this._updateFlags|=zr,this._onUpdate())}get tint(){return ms(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=kh,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Hs,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=Hs,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=Hs,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t?.children)&&e)for(let r=0;r<e.length;++r)e[r].destroy(t);this.renderGroup?.destroy(),this.renderGroup=null}}Q.mixin(Bt,uh,yh,Sh,wh,bh,ph,mh,vh,oh,hh,xh,dh);class Di extends Bt{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this._bounds=new mt(0,1,0,0),this._boundsDirty=!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:s,y:r}=t;return s>=e.minX&&s<=e.maxX&&r>=e.minY&&r<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}destroy(t){super.destroy(t),this._bounds=null;for(const e in this._gpuData)this._gpuData[e].destroy?.();this._gpuData=null}collectRenderablesSimple(t,e,s){const{renderPipes:r}=e;r.blendMode.pushBlendMode(this,this.groupBlendMode,t),r[this.renderPipeId].addRenderable(this,t),this.didViewUpdate=!1;const o=this.children,a=o.length;for(let l=0;l<a;l++)o[l].collectRenderables(t,e,s);r.blendMode.popBlendMode(t)}}class pt extends Di{constructor(t=j.EMPTY){t instanceof j&&(t={texture:t});const{texture:e=j.EMPTY,anchor:s,roundPixels:r,width:n,height:o,...a}=t;super({label:"Sprite",...a}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new Z({_onUpdate:()=>{this.onViewUpdate()}}),s?this.anchor=s:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=r??!1,n!==void 0&&(this.width=n),o!==void 0&&(this.height=o)}static from(t,e=!1){return t instanceof j?new pt(t):new pt(j.from(t,e))}set texture(t){t||(t=j.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return Kl(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return L("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,s=this._bounds,{width:r,height:n}=e.orig;s.minX=-t._x*r,s.maxX=s.minX+r,s.minY=-t._y*n,s.maxY=s.minY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t?.texture){const s=typeof t=="boolean"?t:t?.textureSource;this._texture.destroy(s)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null,this._gpuData=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Eh=new mt;function po(i,t,e){const s=Eh;i.measurable=!0,no(i,e,s),t.addBoundsMask(s),i.measurable=!1}function mo(i,t,e){const s=St.get();i.measurable=!0;const r=it.get().identity(),n=go(i,e,r);lo(i,s,n),i.measurable=!1,t.addBoundsMask(s),it.return(r),St.return(s)}function go(i,t,e){return i?(i!==t&&(go(i.parent,t,e),i.updateLocalTransform(),e.append(i.localTransform)),e):(U("Mask bounds, renderable is not inside the root container"),e)}class yo{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof pt),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,e){this.inverse||po(this.mask,t,e)}addLocalBounds(t,e){mo(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof pt}}yo.extension=I.MaskEffect;class xo{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}xo.extension=I.MaskEffect;class _o{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,e){po(this.mask,t,e)}addLocalBounds(t,e){mo(this.mask,t,e)}containsPoint(t,e){const s=this.mask;return e(s,t)}destroy(){this.reset()}static test(t){return t instanceof Bt}}_o.extension=I.MaskEffect;const Ih={createCanvas:(i,t)=>{const e=document.createElement("canvas");return e.width=i,e.height=t,e},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(i,t)=>fetch(i,t),parseXML:i=>new DOMParser().parseFromString(i,"text/xml")};let Nr=Ih;const $={get(){return Nr},set(i){Nr=i}};class bo extends yt{constructor(t){t.resource||(t.resource=$.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,s=this._resolution){const r=super.resize(t,e,s);return r&&this.resizeCanvas(),r}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}bo.extension=I.TextureSource;class qt extends yt{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}qt.extension=I.TextureSource;var wi=(i=>(i[i.INTERACTION=50]="INTERACTION",i[i.HIGH=25]="HIGH",i[i.NORMAL=0]="NORMAL",i[i.LOW=-25]="LOW",i[i.UTILITY=-50]="UTILITY",i))(wi||{});class qs{constructor(t,e=null,s=0,r=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=s,this._once=r}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const wo=class nt{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new qs(null,null,1/0),this.deltaMS=1/nt.targetFPMS,this.elapsedMS=1/nt.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,s=wi.NORMAL){return this._addListener(new qs(t,e,s))}addOnce(t,e,s=wi.NORMAL){return this._addListener(new qs(t,e,s,!0))}_addListener(t){let e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this}remove(t,e){let s=this._head.next;for(;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*nt.targetFPMS;const s=this._head;let r=s.next;for(;r;)r=r.emit(this);s.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,nt.targetFPMS);this._maxElapsedMS=1/s}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!nt._shared){const t=nt._shared=new nt;t.autoStart=!0,t._protected=!0}return nt._shared}static get system(){if(!nt._system){const t=nt._system=new nt;t.autoStart=!0,t._protected=!0}return nt._system}};wo.targetFPMS=.06;let Je=wo,Ys;async function vo(){return Ys??(Ys=(async()=>{const t=$.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(o=>{const a=document.createElement("video");a.onloadeddata=()=>o(a),a.onerror=()=>o(null),a.autoplay=!1,a.crossOrigin="anonymous",a.preload="auto",a.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",a.load()});if(!e)return"premultiply-alpha-on-upload";const s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(r),t.deleteTexture(s),t.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Ys}const Ms=class Ao extends yt{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...Ao.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=Je.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await vo(),this._load=new Promise((s,r)=>{this.isValid?s(this):(this._resolve=s,this._reject=r,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(Je.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(Je.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(Je.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};Ms.extension=I.TextureSource;Ms.defaultOptions={...yt.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};Ms.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let Ce=Ms;const dt=(i,t,e=!1)=>(Array.isArray(i)||(i=[i]),t?i.map(s=>typeof s=="string"||e?t(s):s):i);class Rh{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||U(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const s=dt(t);let r;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.test(e)){r=h.getCacheableAssets(s,e);break}}const n=new Map(Object.entries(r||{}));r||s.forEach(l=>{n.set(l,e)});const o=[...n.keys()],a={cacheKeys:o,keys:s};s.forEach(l=>{this._cacheMap.set(l,a)}),o.forEach(l=>{const h=r?r[l]:e;this._cache.has(l)&&this._cache.get(l)!==h&&U("[Cache] already has key:",l),this._cache.set(l,n.get(l))})}remove(t){if(!this._cacheMap.has(t)){U(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(r=>{this._cache.delete(r)}),e.keys.forEach(r=>{this._cacheMap.delete(r)})}get parsers(){return this._parsers}}const V=new Rh,vi=[];Q.handleByList(I.TextureSource,vi);function So(i={}){const t=i&&i.resource,e=t?i.resource:i,s=t?i:{resource:i};for(let r=0;r<vi.length;r++){const n=vi[r];if(n.test(e))return new n(s)}throw new Error(`Could not find a source type for resource: ${s.resource}`)}function Bh(i={},t=!1){const e=i&&i.resource,s=e?i.resource:i,r=e?i:{resource:i};if(!t&&V.has(s))return V.get(s);const n=new j({source:So(r)});return n.on("destroy",()=>{V.has(s)&&V.remove(s)}),t||V.set(s,n),n}function Lh(i,t=!1){return typeof i=="string"?V.get(i):i instanceof yt?new j({source:i}):Bh(i,t)}j.from=Lh;yt.from=So;Q.add(yo,xo,_o,Ce,qt,bo,zi);var Lt=(i=>(i[i.Low=0]="Low",i[i.Normal=1]="Normal",i[i.High=2]="High",i))(Lt||{});function ut(i){if(typeof i!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(i)}`)}function pe(i){return i.split("?")[0].split("#")[0]}function Fh(i){return i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Oh(i,t,e){return i.replace(new RegExp(Fh(t),"g"),e)}function jh(i,t){let e="",s=0,r=-1,n=0,o=-1;for(let a=0;a<=i.length;++a){if(a<i.length)o=i.charCodeAt(a);else{if(o===47)break;o=47}if(o===47){if(!(r===a-1||n===1))if(r!==a-1&&n===2){if(e.length<2||s!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",s=0):(e=e.slice(0,l),s=e.length-1-e.lastIndexOf("/")),r=a,n=0;continue}}else if(e.length===2||e.length===1){e="",s=0,r=a,n=0;continue}}}else e.length>0?e+=`/${i.slice(r+1,a)}`:e=i.slice(r+1,a),s=a-r-1;r=a,n=0}else o===46&&n!==-1?++n:n=-1}return e}const ot={toPosix(i){return Oh(i,"\\","/")},isUrl(i){return/^https?:/.test(this.toPosix(i))},isDataUrl(i){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(i)},isBlobUrl(i){return i.startsWith("blob:")},hasProtocol(i){return/^[^/:]+:/.test(this.toPosix(i))},getProtocol(i){ut(i),i=this.toPosix(i);const t=/^file:\/\/\//.exec(i);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(i);return e?e[0]:""},toAbsolute(i,t,e){if(ut(i),this.isDataUrl(i)||this.isBlobUrl(i))return i;const s=pe(this.toPosix(t??$.get().getBaseUrl())),r=pe(this.toPosix(e??this.rootname(s)));return i=this.toPosix(i),i.startsWith("/")?ot.join(r,i.slice(1)):this.isAbsolute(i)?i:this.join(s,i)},normalize(i){if(ut(i),i.length===0)return".";if(this.isDataUrl(i)||this.isBlobUrl(i))return i;i=this.toPosix(i);let t="";const e=i.startsWith("/");this.hasProtocol(i)&&(t=this.rootname(i),i=i.slice(t.length));const s=i.endsWith("/");return i=jh(i),i.length>0&&s&&(i+="/"),e?`/${i}`:t+i},isAbsolute(i){return ut(i),i=this.toPosix(i),this.hasProtocol(i)?!0:i.startsWith("/")},join(...i){if(i.length===0)return".";let t;for(let e=0;e<i.length;++e){const s=i[e];if(ut(s),s.length>0)if(t===void 0)t=s;else{const r=i[e-1]??"";this.joinExtensions.includes(this.extname(r).toLowerCase())?t+=`/../${s}`:t+=`/${s}`}}return t===void 0?".":this.normalize(t)},dirname(i){if(ut(i),i.length===0)return".";i=this.toPosix(i);let t=i.charCodeAt(0);const e=t===47;let s=-1,r=!0;const n=this.getProtocol(i),o=i;i=i.slice(n.length);for(let a=i.length-1;a>=1;--a)if(t=i.charCodeAt(a),t===47){if(!r){s=a;break}}else r=!1;return s===-1?e?"/":this.isUrl(o)?n+i:n:e&&s===1?"//":n+i.slice(0,s)},rootname(i){ut(i),i=this.toPosix(i);let t="";if(i.startsWith("/")?t="/":t=this.getProtocol(i),this.isUrl(i)){const e=i.indexOf("/",t.length);e!==-1?t=i.slice(0,e):t=i,t.endsWith("/")||(t+="/")}return t},basename(i,t){ut(i),t&&ut(t),i=pe(this.toPosix(i));let e=0,s=-1,r=!0,n;if(t!==void 0&&t.length>0&&t.length<=i.length){if(t.length===i.length&&t===i)return"";let o=t.length-1,a=-1;for(n=i.length-1;n>=0;--n){const l=i.charCodeAt(n);if(l===47){if(!r){e=n+1;break}}else a===-1&&(r=!1,a=n+1),o>=0&&(l===t.charCodeAt(o)?--o===-1&&(s=n):(o=-1,s=a))}return e===s?s=a:s===-1&&(s=i.length),i.slice(e,s)}for(n=i.length-1;n>=0;--n)if(i.charCodeAt(n)===47){if(!r){e=n+1;break}}else s===-1&&(r=!1,s=n+1);return s===-1?"":i.slice(e,s)},extname(i){ut(i),i=pe(this.toPosix(i));let t=-1,e=0,s=-1,r=!0,n=0;for(let o=i.length-1;o>=0;--o){const a=i.charCodeAt(o);if(a===47){if(!r){e=o+1;break}continue}s===-1&&(r=!1,s=o+1),a===46?t===-1?t=o:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||s===-1||n===0||n===1&&t===s-1&&t===e+1?"":i.slice(t,s)},parse(i){ut(i);const t={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return t;i=pe(this.toPosix(i));let e=i.charCodeAt(0);const s=this.isAbsolute(i);let r;t.root=this.rootname(i),s||this.hasProtocol(i)?r=1:r=0;let n=-1,o=0,a=-1,l=!0,h=i.length-1,c=0;for(;h>=r;--h){if(e=i.charCodeAt(h),e===47){if(!l){o=h+1;break}continue}a===-1&&(l=!1,a=h+1),e===46?n===-1?n=h:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||a===-1||c===0||c===1&&n===a-1&&n===o+1?a!==-1&&(o===0&&s?t.base=t.name=i.slice(1,a):t.base=t.name=i.slice(o,a)):(o===0&&s?(t.name=i.slice(1,n),t.base=i.slice(1,a)):(t.name=i.slice(o,n),t.base=i.slice(o,a)),t.ext=i.slice(n,a)),t.dir=this.dirname(i),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function Po(i,t,e,s,r){const n=t[e];for(let o=0;o<n.length;o++){const a=n[o];e<t.length-1?Po(i.replace(s[e],a),t,e+1,s,r):r.push(i.replace(s[e],a))}}function Gh(i){const t=/\{(.*?)\}/g,e=i.match(t),s=[];if(e){const r=[];e.forEach(n=>{const o=n.substring(1,n.length-1).split(",");r.push(o)}),Po(i,r,0,e,s)}else s.push(i);return s}const As=i=>!Array.isArray(i);class oe{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(s=>`${encodeURIComponent(s)}=${encodeURIComponent(e[s])}`).join("&")}}getAlias(t){const{alias:e,src:s}=t;return dt(e||s,n=>typeof n=="string"?n:Array.isArray(n)?n.map(o=>o?.src??o):n?.src?n.src:n,!0)}addManifest(t){this._manifest&&U("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const s=[];let r=e;Array.isArray(e)||(r=Object.entries(e).map(([n,o])=>typeof o=="string"||Array.isArray(o)?{alias:n,src:o}:{alias:n,...o})),r.forEach(n=>{const o=n.src,a=n.alias;let l;if(typeof a=="string"){const h=this._createBundleAssetId(t,a);s.push(h),l=[a,h]}else{const h=a.map(c=>this._createBundleAssetId(t,c));s.push(...h),l=[...a,...h]}this.add({...n,alias:l,src:o})}),this._bundles[t]=s}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let s;s=n=>{this.hasKey(n)&&U(`[Resolver] already has key: ${n} overwriting`)},dt(e).forEach(n=>{const{src:o}=n;let{data:a,format:l,loadParser:h,parser:c}=n;const u=dt(o).map(y=>typeof y=="string"?Gh(y):Array.isArray(y)?y:[y]),d=this.getAlias(n);Array.isArray(d)?d.forEach(s):s(d);const f=[],p=y=>({...this._parsers.find(g=>g.test(y))?.parse(y),src:y});u.forEach(y=>{y.forEach(m=>{let g={};if(typeof m!="object"?g=p(m):(a=m.data??a,l=m.format??l,(m.loadParser||m.parser)&&(h=m.loadParser??h,c=m.parser??c),g={...p(m.src),...m}),!d)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:d,data:a,format:l,loadParser:h,parser:c,progressSize:n.progressSize}),f.push(g)})}),d.forEach(y=>{this._assetMap[y]=f})})}resolveBundle(t){const e=As(t);t=dt(t);const s={};return t.forEach(r=>{const n=this._bundles[r];if(n){const o=this.resolve(n),a={};for(const l in o){const h=o[l];a[this._extractAssetIdFromBundle(r,l)]=h}s[r]=a}}),e?s[t[0]]:s}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const s={};for(const r in e)s[r]=e[r].src;return s}return e.src}resolve(t){const e=As(t);t=dt(t);const s={};return t.forEach(r=>{if(!this._resolverHash[r])if(this._assetMap[r]){let n=this._assetMap[r];const o=this._getPreferredOrder(n);o?.priority.forEach(a=>{o.params[a].forEach(l=>{const h=n.filter(c=>c[a]?c[a]===l:!1);h.length&&(n=h)})}),this._resolverHash[r]=n[0]}else this._resolverHash[r]=this._buildResolvedAsset({alias:[r],src:r},{});s[r]=this._resolverHash[r]}),e?s[t[0]]:s}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const s=t[e],r=this._preferredOrder.find(n=>n.params.format.includes(s.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:s,data:r,loadParser:n,parser:o,format:a,progressSize:l}=e;return(this._basePath||this._rootPath)&&(t.src=ot.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=s??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=n??t.loadParser,t.parser=o??t.parser,t.format=a??t.format??zh(t.src),l!==void 0&&(t.progressSize=l),t}}oe.RETINA_PREFIX=/@([0-9\.]+)x/;function zh(i){return i.split(".").pop().split("?").shift().split("#").shift()}const Ai=(i,t)=>{const e=t.split("?")[1];return e&&(i+=`?${e}`),i},Co=class ve{constructor(t,e){this.linkedSheets=[];let s=t;t?.source instanceof yt&&(s={texture:t,data:e});const{texture:r,data:n,cachePrefix:o=""}=s;this.cachePrefix=o,this._texture=r instanceof j?r:null,this.textureSource=r.source,this.textures={},this.animations={},this.data=n;const a=parseFloat(n.meta.scale);a?(this.resolution=a,r.source.resolution=this.resolution):this.resolution=r.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=ve.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(t){let e=t;const s=ve.BATCH_SIZE;for(;e-t<s&&e<this._frameKeys.length;){const r=this._frameKeys[e],n=this._frames[r],o=n.frame;if(o){let a=null,l=null;const h=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new H(0,0,Math.floor(h.w)/this.resolution,Math.floor(h.h)/this.resolution);n.rotated?a=new H(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):a=new H(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(l=new H(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[r]=new j({source:this.textureSource,frame:a,orig:c,trim:l,rotate:n.rotated?2:0,defaultAnchor:n.anchor,defaultBorders:n.borders,label:r.toString()})}e++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let s=0;s<t[e].length;s++){const r=t[e][s];this.animations[e].push(this.textures[r])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*ve.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*ve.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};Co.BATCH_SIZE=1e3;let Dr=Co;const Nh=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function To(i,t,e){const s={};if(i.forEach(r=>{s[r]=t}),Object.keys(t.textures).forEach(r=>{s[`${t.cachePrefix}${r}`]=t.textures[r]}),!e){const r=ot.dirname(i[0]);t.linkedSheets.forEach((n,o)=>{const a=To([`${r}/${t.data.meta.related_multi_packs[o]}`],n,!0);Object.assign(s,a)})}return s}const Dh={extension:I.Asset,cache:{test:i=>i instanceof Dr,getCacheableAssets:(i,t)=>To(i,t,!1)},resolver:{extension:{type:I.ResolveParser,name:"resolveSpritesheet"},test:i=>{const e=i.split("?")[0].split("."),s=e.pop(),r=e.pop();return s==="json"&&Nh.includes(r)},parse:i=>{const t=i.split(".");return{resolution:parseFloat(oe.RETINA_PREFIX.exec(i)?.[1]??"1"),format:t[t.length-2],src:i}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:I.LoadParser,priority:Lt.Normal,name:"spritesheetLoader"},async testParse(i,t){return ot.extname(t.src).toLowerCase()===".json"&&!!i.frames},async parse(i,t,e){const{texture:s,imageFilename:r,textureOptions:n,cachePrefix:o}=t?.data??{};let a=ot.dirname(t.src);a&&a.lastIndexOf("/")!==a.length-1&&(a+="/");let l;if(s instanceof j)l=s;else{const u=Ai(a+(r??i.meta.image),t.src);l=(await e.load([{src:u,data:n}]))[u]}const h=new Dr({texture:l.source,data:i,cachePrefix:o});await h.parse();const c=i?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const f of c){if(typeof f!="string")continue;let p=a+f;t.data?.ignoreMultiPack||(p=Ai(p,t.src),u.push(e.load({src:p,data:{textureOptions:n,ignoreMultiPack:!0}})))}const d=await Promise.all(u);h.linkedSheets=d,d.forEach(f=>{f.linkedSheets=[h].concat(h.linkedSheets.filter(p=>p!==f))})}return h},async unload(i,t,e){await e.unload(i.textureSource._sourceOrigin),i.destroy(!1)}}};Q.add(Dh);const Xs=Object.create(null),Wr=Object.create(null);function Wi(i,t){let e=Wr[i];return e===void 0&&(Xs[t]===void 0&&(Xs[t]=1),Wr[i]=e=Xs[t]++),e}let Ze;function Mo(){return(!Ze||Ze?.isContextLost())&&(Ze=$.get().createCanvas().getContext("webgl",{})),Ze}let Qe;function Wh(){if(!Qe){Qe="mediump";const i=Mo();i&&i.getShaderPrecisionFormat&&(Qe=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT).precision?"highp":"mediump")}return Qe}function $h(i,t,e){return t?i:e?(i=i.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${i}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${i}
        `}function Vh(i,t,e){const s=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(i.substring(0,9)!=="precision"){let r=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return r==="highp"&&s!=="highp"&&(r="mediump"),`precision ${r} float;
${i}`}else if(s!=="highp"&&i.substring(0,15)==="precision highp")return i.replace("precision highp","precision mediump");return i}function Uh(i,t){return t?`#version 300 es
${i}`:i}const Hh={},qh={};function Yh(i,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const s=e?Hh:qh;return s[t]?(s[t]++,t+=`-${s[t]}`):s[t]=1,i.indexOf("#define SHADER_NAME")!==-1?i:`${`#define SHADER_NAME ${t}`}
${i}`}function Xh(i,t){return t?i.replace("#version 300 es",""):i}const Ks={stripVersion:Xh,ensurePrecision:Vh,addProgramDefines:$h,setProgramName:Yh,insertVersion:Uh},me=Object.create(null),ko=class Si{constructor(t){t={...Si.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,s={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:Wh()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let r=t.fragment,n=t.vertex;Object.keys(Ks).forEach(o=>{const a=s[o];r=Ks[o](r,a,!0),n=Ks[o](n,a,!1)}),this.fragment=r,this.vertex=n,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Wi(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,me[this._cacheKey]=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return me[e]||(me[e]=new Si(t),me[e]._cacheKey=e),me[e]}};ko.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let Eo=ko;const $r={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function Kh(i){return $r[i]??$r.float32}const Jh={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"};function Zh({source:i,entryPoint:t}){const e={},s=i.indexOf(`fn ${t}`);if(s!==-1){const r=i.indexOf("->",s);if(r!==-1){const n=i.substring(s,r),o=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|$)/g;let a;for(;(a=o.exec(n))!==null;){const l=Jh[a[3]]??"float32";e[a[2]]={location:parseInt(a[1],10),format:l,stride:Kh(l).stride,offset:0,instance:!1,start:0}}}}return e}function Js(i){const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,s=/@binding\((\d+)\)/,r=/var(<[^>]+>)? (\w+)/,n=/:\s*(\w+)/,o=/struct\s+(\w+)\s*{([^}]+)}/g,a=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,h=i.match(t)?.map(u=>({group:parseInt(u.match(e)[1],10),binding:parseInt(u.match(s)[1],10),name:u.match(r)[2],isUniform:u.match(r)[1]==="<uniform>",type:u.match(n)[1]}));if(!h)return{groups:[],structs:[]};const c=i.match(o)?.map(u=>{const d=u.match(l)[1],f=u.match(a).reduce((p,y)=>{const[m,g]=y.split(":");return p[m.trim()]=g.trim(),p},{});return f?{name:d,members:f}:null}).filter(({name:u})=>h.some(d=>d.type===u))??[];return{groups:h,structs:c}}var Ae=(i=>(i[i.VERTEX=1]="VERTEX",i[i.FRAGMENT=2]="FRAGMENT",i[i.COMPUTE=4]="COMPUTE",i))(Ae||{});function Qh({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]=[]),s.isUniform?t[s.group].push({binding:s.binding,visibility:Ae.VERTEX|Ae.FRAGMENT,buffer:{type:"uniform"}}):s.type==="sampler"?t[s.group].push({binding:s.binding,visibility:Ae.FRAGMENT,sampler:{type:"filtering"}}):s.type==="texture_2d"&&t[s.group].push({binding:s.binding,visibility:Ae.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}})}return t}function tc({groups:i}){const t=[];for(let e=0;e<i.length;e++){const s=i[e];t[s.group]||(t[s.group]={}),t[s.group][s.name]=s.binding}return t}function ec(i,t){const e=new Set,s=new Set,r=[...i.structs,...t.structs].filter(o=>e.has(o.name)?!1:(e.add(o.name),!0)),n=[...i.groups,...t.groups].filter(o=>{const a=`${o.name}-${o.binding}`;return s.has(a)?!1:(s.add(a),!0)});return{structs:r,groups:n}}const ge=Object.create(null);class ks{constructor(t){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:s,layout:r,gpuLayout:n,name:o}=t;if(this.name=o,this.fragment=e,this.vertex=s,e.source===s.source){const a=Js(e.source);this.structsAndGroups=a}else{const a=Js(s.source),l=Js(e.source);this.structsAndGroups=ec(a,l)}this.layout=r??tc(this.structsAndGroups),this.gpuLayout=n??Qh(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,s=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=Wi(s,"program")}get attributeData(){return this._attributeData??(this._attributeData=Zh(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,ge[this._cacheKey]=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return ge[e]||(ge[e]=new ks(t),ge[e]._cacheKey=e),ge[e]}}const Io=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],sc=Io.reduce((i,t)=>(i[t]=!0,i),{});function ic(i,t){switch(i){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const Ro=class Bo{constructor(t,e){this._touched=0,this.uid=X("uniform"),this._resourceType="uniformGroup",this._resourceId=X("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Bo.defaultOptions,...e},this.uniformStructures=t;const s={};for(const r in t){const n=t[r];if(n.name=r,n.size=n.size??1,!sc[n.type]){const o=n.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(o){const[,a,l]=o;throw new Error(`Uniform type ${n.type} is not supported. Use type: '${a}', size: ${l} instead.`)}throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${Io.join(", ")}`)}n.value??(n.value=ic(n.type,n.size)),s[r]=n.value}this.uniforms=s,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=Wi(Object.keys(s).map(r=>`${r}-${t[r].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};Ro.defaultOptions={ubo:!1,isStatic:!1};let Lo=Ro;class gs{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const s in t){const r=t[s];this.setResource(r,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const s in this.resources)t[e++]=this.resources[s]._resourceId;this._key=t.join("|")}setResource(t,e){const s=this.resources[e];t!==s&&(s&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t){const e=this.resources;for(const s in e)e[s]._touched=t}destroy(){const t=this.resources;for(const e in t)t[e]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const s in e)e[s]===t&&(e[s]=null)}else this._updateKey()}}var Pi=(i=>(i[i.WEBGL=1]="WEBGL",i[i.WEBGPU=2]="WEBGPU",i[i.BOTH=3]="BOTH",i))(Pi||{});class $i extends gt{constructor(t){super(),this.uid=X("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:e,glProgram:s,groups:r,resources:n,compatibleRenderers:o,groupMap:a}=t;this.gpuProgram=e,this.glProgram=s,o===void 0&&(o=0,e&&(o|=Pi.WEBGPU),s&&(o|=Pi.WEBGL)),this.compatibleRenderers=o;const l={};if(!n&&!r&&(n={}),n&&r)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&r&&!a)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&r&&a)for(const h in a)for(const c in a[h]){const u=a[h][c];l[u]={group:h,binding:c,name:u}}else if(e&&r&&!a){const h=e.structsAndGroups.groups;a={},h.forEach(c=>{a[c.group]=a[c.group]||{},a[c.group][c.binding]=c.name,l[c.name]=c})}else if(n){r={},a={},e&&e.structsAndGroups.groups.forEach(u=>{a[u.group]=a[u.group]||{},a[u.group][u.binding]=u.name,l[u.name]=u});let h=0;for(const c in n)l[c]||(r[99]||(r[99]=new gs,this._ownedBindGroups.push(r[99])),l[c]={group:99,binding:h,name:c},a[99]=a[99]||{},a[99][h]=c,h++);for(const c in n){const u=c;let d=n[c];!d.source&&!d._resourceType&&(d=new Lo(d));const f=l[u];f&&(r[f.group]||(r[f.group]=new gs,this._ownedBindGroups.push(r[f.group])),r[f.group].setResource(d,f.binding))}}this.groups=r,this._uniformBindMap=a,this.resources=this._buildResourceAccessor(r,l)}addResource(t,e,s){var r,n;(r=this._uniformBindMap)[e]||(r[e]={}),(n=this._uniformBindMap[e])[s]||(n[s]=t),this.groups[e]||(this.groups[e]=new gs,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const s={};for(const r in e){const n=e[r];Object.defineProperty(s,n.name,{get(){return t[n.group].getResource(n.binding)},set(o){t[n.group].setResource(o,n.binding)}})}return s}destroy(t=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),t&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(e=>{e.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(t){const{gpu:e,gl:s,...r}=t;let n,o;return e&&(n=ks.from(e)),s&&(o=Eo.from(s)),new $i({gpuProgram:n,glProgram:o,...r})}}const Ci=[];Q.handleByNamedList(I.Environment,Ci);async function rc(i){if(!i)for(let t=0;t<Ci.length;t++){const e=Ci[t];if(e.value.test()){await e.value.load();return}}}let ye;function nc(){if(typeof ye=="boolean")return ye;try{ye=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{ye=!1}return ye}function Vr(i,t,e=2){const s=t&&t.length,r=s?t[0]*e:i.length;let n=Fo(i,0,r,e,!0);const o=[];if(!n||n.next===n.prev)return o;let a,l,h;if(s&&(n=cc(i,t,n,e)),i.length>80*e){a=i[0],l=i[1];let c=a,u=l;for(let d=e;d<r;d+=e){const f=i[d],p=i[d+1];f<a&&(a=f),p<l&&(l=p),f>c&&(c=f),p>u&&(u=p)}h=Math.max(c-a,u-l),h=h!==0?32767/h:0}return Ie(n,o,e,a,l,h,0),o}function Fo(i,t,e,s,r){let n;if(r===wc(i,t,e,s)>0)for(let o=t;o<e;o+=s)n=Ur(o/s|0,i[o],i[o+1],n);else for(let o=e-s;o>=t;o-=s)n=Ur(o/s|0,i[o],i[o+1],n);return n&&ne(n,n.next)&&(Be(n),n=n.next),n}function Yt(i,t){if(!i)return i;t||(t=i);let e=i,s;do if(s=!1,!e.steiner&&(ne(e,e.next)||q(e.prev,e,e.next)===0)){if(Be(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function Ie(i,t,e,s,r,n,o){if(!i)return;!o&&n&&mc(i,s,r,n);let a=i;for(;i.prev!==i.next;){const l=i.prev,h=i.next;if(n?ac(i,s,r,n):oc(i)){t.push(l.i,i.i,h.i),Be(i),i=h.next,a=h.next;continue}if(i=h,i===a){o?o===1?(i=lc(Yt(i),t),Ie(i,t,e,s,r,n,2)):o===2&&hc(i,t,e,s,r,n):Ie(Yt(i),t,e,s,r,n,1);break}}}function oc(i){const t=i.prev,e=i,s=i.next;if(q(t,e,s)>=0)return!1;const r=t.x,n=e.x,o=s.x,a=t.y,l=e.y,h=s.y,c=Math.min(r,n,o),u=Math.min(a,l,h),d=Math.max(r,n,o),f=Math.max(a,l,h);let p=s.next;for(;p!==t;){if(p.x>=c&&p.x<=d&&p.y>=u&&p.y<=f&&Se(r,a,n,l,o,h,p.x,p.y)&&q(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function ac(i,t,e,s){const r=i.prev,n=i,o=i.next;if(q(r,n,o)>=0)return!1;const a=r.x,l=n.x,h=o.x,c=r.y,u=n.y,d=o.y,f=Math.min(a,l,h),p=Math.min(c,u,d),y=Math.max(a,l,h),m=Math.max(c,u,d),g=Ti(f,p,t,e,s),x=Ti(y,m,t,e,s);let _=i.prevZ,b=i.nextZ;for(;_&&_.z>=g&&b&&b.z<=x;){if(_.x>=f&&_.x<=y&&_.y>=p&&_.y<=m&&_!==r&&_!==o&&Se(a,c,l,u,h,d,_.x,_.y)&&q(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=f&&b.x<=y&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&Se(a,c,l,u,h,d,b.x,b.y)&&q(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=g;){if(_.x>=f&&_.x<=y&&_.y>=p&&_.y<=m&&_!==r&&_!==o&&Se(a,c,l,u,h,d,_.x,_.y)&&q(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=x;){if(b.x>=f&&b.x<=y&&b.y>=p&&b.y<=m&&b!==r&&b!==o&&Se(a,c,l,u,h,d,b.x,b.y)&&q(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function lc(i,t){let e=i;do{const s=e.prev,r=e.next.next;!ne(s,r)&&jo(s,e,e.next,r)&&Re(s,r)&&Re(r,s)&&(t.push(s.i,e.i,r.i),Be(e),Be(e.next),e=i=r),e=e.next}while(e!==i);return Yt(e)}function hc(i,t,e,s,r,n){let o=i;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&xc(o,a)){let l=Go(o,a);o=Yt(o,o.next),l=Yt(l,l.next),Ie(o,t,e,s,r,n,0),Ie(l,t,e,s,r,n,0);return}a=a.next}o=o.next}while(o!==i)}function cc(i,t,e,s){const r=[];for(let n=0,o=t.length;n<o;n++){const a=t[n]*s,l=n<o-1?t[n+1]*s:i.length,h=Fo(i,a,l,s,!1);h===h.next&&(h.steiner=!0),r.push(yc(h))}r.sort(uc);for(let n=0;n<r.length;n++)e=dc(r[n],e);return e}function uc(i,t){let e=i.x-t.x;if(e===0&&(e=i.y-t.y,e===0)){const s=(i.next.y-i.y)/(i.next.x-i.x),r=(t.next.y-t.y)/(t.next.x-t.x);e=s-r}return e}function dc(i,t){const e=fc(i,t);if(!e)return t;const s=Go(e,i);return Yt(s,s.next),Yt(e,e.next)}function fc(i,t){let e=t;const s=i.x,r=i.y;let n=-1/0,o;if(ne(i,e))return e;do{if(ne(i,e.next))return e.next;if(r<=e.y&&r>=e.next.y&&e.next.y!==e.y){const u=e.x+(r-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=s&&u>n&&(n=u,o=e.x<e.next.x?e:e.next,u===s))return o}e=e.next}while(e!==t);if(!o)return null;const a=o,l=o.x,h=o.y;let c=1/0;e=o;do{if(s>=e.x&&e.x>=l&&s!==e.x&&Oo(r<h?s:n,r,l,h,r<h?n:s,r,e.x,e.y)){const u=Math.abs(r-e.y)/(s-e.x);Re(e,i)&&(u<c||u===c&&(e.x>o.x||e.x===o.x&&pc(o,e)))&&(o=e,c=u)}e=e.next}while(e!==a);return o}function pc(i,t){return q(i.prev,i,t.prev)<0&&q(t.next,i,i.next)<0}function mc(i,t,e,s){let r=i;do r.z===0&&(r.z=Ti(r.x,r.y,t,e,s)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==i);r.prevZ.nextZ=null,r.prevZ=null,gc(r)}function gc(i){let t,e=1;do{let s=i,r;i=null;let n=null;for(t=0;s;){t++;let o=s,a=0;for(let h=0;h<e&&(a++,o=o.nextZ,!!o);h++);let l=e;for(;a>0||l>0&&o;)a!==0&&(l===0||!o||s.z<=o.z)?(r=s,s=s.nextZ,a--):(r=o,o=o.nextZ,l--),n?n.nextZ=r:i=r,r.prevZ=n,n=r;s=o}n.nextZ=null,e*=2}while(t>1);return i}function Ti(i,t,e,s,r){return i=(i-e)*r|0,t=(t-s)*r|0,i=(i|i<<8)&16711935,i=(i|i<<4)&252645135,i=(i|i<<2)&858993459,i=(i|i<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,i|t<<1}function yc(i){let t=i,e=i;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==i);return e}function Oo(i,t,e,s,r,n,o,a){return(r-o)*(t-a)>=(i-o)*(n-a)&&(i-o)*(s-a)>=(e-o)*(t-a)&&(e-o)*(n-a)>=(r-o)*(s-a)}function Se(i,t,e,s,r,n,o,a){return!(i===o&&t===a)&&Oo(i,t,e,s,r,n,o,a)}function xc(i,t){return i.next.i!==t.i&&i.prev.i!==t.i&&!_c(i,t)&&(Re(i,t)&&Re(t,i)&&bc(i,t)&&(q(i.prev,i,t.prev)||q(i,t.prev,t))||ne(i,t)&&q(i.prev,i,i.next)>0&&q(t.prev,t,t.next)>0)}function q(i,t,e){return(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y)}function ne(i,t){return i.x===t.x&&i.y===t.y}function jo(i,t,e,s){const r=es(q(i,t,e)),n=es(q(i,t,s)),o=es(q(e,s,i)),a=es(q(e,s,t));return!!(r!==n&&o!==a||r===0&&ts(i,e,t)||n===0&&ts(i,s,t)||o===0&&ts(e,i,s)||a===0&&ts(e,t,s))}function ts(i,t,e){return t.x<=Math.max(i.x,e.x)&&t.x>=Math.min(i.x,e.x)&&t.y<=Math.max(i.y,e.y)&&t.y>=Math.min(i.y,e.y)}function es(i){return i>0?1:i<0?-1:0}function _c(i,t){let e=i;do{if(e.i!==i.i&&e.next.i!==i.i&&e.i!==t.i&&e.next.i!==t.i&&jo(e,e.next,i,t))return!0;e=e.next}while(e!==i);return!1}function Re(i,t){return q(i.prev,i,i.next)<0?q(i,t,i.next)>=0&&q(i,i.prev,t)>=0:q(i,t,i.prev)<0||q(i,i.next,t)<0}function bc(i,t){let e=i,s=!1;const r=(i.x+t.x)/2,n=(i.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&r<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==i);return s}function Go(i,t){const e=Mi(i.i,i.x,i.y),s=Mi(t.i,t.x,t.y),r=i.next,n=t.prev;return i.next=t,t.prev=i,e.next=r,r.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function Ur(i,t,e,s){const r=Mi(i,t,e);return s?(r.next=s.next,r.prev=s,s.next.prev=r,s.next=r):(r.prev=r,r.next=r),r}function Be(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Mi(i,t,e){return{i,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function wc(i,t,e,s){let r=0;for(let n=t,o=e-s;n<e;n+=s)r+=(i[o]-i[n])*(i[n+1]+i[o+1]),o=n;return r}const vc=Vr.default||Vr;var zo=(i=>(i[i.NONE=0]="NONE",i[i.COLOR=16384]="COLOR",i[i.STENCIL=1024]="STENCIL",i[i.DEPTH=256]="DEPTH",i[i.COLOR_DEPTH=16640]="COLOR_DEPTH",i[i.COLOR_STENCIL=17408]="COLOR_STENCIL",i[i.DEPTH_STENCIL=1280]="DEPTH_STENCIL",i[i.ALL=17664]="ALL",i))(zo||{});class Ac{constructor(t){this.items=[],this._name=t}emit(t,e,s,r,n,o,a,l){const{name:h,items:c}=this;for(let u=0,d=c.length;u<d;u++)c[u][h](t,e,s,r,n,o,a,l);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Sc=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],No=class Do extends gt{constructor(t){super(),this.uid=X("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Sc,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await rc(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const s in this._systemsHash)t={...this._systemsHash[s].constructor.defaultOptions,...t};t={...Do.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let s=0;s<this.runners.init.items.length;s++)await this.runners.init.items[s].init(t);this._initOptions=t}render(t,e){let s=t;if(s instanceof Bt&&(s={container:s},e&&(L(N,"passing a second argument is deprecated, please use render options instead"),s.target=e.renderTexture)),s.target||(s.target=this.view.renderTarget),s.target===this.view.renderTarget&&(this._lastObjectRendered=s.container,s.clearColor??(s.clearColor=this.background.colorRgba),s.clear??(s.clear=this.background.clearBeforeRender)),s.clearColor){const r=Array.isArray(s.clearColor)&&s.clearColor.length===4;s.clearColor=r?s.clearColor:K.shared.setValue(s.clearColor).toArray()}s.transform||(s.container.updateLocalTransform(),s.transform=s.container.localTransform),s.container.visible&&(s.container.enableRenderGroup(),this.runners.prerender.emit(s),this.runners.renderStart.emit(s),this.runners.render.emit(s),this.runners.renderEnd.emit(s),this.runners.postrender.emit(s))}resize(t,e,s){const r=this.view.resolution;this.view.resize(t,e,s),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),s!==void 0&&s!==r&&this.runners.resolutionChange.emit(s)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=zo.ALL);const{clear:s,clearColor:r,target:n}=t;K.shared.setValue(r??this.background.colorRgba),e.renderTarget.clear(n,s,K.shared.toArray())}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Ac(e)})}_addSystems(t){let e;for(e in t){const s=t[e];this._addSystem(s.value,s.name)}}_addSystem(t,e){const s=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=s,this._systemsHash[e]=s;for(const r in this.runners)this.runners[r].add(s);return this}_addPipes(t,e){const s=e.reduce((r,n)=>(r[n.name]=n.value,r),{});t.forEach(r=>{const n=r.value,o=r.name,a=s[o];this.renderPipes[o]=new n(this,a?new a:null),this.runners.destroy.add(this.renderPipes[o])})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),(t===!0||typeof t=="object"&&t.releaseGlobalResources)&&Ne.release(),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!nc())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};No.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Wo=No,ss;function Pc(i){return ss!==void 0||(ss=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:i??Wo.defaultOptions.failIfMajorPerformanceCaveat};try{if(!$.get().getWebGLRenderingContext())return!1;let s=$.get().createCanvas().getContext("webgl",t);const r=!!s?.getContextAttributes()?.stencil;if(s){const n=s.getExtension("WEBGL_lose_context");n&&n.loseContext()}return s=null,r}catch{return!1}})()),ss}let is;async function Cc(i={}){return is!==void 0||(is=await(async()=>{const t=$.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(i)).requestDevice(),!0}catch{return!1}})()),is}const Hr=["webgl","webgpu","canvas"];async function Tc(i){let t=[];i.preference?(t.push(i.preference),Hr.forEach(n=>{n!==i.preference&&t.push(n)})):t=Hr.slice();let e,s={};for(let n=0;n<t.length;n++){const o=t[n];if(o==="webgpu"&&await Cc()){const{WebGPURenderer:a}=await vs(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-D3d7mZWv.js");return{WebGPURenderer:l}},__vite__mapDeps([3,2,4]));e=a,s={...i,...i.webgpu};break}else if(o==="webgl"&&Pc(i.failIfMajorPerformanceCaveat??Wo.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:a}=await vs(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-Dn84z-A8.js");return{WebGLRenderer:l}},__vite__mapDeps([5,2,4]));e=a,s={...i,...i.webgl};break}else if(o==="canvas")throw s={...i},new Error("CanvasRenderer is not yet implemented")}if(delete s.webgpu,delete s.webgl,!e)throw new Error("No available renderer for the current environment");const r=new e;return await r.init(s),r}const $o="8.14.3";class Vo{static init(){globalThis.__PIXI_APP_INIT__?.(this,$o)}static destroy(){}}Vo.extension=I.Application;class Mc{constructor(t){this._renderer=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,$o)}destroy(){this._renderer=null}}Mc.extension={type:[I.WebGLSystem,I.WebGPUSystem],name:"initHook",priority:-10};const Uo=class ki{constructor(...t){this.stage=new Bt,t[0]!==void 0&&L(N,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.stage||(this.stage=new Bt),this.renderer=await Tc(t),ki._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return L(N,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const s=ki._plugins.slice(0);s.reverse(),s.forEach(r=>{r.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};Uo._plugins=[];let Vi=Uo;Q.handleByList(I.Application,Vi._plugins);Q.add(Vo);class Ho extends gt{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return L(N,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return L(N,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return L(N,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return L(N,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return L(N,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners();for(const e in this.chars)this.chars[e].texture?.destroy();this.chars=null,t&&(this.pages.forEach(e=>e.texture.destroy(!0)),this.pages=null)}}class kc{constructor(t=0,e=0,s=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=s,this.size=0,this.ttl=e}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){const e=this.items[t];delete this.items[t],this.size--,e.prev!==null&&(e.prev.next=e.next),e.next!==null&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this}entries(t=this.keys()){return t.map(e=>[e,this.get(e)])}evict(t=!1){if(t||this.size>0){const e=this.first;delete this.items[e.key],--this.size===0?(this.first=null,this.last=null):(this.first=e.next,this.first.prev=null)}return this}expiresAt(t){let e;return this.has(t)&&(e=this.items[t].expiry),e}get(t){const e=this.items[t];if(e!==void 0){if(this.ttl>0&&e.expiry<=Date.now()){this.delete(t);return}return this.moveToEnd(e),e.value}}has(t){return t in this.items}moveToEnd(t){this.last!==t&&(t.prev!==null&&(t.prev.next=t.next),t.next!==null&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),t.prev=this.last,t.next=null,this.last!==null&&(this.last.next=t),this.last=t,this.first===null&&(this.first=t))}keys(){const t=[];let e=this.first;for(;e!==null;)t.push(e.key),e=e.next;return t}setWithEvicted(t,e,s=this.resetTtl){let r=null;if(this.has(t))this.set(t,e,!0,s);else{this.max>0&&this.size===this.max&&(r={...this.first},this.evict(!0));let n=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e};++this.size===1?this.first=n:this.last.next=n,this.last=n}return r}set(t,e,s=!1,r=this.resetTtl){let n=this.items[t];return s||n!==void 0?(n.value=e,s===!1&&r&&(n.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(n)):(this.max>0&&this.size===this.max&&this.evict(!0),n=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},++this.size===1?this.first=n:this.last.next=n,this.last=n),this}values(t=this.keys()){return t.map(e=>this.get(e))}}function qo(i=1e3,t=0,e=!1){if(isNaN(i)||i<0)throw new TypeError("Invalid max value");if(isNaN(t)||t<0)throw new TypeError("Invalid ttl value");if(typeof e!="boolean")throw new TypeError("Invalid resetTtl value");return new kc(i,t,e)}const Ec=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function Ss(i){const t=typeof i.fontSize=="number"?`${i.fontSize}px`:i.fontSize;let e=i.fontFamily;Array.isArray(i.fontFamily)||(e=i.fontFamily.split(","));for(let s=e.length-1;s>=0;s--){let r=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(r)&&!Ec.includes(r)&&(r=`"${r}"`),e[s]=r}return`${i.fontStyle} ${i.fontVariant} ${i.fontWeight} ${t} ${e.join(",")}`}const Zs={willReadFrequently:!0},xt=class E{static get experimentalLetterSpacingSupported(){let t=E._experimentalLetterSpacingSupported;if(t===void 0){const e=$.get().getCanvasRenderingContext2D().prototype;t=E._experimentalLetterSpacingSupported="letterSpacing"in e||"textLetterSpacing"in e}return t}constructor(t,e,s,r,n,o,a,l,h){this.text=t,this.style=e,this.width=s,this.height=r,this.lines=n,this.lineWidths=o,this.lineHeight=a,this.maxLineWidth=l,this.fontProperties=h}static measureText(t=" ",e,s=E._canvas,r=e.wordWrap){const n=`${t}-${e.styleKey}-wordWrap-${r}`;if(E._measurementCache.has(n))return E._measurementCache.get(n);const o=Ss(e),a=E.measureFont(o);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);const l=E.__context;l.font=o;const c=(r?E._wordWrap(t,e,s):t).split(/(?:\r\n|\r|\n)/),u=new Array(c.length);let d=0;for(let x=0;x<c.length;x++){const _=E._measureText(c[x],e.letterSpacing,l);u[x]=_,d=Math.max(d,_)}const f=e._stroke?.width||0;let p=d+f;e.dropShadow&&(p+=e.dropShadow.distance);const y=e.lineHeight||a.fontSize;let m=Math.max(y,a.fontSize+f)+(c.length-1)*(y+e.leading);e.dropShadow&&(m+=e.dropShadow.distance);const g=new E(t,e,p,m,c,u,y+e.leading,d,a);return E._measurementCache.set(n,g),g}static _measureText(t,e,s){let r=!1;E.experimentalLetterSpacingSupported&&(E.experimentalLetterSpacing?(s.letterSpacing=`${e}px`,s.textLetterSpacing=`${e}px`,r=!0):(s.letterSpacing="0px",s.textLetterSpacing="0px"));const n=s.measureText(t);let o=n.width;const a=-n.actualBoundingBoxLeft;let h=n.actualBoundingBoxRight-a;if(o>0)if(r)o-=e,h-=e;else{const c=(E.graphemeSegmenter(t).length-1)*e;o+=c,h+=c}return Math.max(o,h)}static _wordWrap(t,e,s=E._canvas){const r=s.getContext("2d",Zs);let n=0,o="",a="";const l=Object.create(null),{letterSpacing:h,whiteSpace:c}=e,u=E._collapseSpaces(c),d=E._collapseNewlines(c);let f=!u;const p=e.wordWrapWidth+h,y=E._tokenize(t);for(let m=0;m<y.length;m++){let g=y[m];if(E._isNewline(g)){if(!d){a+=E._addLine(o),f=!u,o="",n=0;continue}g=" "}if(u){const _=E.isBreakingSpace(g),b=E.isBreakingSpace(o[o.length-1]);if(_&&b)continue}const x=E._getFromCache(g,h,l,r);if(x>p)if(o!==""&&(a+=E._addLine(o),o="",n=0),E.canBreakWords(g,e.breakWords)){const _=E.wordWrapSplit(g);for(let b=0;b<_.length;b++){let A=_[b],v=A,w=1;for(;_[b+w];){const P=_[b+w];if(!E.canBreakChars(v,P,g,b,e.breakWords))A+=P;else break;v=P,w++}b+=w-1;const T=E._getFromCache(A,h,l,r);T+n>p&&(a+=E._addLine(o),f=!1,o="",n=0),o+=A,n+=T}}else{o.length>0&&(a+=E._addLine(o),o="",n=0);const _=m===y.length-1;a+=E._addLine(g,!_),f=!1,o="",n=0}else x+n>p&&(f=!1,a+=E._addLine(o),o="",n=0),(o.length>0||!E.isBreakingSpace(g)||f)&&(o+=g,n+=x)}return a+=E._addLine(o,!1),a}static _addLine(t,e=!0){return t=E._trimRight(t),t=e?`${t}
`:t,t}static _getFromCache(t,e,s,r){let n=s[t];return typeof n!="number"&&(n=E._measureText(t,e,r)+e,s[t]=n),n}static _collapseSpaces(t){return t==="normal"||t==="pre-line"}static _collapseNewlines(t){return t==="normal"}static _trimRight(t){if(typeof t!="string")return"";for(let e=t.length-1;e>=0;e--){const s=t[e];if(!E.isBreakingSpace(s))break;t=t.slice(0,-1)}return t}static _isNewline(t){return typeof t!="string"?!1:E._newlines.includes(t.charCodeAt(0))}static isBreakingSpace(t,e){return typeof t!="string"?!1:E._breakingSpaces.includes(t.charCodeAt(0))}static _tokenize(t){const e=[];let s="";if(typeof t!="string")return e;for(let r=0;r<t.length;r++){const n=t[r],o=t[r+1];if(E.isBreakingSpace(n,o)||E._isNewline(n)){s!==""&&(e.push(s),s=""),n==="\r"&&o===`
`?(e.push(`\r
`),r++):e.push(n);continue}s+=n}return s!==""&&e.push(s),e}static canBreakWords(t,e){return e}static canBreakChars(t,e,s,r,n){return!0}static wordWrapSplit(t){return E.graphemeSegmenter(t)}static measureFont(t){if(E._fonts[t])return E._fonts[t];const e=E._context;e.font=t;const s=e.measureText(E.METRICS_STRING+E.BASELINE_SYMBOL),r={ascent:s.actualBoundingBoxAscent,descent:s.actualBoundingBoxDescent,fontSize:s.actualBoundingBoxAscent+s.actualBoundingBoxDescent};return E._fonts[t]=r,r}static clearMetrics(t=""){t?delete E._fonts[t]:E._fonts={}}static get _canvas(){if(!E.__canvas){let t;try{const e=new OffscreenCanvas(0,0);if(e.getContext("2d",Zs)?.measureText)return E.__canvas=e,e;t=$.get().createCanvas()}catch{t=$.get().createCanvas()}t.width=t.height=10,E.__canvas=t}return E.__canvas}static get _context(){return E.__context||(E.__context=E._canvas.getContext("2d",Zs)),E.__context}};xt.METRICS_STRING="|q";xt.BASELINE_SYMBOL="M";xt.BASELINE_MULTIPLIER=1.4;xt.HEIGHT_MULTIPLIER=2;xt.graphemeSegmenter=(()=>{if(typeof Intl?.Segmenter=="function"){const i=new Intl.Segmenter;return t=>{const e=i.segment(t),s=[];let r=0;for(const n of e)s[r++]=n.segment;return s}}return i=>[...i]})();xt.experimentalLetterSpacing=!1;xt._fonts={};xt._newlines=[10,13];xt._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];xt._measurementCache=qo(1e3);let wt=xt;const qr=[{offset:0,color:"white"},{offset:1,color:"black"}],Ui=class Ei{constructor(...t){this.uid=X("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let e=Ic(t);e={...e.type==="radial"?Ei.defaultRadialOptions:Ei.defaultLinearOptions,...Jn(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(r=>{this.addColorStop(r.offset,r.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:K.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:s,y:r}=this.end,n=s-t,o=r-e;const a=n<0||o<0;if(this._wrapMode==="clamp-to-edge"){if(n<0){const m=t;t=s,s=m,n*=-1}if(o<0){const m=e;e=r,r=m,o*=-1}}const l=this.colorStops.length?this.colorStops:qr,h=this._textureSize,{canvas:c,context:u}=Xr(h,1),d=a?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);Yr(d,l),u.fillStyle=d,u.fillRect(0,0,h,1),this.texture=new j({source:new qt({resource:c,addressMode:this._wrapMode})});const f=Math.sqrt(n*n+o*o),p=Math.atan2(o,n),y=new O;y.scale(f/h,1),y.rotate(p),y.translate(t,e),this.textureSpace==="local"&&y.scale(h,h),this.transform=y}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:qr,e=this._textureSize,{canvas:s,context:r}=Xr(e,e),{x:n,y:o}=this.center,{x:a,y:l}=this.outerCenter,h=this.innerRadius,c=this.outerRadius,u=a-c,d=l-c,f=e/(c*2),p=(n-u)*f,y=(o-d)*f,m=r.createRadialGradient(p,y,h*f,(a-u)*f,(l-d)*f,c*f);Yr(m,t),r.fillStyle=t[t.length-1].color,r.fillRect(0,0,e,e),r.fillStyle=m,r.translate(p,y),r.rotate(this.rotation),r.scale(1,this.scale),r.translate(-p,-y),r.fillRect(0,0,e,e),this.texture=new j({source:new qt({resource:s,addressMode:this._wrapMode})});const g=new O;g.scale(1/f,1/f),g.translate(u,d),this.textureSpace==="local"&&g.scale(e,e),this.transform=g}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};Ui.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};Ui.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let Ct=Ui;function Yr(i,t){for(let e=0;e<t.length;e++){const s=t[e];i.addColorStop(s.offset,s.color)}}function Xr(i,t){const e=$.get().createCanvas(i,t),s=e.getContext("2d");return{canvas:e,context:s}}function Ic(i){let t=i[0]??{};return(typeof t=="number"||i[1])&&(L("8.5.2","use options object instead"),t={type:"linear",start:{x:i[0],y:i[1]},end:{x:i[2],y:i[3]},textureSpace:i[4],textureSize:i[5]??Ct.defaultLinearOptions.textureSize}),t}const Kr={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class Es{constructor(t,e){this.uid=X("fillPattern"),this._tick=0,this.transform=new O,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=Kr[e].addressModeU,t.source.style.addressModeV=Kr[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}var Qs,Jr;function Rc(){if(Jr)return Qs;Jr=1,Qs=e;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(n){var o=[];return n.replace(t,function(a,l,h){var c=l.toLowerCase();for(h=r(h),c=="m"&&h.length>2&&(o.push([l].concat(h.splice(0,2))),c="l",l=l=="m"?"l":"L");;){if(h.length==i[c])return h.unshift(l),o.push(h);if(h.length<i[c])throw new Error("malformed path data");o.push([l].concat(h.splice(0,i[c])))}}),o}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function r(n){var o=n.match(s);return o?o.map(Number):[]}return Qs}var Bc=Rc();const Lc=ze(Bc);function Fc(i,t){const e=Lc(i),s=[];let r=null,n=0,o=0;for(let a=0;a<e.length;a++){const l=e[a],h=l[0],c=l;switch(h){case"M":n=c[1],o=c[2],t.moveTo(n,o);break;case"m":n+=c[1],o+=c[2],t.moveTo(n,o);break;case"H":n=c[1],t.lineTo(n,o);break;case"h":n+=c[1],t.lineTo(n,o);break;case"V":o=c[1],t.lineTo(n,o);break;case"v":o+=c[1],t.lineTo(n,o);break;case"L":n=c[1],o=c[2],t.lineTo(n,o);break;case"l":n+=c[1],o+=c[2],t.lineTo(n,o);break;case"C":n=c[5],o=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],n,o);break;case"c":t.bezierCurveTo(n+c[1],o+c[2],n+c[3],o+c[4],n+c[5],o+c[6]),n+=c[5],o+=c[6];break;case"S":n=c[3],o=c[4],t.bezierCurveToShort(c[1],c[2],n,o);break;case"s":t.bezierCurveToShort(n+c[1],o+c[2],n+c[3],o+c[4]),n+=c[3],o+=c[4];break;case"Q":n=c[3],o=c[4],t.quadraticCurveTo(c[1],c[2],n,o);break;case"q":t.quadraticCurveTo(n+c[1],o+c[2],n+c[3],o+c[4]),n+=c[3],o+=c[4];break;case"T":n=c[1],o=c[2],t.quadraticCurveToShort(n,o);break;case"t":n+=c[1],o+=c[2],t.quadraticCurveToShort(n,o);break;case"A":n=c[6],o=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,o);break;case"a":n+=c[6],o+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,o);break;case"Z":case"z":t.closePath(),s.length>0&&(r=s.pop(),r?(n=r.startX,o=r.startY):(n=0,o=0)),r=null;break;default:U(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&r===null&&(r={startX:n,startY:o},s.push(r))}return t}class Hi{constructor(t=0,e=0,s=0){this.type="circle",this.x=t,this.y=e,this.radius=s}clone(){return new Hi(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const s=this.radius*this.radius;let r=this.x-t,n=this.y-e;return r*=r,n*=n,r+n<=s}strokeContains(t,e,s,r=.5){if(this.radius===0)return!1;const n=this.x-t,o=this.y-e,a=this.radius,l=(1-r)*s,h=Math.sqrt(n*n+o*o);return h<=a+l&&h>a-(s-l)}getBounds(t){return t||(t=new H),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class qi{constructor(t=0,e=0,s=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=s,this.halfHeight=r}clone(){return new qi(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let s=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return s*=s,r*=r,s+r<=1}strokeContains(t,e,s,r=.5){const{halfWidth:n,halfHeight:o}=this;if(n<=0||o<=0)return!1;const a=s*(1-r),l=s-a,h=n-l,c=o-l,u=n+a,d=o+a,f=t-this.x,p=e-this.y,y=f*f/(h*h)+p*p/(c*c),m=f*f/(u*u)+p*p/(d*d);return y>1&&m<=1}getBounds(t){return t||(t=new H),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Oc(i,t,e,s,r,n){const o=i-e,a=t-s,l=r-e,h=n-s,c=o*l+a*h,u=l*l+h*h;let d=-1;u!==0&&(d=c/u);let f,p;d<0?(f=e,p=s):d>1?(f=r,p=n):(f=e+d*l,p=s+d*h);const y=i-f,m=t-p;return y*y+m*m}let jc,Gc;class Te{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const s=[];for(let r=0,n=e.length;r<n;r++)s.push(e[r].x,e[r].y);e=s}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,s=e.length;for(let r=0;r<s;r+=2){const n=e[r],o=e[r+1],a=e[(r+2)%s],l=e[(r+3)%s];t+=(a-n)*(l+o)}return t<0}containsPolygon(t){const e=this.getBounds(jc),s=t.getBounds(Gc);if(!e.containsRect(s))return!1;const r=t.points;for(let n=0;n<r.length;n+=2){const o=r[n],a=r[n+1];if(!this.contains(o,a))return!1}return!0}clone(){const t=this.points.slice(),e=new Te(t);return e.closePath=this.closePath,e}contains(t,e){let s=!1;const r=this.points.length/2;for(let n=0,o=r-1;n<r;o=n++){const a=this.points[n*2],l=this.points[n*2+1],h=this.points[o*2],c=this.points[o*2+1];l>e!=c>e&&t<(h-a)*((e-l)/(c-l))+a&&(s=!s)}return s}strokeContains(t,e,s,r=.5){const n=s*s,o=n*(1-r),a=n-o,{points:l}=this,h=l.length-(this.closePath?0:2);for(let c=0;c<h;c+=2){const u=l[c],d=l[c+1],f=l[(c+2)%l.length],p=l[(c+3)%l.length],y=Oc(t,e,u,d,f,p),m=Math.sign((f-u)*(e-d)-(p-d)*(t-u));if(y<=(m<0?a:o))return!0}return!1}getBounds(t){t||(t=new H);const e=this.points;let s=1/0,r=-1/0,n=1/0,o=-1/0;for(let a=0,l=e.length;a<l;a+=2){const h=e[a],c=e[a+1];s=h<s?h:s,r=h>r?h:r,n=c<n?c:n,o=c>o?c:o}return t.x=s,t.width=r-s,t.y=n,t.height=o-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return L("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return L("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const rs=(i,t,e,s,r,n,o)=>{const a=i-e,l=t-s,h=Math.sqrt(a*a+l*l);return h>=r-n&&h<=r+o};class Yi{constructor(t=0,e=0,s=0,r=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=s,this.height=r,this.radius=n}getBounds(t){return t||(t=new H),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Yi(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;let r=t-(this.x+s),n=e-(this.y+s);const o=s*s;if(r*r+n*n<=o||(r=t-(this.x+this.width-s),r*r+n*n<=o)||(n=e-(this.y+this.height-s),r*r+n*n<=o)||(r=t-(this.x+s),r*r+n*n<=o))return!0}return!1}strokeContains(t,e,s,r=.5){const{x:n,y:o,width:a,height:l,radius:h}=this,c=s*(1-r),u=s-c,d=n+h,f=o+h,p=a-h*2,y=l-h*2,m=n+a,g=o+l;return(t>=n-c&&t<=n+u||t>=m-u&&t<=m+c)&&e>=f&&e<=f+y||(e>=o-c&&e<=o+u||e>=g-u&&e<=g+c)&&t>=d&&t<=d+p?!0:t<d&&e<f&&rs(t,e,d,f,h,u,c)||t>m-h&&e<f&&rs(t,e,m-h,f,h,u,c)||t>m-h&&e>g-h&&rs(t,e,m-h,g-h,h,u,c)||t<d&&e>g-h&&rs(t,e,d,g-h,h,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Yo={};function zc(i,t,e){let s=2166136261;for(let r=0;r<t;r++)s^=i[r].uid,s=Math.imul(s,16777619),s>>>=0;return Yo[s]||Nc(i,t,s,e)}function Nc(i,t,e,s){const r={};let n=0;for(let a=0;a<s;a++){const l=a<t?i[a]:j.EMPTY.source;r[n++]=l.source,r[n++]=l.style}const o=new gs(r);return Yo[e]=o,o}class Zr{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function Qr(i,t){const e=i.byteLength/8|0,s=new Float64Array(i,0,e);new Float64Array(t,0,e).set(s);const n=i.byteLength-e*8;if(n>0){const o=new Uint8Array(i,e*8,n);new Uint8Array(t,e*8,n).set(o)}}const Dc={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var Wc=(i=>(i[i.DISABLED=0]="DISABLED",i[i.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",i[i.MASK_ACTIVE=2]="MASK_ACTIVE",i[i.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",i[i.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",i[i.NONE=5]="NONE",i))(Wc||{});function tn(i,t){return t.alphaMode==="no-premultiply-alpha"&&Dc[i]||i}const $c=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Vc(i){let t="";for(let e=0;e<i;++e)e>0&&(t+=`
else `),e<i-1&&(t+=`if(test == ${e}.0){}`);return t}function Uc(i,t){if(i===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const s=$c.replace(/%forloop%/gi,Vc(i));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))i=i/2|0;else break}}finally{t.deleteShader(e)}return i}let Kt=null;function Hc(){if(Kt)return Kt;const i=Mo();return Kt=i.getParameter(i.MAX_TEXTURE_IMAGE_UNITS),Kt=Uc(Kt,i),i.getExtension("WEBGL_lose_context")?.loseContext(),Kt}class qc{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class Yc{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new qc,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null}}const Me=[];let Ps=0;Ne.register({clear:()=>{if(Me.length>0)for(const i of Me)i&&i.destroy();Me.length=0,Ps=0}});function en(){return Ps>0?Me[--Ps]:new Yc}function sn(i){Me[Ps++]=i}let xe=0;const Xo=class Ko{constructor(t){this.uid=X("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...Ko.defaultOptions,...t},t.maxTextures||(L("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=Hc());const{maxTextures:e,attributesInitialSize:s,indicesInitialSize:r}=t;this.attributeBuffer=new Zr(s*4),this.indexBuffer=new Uint16Array(r),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)sn(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const s=t._batch.textures.ids[e._source.uid];return!s&&s!==0?!1:(t._textureId=s,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let s=en(),r=s.textures;r.clear();const n=e[this.elementStart];let o=tn(n.blendMode,n.texture._source),a=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,d=this._batchIndexStart,f="startBatch";const p=this.maxTextures;for(let y=this.elementStart;y<this.elementSize;++y){const m=e[y];e[y]=null;const x=m.texture._source,_=tn(m.blendMode,x),b=o!==_||a!==m.topology;if(x._batchTick===xe&&!b){m._textureId=x._textureBindLocation,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,h,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,h,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize)),m._batch=s;continue}x._batchTick=xe,(r.count>=p||b)&&(this._finishBatch(s,d,u-d,r,o,a,t,f),f="renderBatch",d=u,o=_,a=m.topology,s=en(),r=s.textures,r.clear(),++xe),m._textureId=x._textureBindLocation=r.count,r.ids[x.uid]=r.count,r.textures[r.count++]=x,m._batch=s,u+=m.indexSize,m.packAsQuad?(this.packQuadAttributes(m,l,h,m._attributeStart,m._textureId),this.packQuadIndex(c,m._indexStart,m._attributeStart/this.vertexSize)):(this.packAttributes(m,l,h,m._attributeStart,m._textureId),this.packIndex(m,c,m._indexStart,m._attributeStart/this.vertexSize))}r.count>0&&(this._finishBatch(s,d,u-d,r,o,a,t,f),d=u,++xe),this.elementStart=this.elementSize,this._batchIndexStart=d,this._batchIndexSize=u}_finishBatch(t,e,s,r,n,o,a,l){t.gpuBindGroup=null,t.bindGroup=null,t.action=l,t.batcher=this,t.textures=r,t.blendMode=n,t.topology=o,t.start=e,t.size=s,++xe,this.batches[this.batchIndex++]=t,a.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),s=new Zr(e);Qr(this.attributeBuffer.rawBinaryData,s.rawBinaryData),this.attributeBuffer=s}_resizeIndexBuffer(t){const e=this.indexBuffer;let s=Math.max(t,e.length*1.5);s+=s%2;const r=s>65535?new Uint32Array(s):new Uint16Array(s);if(r.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)r[n]=e[n];else Qr(e.buffer,r.buffer);this.indexBuffer=r}packQuadIndex(t,e,s){t[e]=s+0,t[e+1]=s+1,t[e+2]=s+2,t[e+3]=s+0,t[e+4]=s+2,t[e+5]=s+3}packIndex(t,e,s,r){const n=t.indices,o=t.indexSize,a=t.indexOffset,l=t.attributeOffset;for(let h=0;h<o;h++)e[s++]=r+n[h+a]-l}destroy(t={}){if(this.batches!==null){for(let e=0;e<this.batches.length;e++)sn(this.batches[e]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,t.shader&&(this.shader?.destroy(),this.shader=null);for(let e=0;e<this._elements.length;e++)this._elements[e]&&(this._elements[e]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};Xo.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let Xc=Xo;var rt=(i=>(i[i.MAP_READ=1]="MAP_READ",i[i.MAP_WRITE=2]="MAP_WRITE",i[i.COPY_SRC=4]="COPY_SRC",i[i.COPY_DST=8]="COPY_DST",i[i.INDEX=16]="INDEX",i[i.VERTEX=32]="VERTEX",i[i.UNIFORM=64]="UNIFORM",i[i.STORAGE=128]="STORAGE",i[i.INDIRECT=256]="INDIRECT",i[i.QUERY_RESOLVE=512]="QUERY_RESOLVE",i[i.STATIC=1024]="STATIC",i))(rt||{});class Le extends gt{constructor(t){let{data:e,size:s}=t;const{usage:r,label:n,shrinkToFit:o}=t;super(),this.uid=X("buffer"),this._resourceType="buffer",this._resourceId=X("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,s??(s=e?.byteLength);const a=!!e;this.descriptor={size:s,usage:r,mappedAtCreation:a,label:n},this.shrinkToFit=o??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&rt.STATIC)}set static(t){t?this.descriptor.usage|=rt.STATIC:this.descriptor.usage&=~rt.STATIC}setDataWithSize(t,e,s){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){s&&this.emit("update",this);return}const r=this._data;if(this._data=t,this._dataInt32=null,!r||r.length!==t.length){!this.shrinkToFit&&r&&t.byteLength<r.byteLength?s&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=X("resource"),this.emit("change",this));return}s&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function Jo(i,t){if(!(i instanceof Le)){let e=t?rt.INDEX:rt.VERTEX;i instanceof Array&&(t?(i=new Uint32Array(i),e=rt.INDEX|rt.COPY_DST):(i=new Float32Array(i),e=rt.VERTEX|rt.COPY_DST)),i=new Le({data:i,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return i}function Kc(i,t,e){const s=i.getAttribute(t);if(!s)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const r=s.buffer.data;let n=1/0,o=1/0,a=-1/0,l=-1/0;const h=r.BYTES_PER_ELEMENT,c=(s.offset||0)/h,u=(s.stride||8)/h;for(let d=c;d<r.length;d+=u){const f=r[d],p=r[d+1];f>a&&(a=f),p>l&&(l=p),f<n&&(n=f),p<o&&(o=p)}return e.minX=n,e.minY=o,e.maxX=a,e.maxY=l,e}function Jc(i){return(i instanceof Le||Array.isArray(i)||i.BYTES_PER_ELEMENT)&&(i={buffer:i}),i.buffer=Jo(i.buffer,!1),i}class Zc extends gt{constructor(t={}){super(),this.uid=X("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new mt,this._boundsDirty=!0;const{attributes:e,indexBuffer:s,topology:r}=t;if(this.buffers=[],this.attributes={},e)for(const n in e)this.addAttribute(n,e[n]);this.instanceCount=t.instanceCount??1,s&&this.addIndex(s),this.topology=r||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const s=Jc(e);this.buffers.indexOf(s.buffer)===-1&&(this.buffers.push(s.buffer),s.buffer.on("update",this.onBufferUpdate,this),s.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=s}addIndex(t){this.indexBuffer=Jo(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Kc(this,"aPosition",this._bounds)):this._bounds}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Qc=new Float32Array(1),tu=new Uint32Array(1);class eu extends Zc{constructor(){const e=new Le({data:Qc,label:"attribute-batch-buffer",usage:rt.VERTEX|rt.COPY_DST,shrinkToFit:!1}),s=new Le({data:tu,label:"index-batch-buffer",usage:rt.INDEX|rt.COPY_DST,shrinkToFit:!1}),r=24;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:r,offset:0},aUV:{buffer:e,format:"float32x2",stride:r,offset:8},aColor:{buffer:e,format:"unorm8x4",stride:r,offset:16},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:r,offset:20}},indexBuffer:s})}}function rn(i,t,e){if(i)for(const s in i){const r=s.toLocaleLowerCase(),n=t[r];if(n){let o=i[s];s==="header"&&(o=o.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&n.push(`//----${e}----//`),n.push(o)}else U(`${s} placement hook does not exist in shader`)}}const su=/\{\{(.*?)\}\}/g;function nn(i){const t={};return(i.match(su)?.map(s=>s.replace(/[{()}]/g,""))??[]).forEach(s=>{t[s]=[]}),t}function on(i,t){let e;const s=/@in\s+([^;]+);/g;for(;(e=s.exec(i))!==null;)t.push(e[1])}function an(i,t,e=!1){const s=[];on(t,s),i.forEach(a=>{a.header&&on(a.header,s)});const r=s;e&&r.sort();const n=r.map((a,l)=>`       @location(${l}) ${a},`).join(`
`);let o=t.replace(/@in\s+[^;]+;\s*/g,"");return o=o.replace("{{in}}",`
${n}
`),o}function ln(i,t){let e;const s=/@out\s+([^;]+);/g;for(;(e=s.exec(i))!==null;)t.push(e[1])}function iu(i){const e=/\b(\w+)\s*:/g.exec(i);return e?e[1]:""}function ru(i){const t=/@.*?\s+/g;return i.replace(t,"")}function nu(i,t){const e=[];ln(t,e),i.forEach(l=>{l.header&&ln(l.header,e)});let s=0;const r=e.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${s++}) ${l}`).join(`,
`),n=e.sort().map(l=>`       var ${ru(l)};`).join(`
`),o=`return VSOutput(
            ${e.sort().map(l=>` ${iu(l)}`).join(`,
`)});`;let a=t.replace(/@out\s+[^;]+;\s*/g,"");return a=a.replace("{{struct}}",`
${r}
`),a=a.replace("{{start}}",`
${n}
`),a=a.replace("{{return}}",`
${o}
`),a}function hn(i,t){let e=i;for(const s in t){const r=t[s];r.join(`
`).length?e=e.replace(`{{${s}}}`,`//-----${s} START-----//
${r.join(`
`)}
//----${s} FINISH----//`):e=e.replace(`{{${s}}}`,"")}return e}const It=Object.create(null),ti=new Map;let ou=0;function au({template:i,bits:t}){const e=Zo(i,t);if(It[e])return It[e];const{vertex:s,fragment:r}=hu(i,t);return It[e]=Qo(s,r,t),It[e]}function lu({template:i,bits:t}){const e=Zo(i,t);return It[e]||(It[e]=Qo(i.vertex,i.fragment,t)),It[e]}function hu(i,t){const e=t.map(o=>o.vertex).filter(o=>!!o),s=t.map(o=>o.fragment).filter(o=>!!o);let r=an(e,i.vertex,!0);r=nu(e,r);const n=an(s,i.fragment,!0);return{vertex:r,fragment:n}}function Zo(i,t){return t.map(e=>(ti.has(e)||ti.set(e,ou++),ti.get(e))).sort((e,s)=>e-s).join("-")+i.vertex+i.fragment}function Qo(i,t,e){const s=nn(i),r=nn(t);return e.forEach(n=>{rn(n.vertex,s,n.name),rn(n.fragment,r,n.name)}),{vertex:hn(i,s),fragment:hn(t,r)}}const cu=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,uu=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,du=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,fu=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,pu={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},mu={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function gu({bits:i,name:t}){const e=au({template:{fragment:uu,vertex:cu},bits:[pu,...i]});return ks.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function yu({bits:i,name:t}){return new Eo({name:t,...lu({template:{vertex:du,fragment:fu},bits:[mu,...i]})})}const xu={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},_u={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},ei={};function bu(i){const t=[];if(i===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let s=0;s<i;s++)t.push(`@group(1) @binding(${e++}) var textureSource${s+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${s+1}: sampler;`)}return t.join(`
`)}function wu(i){const t=[];if(i===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<i;e++)e===i-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function vu(i){return ei[i]||(ei[i]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${bu(i)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${wu(i)}
            `}}),ei[i]}const si={};function Au(i){const t=[];for(let e=0;e<i;e++)e>0&&t.push("else"),e<i-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function Su(i){return si[i]||(si[i]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${i}];

            `,main:`

                ${Au(i)}
            `}}),si[i]}const Pu={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},Cu={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},cn={};function Tu(i){let t=cn[i];if(t)return t;const e=new Int32Array(i);for(let s=0;s<i;s++)e[s]=s;return t=cn[i]=new Lo({uTextures:{value:e,type:"i32",size:i}},{isStatic:!0}),t}class un extends $i{constructor(t){const e=yu({name:"batch",bits:[_u,Su(t),Cu]}),s=gu({name:"batch",bits:[xu,vu(t),Pu]});super({glProgram:e,gpuProgram:s,resources:{batchSamplers:Tu(t)}}),this.maxTextures=t}}let _e=null;const ta=class ea extends Xc{constructor(t){super(t),this.geometry=new eu,this.name=ea.extension.name,this.vertexSize=6,_e??(_e=new un(t.maxTextures)),this.shader=_e}packAttributes(t,e,s,r,n){const o=n<<16|t.roundPixels&65535,a=t.transform,l=a.a,h=a.b,c=a.c,u=a.d,d=a.tx,f=a.ty,{positions:p,uvs:y}=t,m=t.color,g=t.attributeOffset,x=g+t.attributeSize;for(let _=g;_<x;_++){const b=_*2,A=p[b],v=p[b+1];e[r++]=l*A+c*v+d,e[r++]=u*v+h*A+f,e[r++]=y[b],e[r++]=y[b+1],s[r++]=m,s[r++]=o}}packQuadAttributes(t,e,s,r,n){const o=t.texture,a=t.transform,l=a.a,h=a.b,c=a.c,u=a.d,d=a.tx,f=a.ty,p=t.bounds,y=p.maxX,m=p.minX,g=p.maxY,x=p.minY,_=o.uvs,b=t.color,A=n<<16|t.roundPixels&65535;e[r+0]=l*m+c*x+d,e[r+1]=u*x+h*m+f,e[r+2]=_.x0,e[r+3]=_.y0,s[r+4]=b,s[r+5]=A,e[r+6]=l*y+c*x+d,e[r+7]=u*x+h*y+f,e[r+8]=_.x1,e[r+9]=_.y1,s[r+10]=b,s[r+11]=A,e[r+12]=l*y+c*g+d,e[r+13]=u*g+h*y+f,e[r+14]=_.x2,e[r+15]=_.y2,s[r+16]=b,s[r+17]=A,e[r+18]=l*m+c*g+d,e[r+19]=u*g+h*m+f,e[r+20]=_.x3,e[r+21]=_.y3,s[r+22]=b,s[r+23]=A}_updateMaxTextures(t){this.shader.maxTextures!==t&&(_e=new un(t),this.shader=_e)}destroy(){this.shader=null,super.destroy()}};ta.extension={type:[I.Batcher],name:"default"};let Mu=ta;function ku(i,t,e,s,r,n,o,a=null){let l=0;e*=t,r*=n;const h=a.a,c=a.b,u=a.c,d=a.d,f=a.tx,p=a.ty;for(;l<o;){const y=i[e],m=i[e+1];s[r]=h*y+u*m+f,s[r+1]=c*y+d*m+p,r+=n,e+=t,l++}}function Eu(i,t,e,s){let r=0;for(t*=e;r<s;)i[t]=0,i[t+1]=0,t+=e,r++}function sa(i,t,e,s,r){const n=t.a,o=t.b,a=t.c,l=t.d,h=t.tx,c=t.ty;e||(e=0),s||(s=2),r||(r=i.length/s-e);let u=e*s;for(let d=0;d<r;d++){const f=i[u],p=i[u+1];i[u]=n*f+a*p+h,i[u+1]=o*f+l*p+c,u+=s}}const Iu=new O;class ia{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,s=this.renderable;return s?ao(e,s.groupColor)+(this.alpha*s.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||Iu}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const Fe={extension:{type:I.ShapeBuilder,name:"circle"},build(i,t){let e,s,r,n,o,a;if(i.type==="circle"){const b=i;if(o=a=b.radius,o<=0)return!1;e=b.x,s=b.y,r=n=0}else if(i.type==="ellipse"){const b=i;if(o=b.halfWidth,a=b.halfHeight,o<=0||a<=0)return!1;e=b.x,s=b.y,r=n=0}else{const b=i,A=b.width/2,v=b.height/2;e=b.x+A,s=b.y+v,o=a=Math.max(0,Math.min(b.radius,Math.min(A,v))),r=A-o,n=v-a}if(r<0||n<0)return!1;const l=Math.ceil(2.3*Math.sqrt(o+a)),h=l*8+(r?4:0)+(n?4:0);if(h===0)return!1;if(l===0)return t[0]=t[6]=e+r,t[1]=t[3]=s+n,t[2]=t[4]=e-r,t[5]=t[7]=s-n,!0;let c=0,u=l*4+(r?2:0)+2,d=u,f=h,p=r+o,y=n,m=e+p,g=e-p,x=s+y;if(t[c++]=m,t[c++]=x,t[--u]=x,t[--u]=g,n){const b=s-y;t[d++]=g,t[d++]=b,t[--f]=b,t[--f]=m}for(let b=1;b<l;b++){const A=Math.PI/2*(b/l),v=r+Math.cos(A)*o,w=n+Math.sin(A)*a,T=e+v,P=e-v,S=s+w,M=s-w;t[c++]=T,t[c++]=S,t[--u]=S,t[--u]=P,t[d++]=P,t[d++]=M,t[--f]=M,t[--f]=T}p=r,y=n+a,m=e+p,g=e-p,x=s+y;const _=s-y;return t[c++]=m,t[c++]=x,t[--f]=_,t[--f]=m,r&&(t[c++]=g,t[c++]=x,t[--f]=_,t[--f]=g),!0},triangulate(i,t,e,s,r,n){if(i.length===0)return;let o=0,a=0;for(let c=0;c<i.length;c+=2)o+=i[c],a+=i[c+1];o/=i.length/2,a/=i.length/2;let l=s;t[l*e]=o,t[l*e+1]=a;const h=l++;for(let c=0;c<i.length;c+=2)t[l*e]=i[c],t[l*e+1]=i[c+1],c>0&&(r[n++]=l,r[n++]=h,r[n++]=l-1),l++;r[n++]=h+1,r[n++]=h,r[n++]=l-1}},Ru={...Fe,extension:{...Fe.extension,name:"ellipse"}},Bu={...Fe,extension:{...Fe.extension,name:"roundedRectangle"}},ra=1e-4,dn=1e-4;function Lu(i){const t=i.length;if(t<6)return 1;let e=0;for(let s=0,r=i[t-2],n=i[t-1];s<t;s+=2){const o=i[s],a=i[s+1];e+=(o-r)*(a+n),r=o,n=a}return e<0?-1:1}function fn(i,t,e,s,r,n,o,a){const l=i-e*r,h=t-s*r,c=i+e*n,u=t+s*n;let d,f;o?(d=s,f=-e):(d=-s,f=e);const p=l+d,y=h+f,m=c+d,g=u+f;return a.push(p,y),a.push(m,g),2}function zt(i,t,e,s,r,n,o,a){const l=e-i,h=s-t;let c=Math.atan2(l,h),u=Math.atan2(r-i,n-t);a&&c<u?c+=Math.PI*2:!a&&c>u&&(u+=Math.PI*2);let d=c;const f=u-c,p=Math.abs(f),y=Math.sqrt(l*l+h*h),m=(15*p*Math.sqrt(y)/Math.PI>>0)+1,g=f/m;if(d+=g,a){o.push(i,t),o.push(e,s);for(let x=1,_=d;x<m;x++,_+=g)o.push(i,t),o.push(i+Math.sin(_)*y,t+Math.cos(_)*y);o.push(i,t),o.push(r,n)}else{o.push(e,s),o.push(i,t);for(let x=1,_=d;x<m;x++,_+=g)o.push(i+Math.sin(_)*y,t+Math.cos(_)*y),o.push(i,t);o.push(r,n),o.push(i,t)}return m*2}function Fu(i,t,e,s,r,n){const o=ra;if(i.length===0)return;const a=t;let l=a.alignment;if(t.alignment!==.5){let z=Lu(i);l=(l-.5)*z+.5}const h=new et(i[0],i[1]),c=new et(i[i.length-2],i[i.length-1]),u=s,d=Math.abs(h.x-c.x)<o&&Math.abs(h.y-c.y)<o;if(u){i=i.slice(),d&&(i.pop(),i.pop(),c.set(i[i.length-2],i[i.length-1]));const z=(h.x+c.x)*.5,Mt=(c.y+h.y)*.5;i.unshift(z,Mt),i.push(z,Mt)}const f=r,p=i.length/2;let y=i.length;const m=f.length/2,g=a.width/2,x=g*g,_=a.miterLimit*a.miterLimit;let b=i[0],A=i[1],v=i[2],w=i[3],T=0,P=0,S=-(A-w),M=b-v,B=0,F=0,G=Math.sqrt(S*S+M*M);S/=G,M/=G,S*=g,M*=g;const ct=l,k=(1-ct)*2,R=ct*2;u||(a.cap==="round"?y+=zt(b-S*(k-R)*.5,A-M*(k-R)*.5,b-S*k,A-M*k,b+S*R,A+M*R,f,!0)+2:a.cap==="square"&&(y+=fn(b,A,S,M,k,R,!0,f))),f.push(b-S*k,A-M*k),f.push(b+S*R,A+M*R);for(let z=1;z<p-1;++z){b=i[(z-1)*2],A=i[(z-1)*2+1],v=i[z*2],w=i[z*2+1],T=i[(z+1)*2],P=i[(z+1)*2+1],S=-(A-w),M=b-v,G=Math.sqrt(S*S+M*M),S/=G,M/=G,S*=g,M*=g,B=-(w-P),F=v-T,G=Math.sqrt(B*B+F*F),B/=G,F/=G,B*=g,F*=g;const Mt=v-b,ce=A-w,ue=v-T,de=P-w,nr=Mt*ue+ce*de,De=ce*ue-de*Mt,fe=De<0;if(Math.abs(De)<.001*Math.abs(nr)){f.push(v-S*k,w-M*k),f.push(v+S*R,w+M*R),nr>=0&&(a.join==="round"?y+=zt(v,w,v-S*k,w-M*k,v-B*k,w-F*k,f,!1)+4:y+=2,f.push(v-B*R,w-F*R),f.push(v+B*k,w+F*k));continue}const or=(-S+b)*(-M+w)-(-S+v)*(-M+A),ar=(-B+T)*(-F+w)-(-B+v)*(-F+P),We=(Mt*ar-ue*or)/De,$e=(de*or-ce*ar)/De,Bs=(We-v)*(We-v)+($e-w)*($e-w),Ft=v+(We-v)*k,Ot=w+($e-w)*k,jt=v-(We-v)*R,Gt=w-($e-w)*R,ba=Math.min(Mt*Mt+ce*ce,ue*ue+de*de),lr=fe?k:R,wa=ba+lr*lr*x;Bs<=wa?a.join==="bevel"||Bs/x>_?(fe?(f.push(Ft,Ot),f.push(v+S*R,w+M*R),f.push(Ft,Ot),f.push(v+B*R,w+F*R)):(f.push(v-S*k,w-M*k),f.push(jt,Gt),f.push(v-B*k,w-F*k),f.push(jt,Gt)),y+=2):a.join==="round"?fe?(f.push(Ft,Ot),f.push(v+S*R,w+M*R),y+=zt(v,w,v+S*R,w+M*R,v+B*R,w+F*R,f,!0)+4,f.push(Ft,Ot),f.push(v+B*R,w+F*R)):(f.push(v-S*k,w-M*k),f.push(jt,Gt),y+=zt(v,w,v-S*k,w-M*k,v-B*k,w-F*k,f,!1)+4,f.push(v-B*k,w-F*k),f.push(jt,Gt)):(f.push(Ft,Ot),f.push(jt,Gt)):(f.push(v-S*k,w-M*k),f.push(v+S*R,w+M*R),a.join==="round"?fe?y+=zt(v,w,v+S*R,w+M*R,v+B*R,w+F*R,f,!0)+2:y+=zt(v,w,v-S*k,w-M*k,v-B*k,w-F*k,f,!1)+2:a.join==="miter"&&Bs/x<=_&&(fe?(f.push(jt,Gt),f.push(jt,Gt)):(f.push(Ft,Ot),f.push(Ft,Ot)),y+=2),f.push(v-B*k,w-F*k),f.push(v+B*R,w+F*R),y+=2)}b=i[(p-2)*2],A=i[(p-2)*2+1],v=i[(p-1)*2],w=i[(p-1)*2+1],S=-(A-w),M=b-v,G=Math.sqrt(S*S+M*M),S/=G,M/=G,S*=g,M*=g,f.push(v-S*k,w-M*k),f.push(v+S*R,w+M*R),u||(a.cap==="round"?y+=zt(v-S*(k-R)*.5,w-M*(k-R)*.5,v-S*k,w-M*k,v+S*R,w+M*R,f,!1)+2:a.cap==="square"&&(y+=fn(v,w,S,M,k,R,!1,f)));const he=dn*dn;for(let z=m;z<y+m-2;++z)b=f[z*2],A=f[z*2+1],v=f[(z+1)*2],w=f[(z+1)*2+1],T=f[(z+2)*2],P=f[(z+2)*2+1],!(Math.abs(b*(w-P)+v*(P-A)+T*(A-w))<he)&&n.push(z,z+1,z+2)}function Ou(i,t,e,s){const r=ra;if(i.length===0)return;const n=i[0],o=i[1],a=i[i.length-2],l=i[i.length-1],h=t||Math.abs(n-a)<r&&Math.abs(o-l)<r,c=e,u=i.length/2,d=c.length/2;for(let f=0;f<u;f++)c.push(i[f*2]),c.push(i[f*2+1]);for(let f=0;f<u-1;f++)s.push(d+f,d+f+1);h&&s.push(d+u-1,d)}function na(i,t,e,s,r,n,o){const a=vc(i,t,2);if(!a)return;for(let h=0;h<a.length;h+=3)n[o++]=a[h]+r,n[o++]=a[h+1]+r,n[o++]=a[h+2]+r;let l=r*s;for(let h=0;h<i.length;h+=2)e[l]=i[h],e[l+1]=i[h+1],l+=s}const ju=[],Gu={extension:{type:I.ShapeBuilder,name:"polygon"},build(i,t){for(let e=0;e<i.points.length;e++)t[e]=i.points[e];return!0},triangulate(i,t,e,s,r,n){na(i,ju,t,e,s,r,n)}},zu={extension:{type:I.ShapeBuilder,name:"rectangle"},build(i,t){const e=i,s=e.x,r=e.y,n=e.width,o=e.height;return n>0&&o>0?(t[0]=s,t[1]=r,t[2]=s+n,t[3]=r,t[4]=s+n,t[5]=r+o,t[6]=s,t[7]=r+o,!0):!1},triangulate(i,t,e,s,r,n){let o=0;s*=e,t[s+o]=i[0],t[s+o+1]=i[1],o+=e,t[s+o]=i[2],t[s+o+1]=i[3],o+=e,t[s+o]=i[6],t[s+o+1]=i[7],o+=e,t[s+o]=i[4],t[s+o+1]=i[5],o+=e;const a=s/e;r[n++]=a,r[n++]=a+1,r[n++]=a+2,r[n++]=a+1,r[n++]=a+3,r[n++]=a+2}},Nu={extension:{type:I.ShapeBuilder,name:"triangle"},build(i,t){return t[0]=i.x,t[1]=i.y,t[2]=i.x2,t[3]=i.y2,t[4]=i.x3,t[5]=i.y3,!0},triangulate(i,t,e,s,r,n){let o=0;s*=e,t[s+o]=i[0],t[s+o+1]=i[1],o+=e,t[s+o]=i[2],t[s+o+1]=i[3],o+=e,t[s+o]=i[4],t[s+o+1]=i[5];const a=s/e;r[n++]=a,r[n++]=a+1,r[n++]=a+2}},Du=new O,Wu=new H;function $u(i,t,e,s){const r=t.matrix?i.copyFrom(t.matrix).invert():i.identity();if(t.textureSpace==="local"){const o=e.getBounds(Wu);t.width&&o.pad(t.width);const{x:a,y:l}=o,h=1/o.width,c=1/o.height,u=-a*h,d=-l*c,f=r.a,p=r.b,y=r.c,m=r.d;r.a*=h,r.b*=h,r.c*=c,r.d*=c,r.tx=u*f+d*y+r.tx,r.ty=u*p+d*m+r.ty}else r.translate(t.texture.frame.x,t.texture.frame.y),r.scale(1/t.texture.source.width,1/t.texture.source.height);const n=t.texture.source.style;return!(t.fill instanceof Ct)&&n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update()),s&&r.append(Du.copyFrom(s).invert()),r}const Is={};Q.handleByMap(I.ShapeBuilder,Is);Q.add(zu,Gu,Nu,Fe,Ru,Bu);const Vu=new H,Uu=new O;function Hu(i,t){const{geometryData:e,batches:s}=t;s.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let r=0;r<i.instructions.length;r++){const n=i.instructions[r];if(n.action==="texture")qu(n.data,s,e);else if(n.action==="fill"||n.action==="stroke"){const o=n.action==="stroke",a=n.data.path.shapePath,l=n.data.style,h=n.data.hole;o&&h&&pn(h.shapePath,l,!0,s,e),h&&(a.shapePrimitives[a.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),pn(a,l,o,s,e)}}}function qu(i,t,e){const s=[],r=Is.rectangle,n=Vu;n.x=i.dx,n.y=i.dy,n.width=i.dw,n.height=i.dh;const o=i.transform;if(!r.build(n,s))return;const{vertices:a,uvs:l,indices:h}=e,c=h.length,u=a.length/2;o&&sa(s,o),r.triangulate(s,a,2,u,h,c);const d=i.image,f=d.uvs;l.push(f.x0,f.y0,f.x1,f.y1,f.x3,f.y3,f.x2,f.y2);const p=ht.get(ia);p.indexOffset=c,p.indexSize=h.length-c,p.attributeOffset=u,p.attributeSize=a.length/2-u,p.baseColor=i.style,p.alpha=i.alpha,p.texture=d,p.geometryData=e,t.push(p)}function pn(i,t,e,s,r){const{vertices:n,uvs:o,indices:a}=r;i.shapePrimitives.forEach(({shape:l,transform:h,holes:c})=>{const u=[],d=Is[l.type];if(!d.build(l,u))return;const f=a.length,p=n.length/2;let y="triangle-list";if(h&&sa(u,h),e){const _=l.closePath??!0,b=t;b.pixelLine?(Ou(u,_,n,a),y="line-list"):Fu(u,b,!1,_,n,a)}else if(c){const _=[],b=u.slice();Yu(c).forEach(v=>{_.push(b.length/2),b.push(...v)}),na(b,_,n,2,p,a,f)}else d.triangulate(u,n,2,p,a,f);const m=o.length/2,g=t.texture;if(g!==j.WHITE){const _=$u(Uu,t,l,h);ku(n,2,p,o,m,2,n.length/2-p,_)}else Eu(o,m,2,n.length/2-p);const x=ht.get(ia);x.indexOffset=f,x.indexSize=a.length-f,x.attributeOffset=p,x.attributeSize=n.length/2-p,x.baseColor=t.color,x.alpha=t.alpha,x.texture=g,x.geometryData=r,x.topology=y,s.push(x)})}function Yu(i){const t=[];for(let e=0;e<i.length;e++){const s=i[e].shape,r=[];Is[s.type].build(s,r)&&t.push(r)}return t}class Xu{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}}class Ku{constructor(){this.instructions=new uo}init(t){const e=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(e):this.batcher=new Mu({maxTextures:e}),this.instructions.reset()}get geometry(){return L(ql,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Xi=class Ii{constructor(t){this._gpuContextHash={},this._graphicsDataContextHash=Object.create(null),this._renderer=t,t.renderableGC.addManagedHash(this,"_gpuContextHash"),t.renderableGC.addManagedHash(this,"_graphicsDataContextHash")}init(t){Ii.defaultOptions.bezierSmoothness=t?.bezierSmoothness??Ii.defaultOptions.bezierSmoothness}getContextRenderData(t){return this._graphicsDataContextHash[t.uid]||this._initContextRenderData(t)}updateGpuContext(t){let e=this._gpuContextHash[t.uid]||this._initContext(t);if(t.dirty){e?this._cleanGraphicsContextData(t):e=this._initContext(t),Hu(t,e);const s=t.batchMode;t.customShader||s==="no-batch"?e.isBatchable=!1:s==="auto"?e.isBatchable=e.geometryData.vertices.length<400:e.isBatchable=!0,t.dirty=!1}return e}getGpuContext(t){return this._gpuContextHash[t.uid]||this._initContext(t)}_initContextRenderData(t){const e=ht.get(Ku,{maxTextures:this._renderer.limits.maxBatchableTextures}),{batches:s,geometryData:r}=this._gpuContextHash[t.uid],n=r.vertices.length,o=r.indices.length;for(let c=0;c<s.length;c++)s[c].applyTransform=!1;const a=e.batcher;a.ensureAttributeBuffer(n),a.ensureIndexBuffer(o),a.begin();for(let c=0;c<s.length;c++){const u=s[c];a.add(u)}a.finish(e.instructions);const l=a.geometry;l.indexBuffer.setDataWithSize(a.indexBuffer,a.indexSize,!0),l.buffers[0].setDataWithSize(a.attributeBuffer.float32View,a.attributeSize,!0);const h=a.batches;for(let c=0;c<h.length;c++){const u=h[c];u.bindGroup=zc(u.textures.textures,u.textures.count,this._renderer.limits.maxBatchableTextures)}return this._graphicsDataContextHash[t.uid]=e,e}_initContext(t){const e=new Xu;return e.context=t,this._gpuContextHash[t.uid]=e,t.on("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]}onGraphicsContextDestroy(t){this._cleanGraphicsContextData(t),t.off("destroy",this.onGraphicsContextDestroy,this),this._gpuContextHash[t.uid]=null}_cleanGraphicsContextData(t){const e=this._gpuContextHash[t.uid];e.isBatchable||this._graphicsDataContextHash[t.uid]&&(ht.return(this.getContextRenderData(t)),this._graphicsDataContextHash[t.uid]=null),e.batches&&e.batches.forEach(s=>{ht.return(s)})}destroy(){for(const t in this._gpuContextHash)this._gpuContextHash[t]&&this.onGraphicsContextDestroy(this._gpuContextHash[t].context);this._gpuContextHash={},this._graphicsDataContextHash={},this._renderer=null}};Xi.extension={type:[I.WebGLSystem,I.WebGPUSystem,I.CanvasSystem],name:"graphicsContext"};Xi.defaultOptions={bezierSmoothness:.5};let oa=Xi;const Ju=8,ns=11920929e-14,Zu=1;function aa(i,t,e,s,r,n,o,a,l,h){const u=Math.min(.99,Math.max(0,h??oa.defaultOptions.bezierSmoothness));let d=(Zu-u)/1;return d*=d,Qu(t,e,s,r,n,o,a,l,i,d),i}function Qu(i,t,e,s,r,n,o,a,l,h){Ri(i,t,e,s,r,n,o,a,l,h,0),l.push(o,a)}function Ri(i,t,e,s,r,n,o,a,l,h,c){if(c>Ju)return;const u=(i+e)/2,d=(t+s)/2,f=(e+r)/2,p=(s+n)/2,y=(r+o)/2,m=(n+a)/2,g=(u+f)/2,x=(d+p)/2,_=(f+y)/2,b=(p+m)/2,A=(g+_)/2,v=(x+b)/2;if(c>0){let w=o-i,T=a-t;const P=Math.abs((e-o)*T-(s-a)*w),S=Math.abs((r-o)*T-(n-a)*w);if(P>ns&&S>ns){if((P+S)*(P+S)<=h*(w*w+T*T)){l.push(A,v);return}}else if(P>ns){if(P*P<=h*(w*w+T*T)){l.push(A,v);return}}else if(S>ns){if(S*S<=h*(w*w+T*T)){l.push(A,v);return}}else if(w=A-(i+o)/2,T=v-(t+a)/2,w*w+T*T<=h){l.push(A,v);return}}Ri(i,t,u,d,g,x,A,v,l,h,c+1),Ri(A,v,_,b,y,m,o,a,l,h,c+1)}const td=8,ed=11920929e-14,sd=1;function id(i,t,e,s,r,n,o,a){const h=Math.min(.99,Math.max(0,a??oa.defaultOptions.bezierSmoothness));let c=(sd-h)/1;return c*=c,rd(t,e,s,r,n,o,i,c),i}function rd(i,t,e,s,r,n,o,a){Bi(o,i,t,e,s,r,n,a,0),o.push(r,n)}function Bi(i,t,e,s,r,n,o,a,l){if(l>td)return;const h=(t+s)/2,c=(e+r)/2,u=(s+n)/2,d=(r+o)/2,f=(h+u)/2,p=(c+d)/2;let y=n-t,m=o-e;const g=Math.abs((s-n)*m-(r-o)*y);if(g>ed){if(g*g<=a*(y*y+m*m)){i.push(f,p);return}}else if(y=f-(t+n)/2,m=p-(e+o)/2,y*y+m*m<=a){i.push(f,p);return}Bi(i,t,e,h,c,f,p,a,l+1),Bi(i,f,p,u,d,n,o,a,l+1)}function la(i,t,e,s,r,n,o,a){let l=Math.abs(r-n);(!o&&r>n||o&&n>r)&&(l=2*Math.PI-l),a||(a=Math.max(6,Math.floor(6*Math.pow(s,1/3)*(l/Math.PI)))),a=Math.max(a,3);let h=l/a,c=r;h*=o?-1:1;for(let u=0;u<a+1;u++){const d=Math.cos(c),f=Math.sin(c),p=t+d*s,y=e+f*s;i.push(p,y),c+=h}}function nd(i,t,e,s,r,n){const o=i[i.length-2],l=i[i.length-1]-e,h=o-t,c=r-e,u=s-t,d=Math.abs(l*u-h*c);if(d<1e-8||n===0){(i[i.length-2]!==t||i[i.length-1]!==e)&&i.push(t,e);return}const f=l*l+h*h,p=c*c+u*u,y=l*c+h*u,m=n*Math.sqrt(f)/d,g=n*Math.sqrt(p)/d,x=m*y/f,_=g*y/p,b=m*u+g*h,A=m*c+g*l,v=h*(g+x),w=l*(g+x),T=u*(m+_),P=c*(m+_),S=Math.atan2(w-A,v-b),M=Math.atan2(P-A,T-b);la(i,b+t,A+e,n,S,M,h*c>u*l)}const ke=Math.PI*2,ii={centerX:0,centerY:0,ang1:0,ang2:0},ri=({x:i,y:t},e,s,r,n,o,a,l)=>{i*=e,t*=s;const h=r*i-n*t,c=n*i+r*t;return l.x=h+o,l.y=c+a,l};function od(i,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),s=t===1.5707963267948966?.551915024494:e,r=Math.cos(i),n=Math.sin(i),o=Math.cos(i+t),a=Math.sin(i+t);return[{x:r-n*s,y:n+r*s},{x:o+a*s,y:a-o*s},{x:o,y:a}]}const mn=(i,t,e,s)=>{const r=i*s-t*e<0?-1:1;let n=i*e+t*s;return n>1&&(n=1),n<-1&&(n=-1),r*Math.acos(n)},ad=(i,t,e,s,r,n,o,a,l,h,c,u,d)=>{const f=Math.pow(r,2),p=Math.pow(n,2),y=Math.pow(c,2),m=Math.pow(u,2);let g=f*p-f*m-p*y;g<0&&(g=0),g/=f*m+p*y,g=Math.sqrt(g)*(o===a?-1:1);const x=g*r/n*u,_=g*-n/r*c,b=h*x-l*_+(i+e)/2,A=l*x+h*_+(t+s)/2,v=(c-x)/r,w=(u-_)/n,T=(-c-x)/r,P=(-u-_)/n,S=mn(1,0,v,w);let M=mn(v,w,T,P);a===0&&M>0&&(M-=ke),a===1&&M<0&&(M+=ke),d.centerX=b,d.centerY=A,d.ang1=S,d.ang2=M};function ld(i,t,e,s,r,n,o,a=0,l=0,h=0){if(n===0||o===0)return;const c=Math.sin(a*ke/360),u=Math.cos(a*ke/360),d=u*(t-s)/2+c*(e-r)/2,f=-c*(t-s)/2+u*(e-r)/2;if(d===0&&f===0)return;n=Math.abs(n),o=Math.abs(o);const p=Math.pow(d,2)/Math.pow(n,2)+Math.pow(f,2)/Math.pow(o,2);p>1&&(n*=Math.sqrt(p),o*=Math.sqrt(p)),ad(t,e,s,r,n,o,l,h,c,u,d,f,ii);let{ang1:y,ang2:m}=ii;const{centerX:g,centerY:x}=ii;let _=Math.abs(m)/(ke/4);Math.abs(1-_)<1e-7&&(_=1);const b=Math.max(Math.ceil(_),1);m/=b;let A=i[i.length-2],v=i[i.length-1];const w={x:0,y:0};for(let T=0;T<b;T++){const P=od(y,m),{x:S,y:M}=ri(P[0],n,o,u,c,g,x,w),{x:B,y:F}=ri(P[1],n,o,u,c,g,x,w),{x:G,y:ct}=ri(P[2],n,o,u,c,g,x,w);aa(i,A,v,S,M,B,F,G,ct),A=G,v=ct,y+=m}}function hd(i,t,e){const s=(o,a)=>{const l=a.x-o.x,h=a.y-o.y,c=Math.sqrt(l*l+h*h),u=l/c,d=h/c;return{len:c,nx:u,ny:d}},r=(o,a)=>{o===0?i.moveTo(a.x,a.y):i.lineTo(a.x,a.y)};let n=t[t.length-1];for(let o=0;o<t.length;o++){const a=t[o%t.length],l=a.radius??e;if(l<=0){r(o,a),n=a;continue}const h=t[(o+1)%t.length],c=s(a,n),u=s(a,h);if(c.len<1e-4||u.len<1e-4){r(o,a),n=a;continue}let d=Math.asin(c.nx*u.ny-c.ny*u.nx),f=1,p=!1;c.nx*u.nx-c.ny*-u.ny<0?d<0?d=Math.PI+d:(d=Math.PI-d,f=-1,p=!0):d>0&&(f=-1,p=!0);const y=d/2;let m,g=Math.abs(Math.cos(y)*l/Math.sin(y));g>Math.min(c.len/2,u.len/2)?(g=Math.min(c.len/2,u.len/2),m=Math.abs(g*Math.sin(y)/Math.cos(y))):m=l;const x=a.x+u.nx*g+-u.ny*m*f,_=a.y+u.ny*g+u.nx*m*f,b=Math.atan2(c.ny,c.nx)+Math.PI/2*f,A=Math.atan2(u.ny,u.nx)-Math.PI/2*f;o===0&&i.moveTo(x+Math.cos(b)*m,_+Math.sin(b)*m),i.arc(x,_,m,b,A,p),n=a}}function cd(i,t,e,s){const r=(a,l)=>Math.sqrt((a.x-l.x)**2+(a.y-l.y)**2),n=(a,l,h)=>({x:a.x+(l.x-a.x)*h,y:a.y+(l.y-a.y)*h}),o=t.length;for(let a=0;a<o;a++){const l=t[(a+1)%o],h=l.radius??e;if(h<=0){a===0?i.moveTo(l.x,l.y):i.lineTo(l.x,l.y);continue}const c=t[a],u=t[(a+2)%o],d=r(c,l);let f;if(d<1e-4)f=l;else{const m=Math.min(d/2,h);f=n(l,c,m/d)}const p=r(u,l);let y;if(p<1e-4)y=l;else{const m=Math.min(p/2,h);y=n(l,u,m/p)}a===0?i.moveTo(f.x,f.y):i.lineTo(f.x,f.y),i.quadraticCurveTo(l.x,l.y,y.x,y.y,s)}}const ud=new H;class dd{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new mt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const s=this._currentPoly.points,r=s[s.length-2],n=s[s.length-1];return(r!==t||n!==e)&&s.push(t,e),this}arc(t,e,s,r,n,o){this._ensurePoly(!1);const a=this._currentPoly.points;return la(a,t,e,s,r,n,o),this}arcTo(t,e,s,r,n){this._ensurePoly();const o=this._currentPoly.points;return nd(o,t,e,s,r,n),this}arcToSvg(t,e,s,r,n,o,a){const l=this._currentPoly.points;return ld(l,this._currentPoly.lastX,this._currentPoly.lastY,o,a,t,e,s,r,n),this}bezierCurveTo(t,e,s,r,n,o,a){this._ensurePoly();const l=this._currentPoly;return aa(this._currentPoly.points,l.lastX,l.lastY,t,e,s,r,n,o,a),this}quadraticCurveTo(t,e,s,r,n){this._ensurePoly();const o=this._currentPoly;return id(this._currentPoly.points,o.lastX,o.lastY,t,e,s,r,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const s=this.shapePrimitives,r=s.length;for(let n=0;n<t.instructions.length;n++){const o=t.instructions[n];this[o.action](...o.data)}if(t.checkForHoles&&s.length-r>1){let n=null;for(let o=r;o<s.length;o++){const a=s[o];if(a.shape.type==="polygon"){const l=a.shape,h=n?.shape;h&&h.containsPolygon(l)?(n.holes||(n.holes=[]),n.holes.push(a),s.copyWithin(o,o+1),s.length--,o--):n=a}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,s,r,n){return this.drawShape(new H(t,e,s,r),n),this}circle(t,e,s,r){return this.drawShape(new Hi(t,e,s),r),this}poly(t,e,s){const r=new Te(t);return r.closePath=e,this.drawShape(r,s),this}regularPoly(t,e,s,r,n=0,o){r=Math.max(r|0,3);const a=-1*Math.PI/2+n,l=Math.PI*2/r,h=[];for(let c=0;c<r;c++){const u=a-c*l;h.push(t+s*Math.cos(u),e+s*Math.sin(u))}return this.poly(h,!0,o),this}roundPoly(t,e,s,r,n,o=0,a){if(r=Math.max(r|0,3),n<=0)return this.regularPoly(t,e,s,r,o);const l=s*Math.sin(Math.PI/r)-.001;n=Math.min(n,l);const h=-1*Math.PI/2+o,c=Math.PI*2/r,u=(r-2)*Math.PI/r/2;for(let d=0;d<r;d++){const f=d*c+h,p=t+s*Math.cos(f),y=e+s*Math.sin(f),m=f+Math.PI+u,g=f-Math.PI-u,x=p+n*Math.cos(m),_=y+n*Math.sin(m),b=p+n*Math.cos(g),A=y+n*Math.sin(g);d===0?this.moveTo(x,_):this.lineTo(x,_),this.quadraticCurveTo(p,y,b,A,a)}return this.closePath()}roundShape(t,e,s=!1,r){return t.length<3?this:(s?cd(this,t,e,r):hd(this,t,e),this.closePath())}filletRect(t,e,s,r,n){if(n===0)return this.rect(t,e,s,r);const o=Math.min(s,r)/2,a=Math.min(o,Math.max(-o,n)),l=t+s,h=e+r,c=a<0?-a:0,u=Math.abs(a);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(l-u,e).arcTo(l-c,e+c,l,e+u,u).lineTo(l,h-u).arcTo(l-c,h-c,t+s-u,h,u).lineTo(t+u,h).arcTo(t+c,h-c,t,h-u,u).closePath()}chamferRect(t,e,s,r,n,o){if(n<=0)return this.rect(t,e,s,r);const a=Math.min(n,Math.min(s,r)/2),l=t+s,h=e+r,c=[t+a,e,l-a,e,l,e+a,l,h-a,l-a,h,t+a,h,t,h-a,t,e+a];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,o)}ellipse(t,e,s,r,n){return this.drawShape(new qi(t,e,s,r),n),this}roundRect(t,e,s,r,n,o){return this.drawShape(new Yi(t,e,s,r,n),o),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let s=this._currentPoly;return s&&this.endPoly(),s=new Te,s.points.push(t,e),this._currentPoly=s,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new Te,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let s=e.shape.x,r=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,o=s;s=n.a*s+n.c*r+n.tx,r=n.b*o+n.d*r+n.ty}this._currentPoly.points.push(s,r)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const s=t.instructions[e];this[s.action](...s.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let s=0;s<e.length;s++){const r=e[s],n=r.shape.getBounds(ud);r.transform?t.addRect(n,r.transform):t.addRect(n)}return t}}class Pt{constructor(t,e=!1){this.instructions=[],this.uid=X("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Fc(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new dd(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,s,r,n){const o=this.instructions[this.instructions.length-1],a=this.getLastPoint(et.shared);let l=0,h=0;if(!o||o.action!=="bezierCurveTo")l=a.x,h=a.y;else{l=o.data[2],h=o.data[3];const c=a.x,u=a.y;l=c+(c-l),h=u+(u-h)}return this.instructions.push({action:"bezierCurveTo",data:[l,h,t,e,s,r,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,s){const r=this.instructions[this.instructions.length-1],n=this.getLastPoint(et.shared);let o=0,a=0;if(!r||r.action!=="quadraticCurveTo")o=n.x,a=n.y;else{o=r.data[0],a=r.data[1];const l=n.x,h=n.y;o=l+(l-o),a=h+(h-a)}return this.instructions.push({action:"quadraticCurveTo",data:[o,a,t,e,s]}),this._dirty=!0,this}rect(t,e,s,r,n){return this.instructions.push({action:"rect",data:[t,e,s,r,n]}),this._dirty=!0,this}circle(t,e,s,r){return this.instructions.push({action:"circle",data:[t,e,s,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,s,r,n,o,a){n||(n=r/2);const l=-1*Math.PI/2+o,h=s*2,c=Math.PI*2/h,u=[];for(let d=0;d<h;d++){const f=d%2?n:r,p=d*c+l;u.push(t+f*Math.cos(p),e+f*Math.sin(p))}return this.poly(u,!0,a),this}clone(t=!1){const e=new Pt;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let s=0;s<this.instructions.length;s++){const r=this.instructions[s];e.instructions.push({action:r.action,data:r.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,s=t.b,r=t.c,n=t.d,o=t.tx,a=t.ty;let l=0,h=0,c=0,u=0,d=0,f=0,p=0,y=0;for(let m=0;m<this.instructions.length;m++){const g=this.instructions[m],x=g.data;switch(g.action){case"moveTo":case"lineTo":l=x[0],h=x[1],x[0]=e*l+r*h+o,x[1]=s*l+n*h+a;break;case"bezierCurveTo":c=x[0],u=x[1],d=x[2],f=x[3],l=x[4],h=x[5],x[0]=e*c+r*u+o,x[1]=s*c+n*u+a,x[2]=e*d+r*f+o,x[3]=s*d+n*f+a,x[4]=e*l+r*h+o,x[5]=s*l+n*h+a;break;case"quadraticCurveTo":c=x[0],u=x[1],l=x[2],h=x[3],x[0]=e*c+r*u+o,x[1]=s*c+n*u+a,x[2]=e*l+r*h+o,x[3]=s*l+n*h+a;break;case"arcToSvg":l=x[5],h=x[6],p=x[0],y=x[1],x[0]=e*p+r*y,x[1]=s*p+n*y,x[5]=e*l+r*h+o,x[6]=s*l+n*h+a;break;case"circle":x[4]=be(x[3],t);break;case"rect":x[4]=be(x[4],t);break;case"ellipse":x[8]=be(x[8],t);break;case"roundRect":x[5]=be(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=be(x[2],t);break;default:U("unknown transform action",g.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,s=this.instructions[e];if(!s)return t.x=0,t.y=0,t;for(;s.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;s=this.instructions[e]}switch(s.action){case"moveTo":case"lineTo":t.x=s.data[0],t.y=s.data[1];break;case"quadraticCurveTo":t.x=s.data[2],t.y=s.data[3];break;case"bezierCurveTo":t.x=s.data[4],t.y=s.data[5];break;case"arc":case"arcToSvg":t.x=s.data[5],t.y=s.data[6];break;case"addPath":s.data[0].getLastPoint(t);break}return t}}function be(i,t){return i?i.prepend(t):t.clone()}function Y(i,t,e){const s=i.getAttribute(t);return s?Number(s):e}function fd(i,t){const e=i.querySelectorAll("defs");for(let s=0;s<e.length;s++){const r=e[s];for(let n=0;n<r.children.length;n++){const o=r.children[n];switch(o.nodeName.toLowerCase()){case"lineargradient":t.defs[o.id]=pd(o);break;case"radialgradient":t.defs[o.id]=md();break}}}}function pd(i){const t=Y(i,"x1",0),e=Y(i,"y1",0),s=Y(i,"x2",1),r=Y(i,"y2",0),n=i.getAttribute("gradientUnits")||"objectBoundingBox",o=new Ct(t,e,s,r,n==="objectBoundingBox"?"local":"global");for(let a=0;a<i.children.length;a++){const l=i.children[a],h=Y(l,"offset",0),c=K.shared.setValue(l.getAttribute("stop-color")).toNumber();o.addColorStop(h,c)}return o}function md(i){return U("[SVG Parser] Radial gradients are not yet supported"),new Ct(0,0,1,0)}function gn(i){const t=i.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const yn={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function ha(i,t){const e=i.getAttribute("style"),s={},r={},n={strokeStyle:s,fillStyle:r,useFill:!1,useStroke:!1};for(const o in yn){const a=i.getAttribute(o);a&&xn(t,n,o,a.trim())}if(e){const o=e.split(";");for(let a=0;a<o.length;a++){const l=o[a].trim(),[h,c]=l.split(":");yn[h]&&xn(t,n,h,c.trim())}}return{strokeStyle:n.useStroke?s:null,fillStyle:n.useFill?r:null,useFill:n.useFill,useStroke:n.useStroke}}function xn(i,t,e,s){switch(e){case"stroke":if(s!=="none"){if(s.startsWith("url(")){const r=gn(s);t.strokeStyle.fill=i.defs[r]}else t.strokeStyle.color=K.shared.setValue(s).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(s);break;case"fill":if(s!=="none"){if(s.startsWith("url(")){const r=gn(s);t.fillStyle.fill=i.defs[r]}else t.fillStyle.color=K.shared.setValue(s).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(s);break;case"stroke-opacity":t.strokeStyle.alpha=Number(s);break;case"opacity":t.fillStyle.alpha=Number(s),t.strokeStyle.alpha=Number(s);break}}function gd(i){if(i.length<=2)return!0;const t=i.map(a=>a.area).sort((a,l)=>l-a),[e,s]=t,r=t[t.length-1],n=e/s,o=s/r;return!(n>3&&o<2)}function yd(i){return i.split(/(?=[Mm])/).filter(s=>s.trim().length>0)}function xd(i){const t=i.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const e=t.map(Number),s=[],r=[];for(let c=0;c<e.length;c+=2)c+1<e.length&&(s.push(e[c]),r.push(e[c+1]));if(s.length===0||r.length===0)return 0;const n=Math.min(...s),o=Math.max(...s),a=Math.min(...r),l=Math.max(...r);return(o-n)*(l-a)}function _n(i,t){const e=new Pt(i,!1);for(const s of e.instructions)t.instructions.push(s)}function _d(i,t){if(typeof i=="string"){const o=document.createElement("div");o.innerHTML=i.trim(),i=o.querySelector("svg")}const e={context:t,defs:{},path:new Pt};fd(i,e);const s=i.children,{fillStyle:r,strokeStyle:n}=ha(i,e);for(let o=0;o<s.length;o++){const a=s[o];a.nodeName.toLowerCase()!=="defs"&&ca(a,e,r,n)}return t}function ca(i,t,e,s){const r=i.children,{fillStyle:n,strokeStyle:o}=ha(i,t);n&&e?e={...e,...n}:n&&(e=n),o&&s?s={...s,...o}:o&&(s=o);const a=!e&&!s;a&&(e={color:0});let l,h,c,u,d,f,p,y,m,g,x,_,b,A,v,w,T;switch(i.nodeName.toLowerCase()){case"path":{A=i.getAttribute("d");const P=i.getAttribute("fill-rule"),S=yd(A),M=P==="evenodd",B=S.length>1;if(M&&B){const G=S.map(k=>({path:k,area:xd(k)}));if(G.sort((k,R)=>R.area-k.area),S.length>3||!gd(G))for(let k=0;k<G.length;k++){const R=G[k],he=k===0;t.context.beginPath();const z=new Pt(void 0,!0);_n(R.path,z),t.context.path(z),he?(e&&t.context.fill(e),s&&t.context.stroke(s)):t.context.cut()}else for(let k=0;k<G.length;k++){const R=G[k],he=k%2===1;t.context.beginPath();const z=new Pt(void 0,!0);_n(R.path,z),t.context.path(z),he?t.context.cut():(e&&t.context.fill(e),s&&t.context.stroke(s))}}else{const G=P?P==="evenodd":!0;v=new Pt(A,G),t.context.path(v),e&&t.context.fill(e),s&&t.context.stroke(s)}break}case"circle":p=Y(i,"cx",0),y=Y(i,"cy",0),m=Y(i,"r",0),t.context.ellipse(p,y,m,m),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"rect":l=Y(i,"x",0),h=Y(i,"y",0),w=Y(i,"width",0),T=Y(i,"height",0),g=Y(i,"rx",0),x=Y(i,"ry",0),g||x?t.context.roundRect(l,h,w,T,g||x):t.context.rect(l,h,w,T),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"ellipse":p=Y(i,"cx",0),y=Y(i,"cy",0),g=Y(i,"rx",0),x=Y(i,"ry",0),t.context.beginPath(),t.context.ellipse(p,y,g,x),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"line":c=Y(i,"x1",0),u=Y(i,"y1",0),d=Y(i,"x2",0),f=Y(i,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(d,f),s&&t.context.stroke(s);break;case"polygon":b=i.getAttribute("points"),_=b.match(/\d+/g).map(P=>parseInt(P,10)),t.context.poly(_,!0),e&&t.context.fill(e),s&&t.context.stroke(s);break;case"polyline":b=i.getAttribute("points"),_=b.match(/\d+/g).map(P=>parseInt(P,10)),t.context.poly(_,!1),s&&t.context.stroke(s);break;case"g":case"svg":break;default:{U(`[SVG parser] <${i.nodeName}> elements unsupported`);break}}a&&(e=null);for(let P=0;P<r.length;P++)ca(r[P],t,e,s)}function bd(i){return K.isColorLike(i)}function bn(i){return i instanceof Es}function wn(i){return i instanceof Ct}function wd(i){return i instanceof j}function vd(i,t,e){const s=K.shared.setValue(t??0);return i.color=s.toNumber(),i.alpha=s.alpha===1?e.alpha:s.alpha,i.texture=j.WHITE,{...e,...i}}function Ad(i,t,e){return i.texture=t,{...e,...i}}function vn(i,t,e){return i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,{...e,...i}}function An(i,t,e){return t.buildGradient(),i.fill=t,i.color=16777215,i.texture=t.texture,i.matrix=t.transform,i.textureSpace=t.textureSpace,{...e,...i}}function Sd(i,t){const e={...t,...i},s=K.shared.setValue(e.color);return e.alpha*=s.alpha,e.color=s.toNumber(),e}function Ut(i,t){if(i==null)return null;const e={},s=i;return bd(i)?vd(e,i,t):wd(i)?Ad(e,i,t):bn(i)?vn(e,i,t):wn(i)?An(e,i,t):s.fill&&bn(s.fill)?vn(s,s.fill,t):s.fill&&wn(s.fill)?An(s,s.fill,t):Sd(s,t)}function Cs(i,t){const{width:e,alignment:s,miterLimit:r,cap:n,join:o,pixelLine:a,...l}=t,h=Ut(i,l);return h?{width:e,alignment:s,miterLimit:r,cap:n,join:o,pixelLine:a,...h}:null}const Pd=new et,Sn=new O,Ki=class bt extends gt{constructor(){super(...arguments),this.uid=X("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this._activePath=new Pt,this._transform=new O,this._fillStyle={...bt.defaultFillStyle},this._strokeStyle={...bt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new mt,this._boundsDirty=!0}clone(){const t=new bt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Ut(t,bt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=Cs(t,bt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Ut(t,bt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Ut(t,bt.defaultStrokeStyle),this}texture(t,e,s,r,n,o){return this.instructions.push({action:"texture",data:{image:t,dx:s||0,dy:r||0,dw:n||t.frame.width,dh:o||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?K.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new Pt,this}fill(t,e){let s;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="stroke"?s=r.data.path:s=this._activePath.clone(),s?(t!=null&&(e!==void 0&&typeof t=="number"&&(L(N,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Ut(t,bt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:s}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(et.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const s=this.instructions[this.instructions.length-1];return this._tick===0&&s?.action==="fill"?e=s.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=Cs(t,bt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],s=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(s);else{e.data.hole=s;break}}return this._initNextPathLocation(),this}arc(t,e,s,r,n,o){this._tick++;const a=this._transform;return this._activePath.arc(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,s,r,n,o),this}arcTo(t,e,s,r,n){this._tick++;const o=this._transform;return this._activePath.arcTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*s+o.c*r+o.tx,o.b*s+o.d*r+o.ty,n),this}arcToSvg(t,e,s,r,n,o,a){this._tick++;const l=this._transform;return this._activePath.arcToSvg(t,e,s,r,n,l.a*o+l.c*a+l.tx,l.b*o+l.d*a+l.ty),this}bezierCurveTo(t,e,s,r,n,o,a){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*t+l.c*e+l.tx,l.b*t+l.d*e+l.ty,l.a*s+l.c*r+l.tx,l.b*s+l.d*r+l.ty,l.a*n+l.c*o+l.tx,l.b*n+l.d*o+l.ty,a),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,s,r){return this._tick++,this._activePath.ellipse(t,e,s,r,this._transform.clone()),this}circle(t,e,s){return this._tick++,this._activePath.circle(t,e,s,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const s=this._transform;return this._activePath.lineTo(s.a*t+s.c*e+s.tx,s.b*t+s.d*e+s.ty),this}moveTo(t,e){this._tick++;const s=this._transform,r=this._activePath.instructions,n=s.a*t+s.c*e+s.tx,o=s.b*t+s.d*e+s.ty;return r.length===1&&r[0].action==="moveTo"?(r[0].data[0]=n,r[0].data[1]=o,this):(this._activePath.moveTo(n,o),this)}quadraticCurveTo(t,e,s,r,n){this._tick++;const o=this._transform;return this._activePath.quadraticCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*s+o.c*r+o.tx,o.b*s+o.d*r+o.ty,n),this}rect(t,e,s,r){return this._tick++,this._activePath.rect(t,e,s,r,this._transform.clone()),this}roundRect(t,e,s,r,n){return this._tick++,this._activePath.roundRect(t,e,s,r,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,s,r,n=0,o){return this._tick++,this._activePath.regularPoly(t,e,s,r,n,o),this}roundPoly(t,e,s,r,n,o){return this._tick++,this._activePath.roundPoly(t,e,s,r,n,o),this}roundShape(t,e,s,r){return this._tick++,this._activePath.roundShape(t,e,s,r),this}filletRect(t,e,s,r,n){return this._tick++,this._activePath.filletRect(t,e,s,r,n),this}chamferRect(t,e,s,r,n,o){return this._tick++,this._activePath.chamferRect(t,e,s,r,n,o),this}star(t,e,s,r,n=0,o=0){return this._tick++,this._activePath.star(t,e,s,r,n,o,this._transform.clone()),this}svg(t){return this._tick++,_d(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,s,r,n,o){return t instanceof O?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,s,r,n,o),this)}transform(t,e,s,r,n,o){return t instanceof O?(this._transform.append(t),this):(Sn.set(t,e,s,r,n,o),this._transform.append(Sn),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const s=this.instructions[e],r=s.action;if(r==="fill"){const n=s.data;t.addBounds(n.path.bounds)}else if(r==="texture"){const n=s.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(r==="stroke"){const n=s.data,o=n.style.alignment,a=n.style.width*(1-o),l=n.path.bounds;t.addFrame(l.minX-a,l.minY-a,l.maxX+a,l.maxY+a)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let s=!1;for(let r=0;r<e.length;r++){const n=e[r],o=n.data,a=o.path;if(!n.action||!a)continue;const l=o.style,h=a.shapePath.shapePrimitives;for(let c=0;c<h.length;c++){const u=h[c].shape;if(!l||!u)continue;const d=h[c].transform,f=d?d.applyInverse(t,Pd):t;if(n.action==="fill")s=u.contains(f.x,f.y);else{const y=l;s=u.strokeContains(f.x,f.y,y.width,y.alignment)}const p=o.hole;if(p){const y=p.shapePath?.shapePrimitives;if(y)for(let m=0;m<y.length;m++)y[m].shape.contains(f.x,f.y)&&(s=!1)}if(s)return!0}}return s}destroy(t=!1){if(this._stateStack.length=0,this._transform=null,this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const s=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(s)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(s))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};Ki.defaultFillStyle={color:16777215,alpha:1,texture:j.WHITE,matrix:null,fill:null,textureSpace:"local"};Ki.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:j.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let at=Ki;const Ji=class Jt extends gt{constructor(t={}){super(),this.uid=X("textStyle"),this._tick=0,Cd(t);const e={...Jt.defaultTextStyle,...t};for(const s in e){const r=s;this[r]=e[s]}this.update(),this._tick=0}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.update())}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(t){this._dropShadow!==t&&(t!==null&&typeof t=="object"?this._dropShadow=this._createProxy({...Jt.defaultDropShadow,...t}):this._dropShadow=t?this._createProxy({...Jt.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.update())}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&(typeof t=="string"?this._fontSize=parseInt(t,10):this._fontSize=t,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.update())}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.update())}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.update())}get filters(){return this._filters}set filters(t){this._filters!==t&&(this._filters=Object.freeze(t),this.update())}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.update())}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...at.defaultFillStyle,...t},()=>{this._fill=Ut({...this._originalFill},at.defaultFillStyle)})),this._fill=Ut(t===0?"black":t,at.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...at.defaultStrokeStyle,...t},()=>{this._stroke=Cs({...this._originalStroke},at.defaultStrokeStyle)})),this._stroke=Cs(t,at.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){const t=Jt.defaultTextStyle;for(const e in t)this[e]=t[e]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new Jt({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){if(this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const s=typeof t=="boolean"?t:t?.textureSource;this._fill?.texture&&this._fill.texture.destroy(s),this._originalFill?.texture&&this._originalFill.texture.destroy(s),this._stroke?.texture&&this._stroke.texture.destroy(s),this._originalStroke?.texture&&this._originalStroke.texture.destroy(s)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(s,r,n)=>(s[r]===n||(s[r]=n,e?.(r,n),this.update()),!0)})}_isFillStyle(t){return(t??null)!==null&&!(K.isColorLike(t)||t instanceof Ct||t instanceof Es)}};Ji.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5};Ji.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100};let Oe=Ji;function Cd(i){const t=i;if(typeof t.dropShadow=="boolean"&&t.dropShadow){const e=Oe.defaultDropShadow;i.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(t.strokeThickness!==void 0){L(N,"strokeThickness is now a part of stroke");const e=t.stroke;let s={};if(K.isColorLike(e))s.color=e;else if(e instanceof Ct||e instanceof Es)s.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))s=e;else throw new Error("Invalid stroke value.");i.stroke={...s,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){if(L(N,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(t.fill)||t.fill.length===0)throw new Error("Invalid fill value. Expected an array of colors for gradient fill.");t.fill.length!==t.fillGradientStops.length&&U("The number of fill colors must match the number of fill gradient stops.");const e=new Ct({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),s=t.fillGradientStops.slice(),r=t.fill.map(n=>K.shared.setValue(n).toNumber());s.forEach((n,o)=>{e.addColorStop(n,r[o])}),i.fill={fill:e}}}class Td{constructor(t){this._canvasPool=Object.create(null),this.canvasOptions=t||{},this.enableFullScreen=!1}_createCanvasAndContext(t,e){const s=$.get().createCanvas();s.width=t,s.height=e;const r=s.getContext("2d");return{canvas:s,context:r}}getOptimalCanvasAndContext(t,e,s=1){t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),t=se(t),e=se(e);const r=(t<<17)+(e<<1);this._canvasPool[r]||(this._canvasPool[r]=[]);let n=this._canvasPool[r].pop();return n||(n=this._createCanvasAndContext(t,e)),n}returnCanvasAndContext(t){const e=t.canvas,{width:s,height:r}=e,n=(s<<17)+(r<<1);t.context.resetTransform(),t.context.clearRect(0,0,s,r),this._canvasPool[n].push(t)}clear(){this._canvasPool={}}}const je=new Td;Ne.register(je);const Pn=1e5;function Ts(i,t,e,s=0){if(i.texture===j.WHITE&&!i.fill)return K.shared.setValue(i.color).setAlpha(i.alpha??1).toHexa();if(i.fill){if(i.fill instanceof Es){const r=i.fill,n=t.createPattern(r.texture.source.resource,"repeat"),o=r.transform.copyTo(O.shared);return o.scale(r.texture.frame.width,r.texture.frame.height),n.setTransform(o),n}else if(i.fill instanceof Ct){const r=i.fill,n=r.type==="linear",o=r.textureSpace==="local";let a=1,l=1;o&&e&&(a=e.width+s,l=e.height+s);let h,c=!1;if(n){const{start:u,end:d}=r;h=t.createLinearGradient(u.x*a,u.y*l,d.x*a,d.y*l),c=Math.abs(d.x-u.x)<Math.abs((d.y-u.y)*.1)}else{const{center:u,innerRadius:d,outerCenter:f,outerRadius:p}=r;h=t.createRadialGradient(u.x*a,u.y*l,d*a,f.x*a,f.y*l,p*a)}if(c&&o&&e){const u=e.lineHeight/l;for(let d=0;d<e.lines.length;d++){const f=(d*e.lineHeight+s/2)/l;r.colorStops.forEach(p=>{const y=f+p.offset*u;h.addColorStop(Math.floor(y*Pn)/Pn,K.shared.setValue(p.color).toHex())})}}else r.colorStops.forEach(u=>{h.addColorStop(u.offset,K.shared.setValue(u.color).toHex())});return h}}else{const r=t.createPattern(i.texture.source.resource,"repeat"),n=i.matrix.copyTo(O.shared);return n.scale(i.texture.frame.width,i.texture.frame.height),r.setTransform(n),r}return U("FillStyle not recognised",i),"red"}const ua=class da extends Ho{constructor(t){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const e={...da.defaultOptions,...t};this._textureSize=e.textureSize,this._mipmap=e.mipmap;const s=e.style.clone();e.overrideFill&&(s._fill.color=16777215,s._fill.alpha=1,s._fill.texture=j.WHITE,s._fill.fill=null),this.applyFillAsTint=e.overrideFill;const r=s.fontSize;s.fontSize=this.baseMeasurementFontSize;const n=Ss(s);e.overrideSize?s._stroke&&(s._stroke.width*=this.baseRenderedFontSize/r):s.fontSize=this.baseRenderedFontSize=r,this._style=s,this._skipKerning=e.skipKerning??!1,this.resolution=e.resolution??1,this._padding=e.padding??4,e.textureStyle&&(this._textureStyle=e.textureStyle instanceof ie?e.textureStyle:new ie(e.textureStyle)),this.fontMetrics=wt.measureFont(n),this.lineHeight=s.lineHeight||this.fontMetrics.fontSize||s.fontSize}ensureCharacters(t){const e=wt.graphemeSegmenter(t).filter(m=>!this._currentChars.includes(m)).filter((m,g,x)=>x.indexOf(m)===g);if(!e.length)return;this._currentChars=[...this._currentChars,...e];let s;this._currentPageIndex===-1?s=this._nextPage():s=this.pages[this._currentPageIndex];let{canvas:r,context:n}=s.canvasAndContext,o=s.texture.source;const a=this._style;let l=this._currentX,h=this._currentY,c=this._currentMaxCharHeight;const u=this.baseRenderedFontSize/this.baseMeasurementFontSize,d=this._padding*u;let f=!1;const p=r.width/this.resolution,y=r.height/this.resolution;for(let m=0;m<e.length;m++){const g=e[m],x=wt.measureText(g,a,r,!1);x.lineHeight=x.height;const _=x.width*u,b=Math.ceil((a.fontStyle==="italic"?2:1)*_),A=x.height*u,v=b+d*2,w=A+d*2;if(f=!1,g!==`
`&&g!=="\r"&&g!=="	"&&g!==" "&&(f=!0,c=Math.ceil(Math.max(w,c))),l+v>p&&(h+=c,c=w,l=0,h+c>y)){o.update();const P=this._nextPage();r=P.canvasAndContext.canvas,n=P.canvasAndContext.context,o=P.texture.source,l=0,h=0,c=0}const T=_/u-(a.dropShadow?.distance??0)-(a._stroke?.width??0);if(this.chars[g]={id:g.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:T,kerning:{}},f){this._drawGlyph(n,x,l+d,h+d,u,a);const P=o.width*u,S=o.height*u,M=new H(l/P*o.width,h/S*o.height,v/P*o.width,w/S*o.height);this.chars[g].texture=new j({source:o,frame:M}),l+=Math.ceil(v)}}o.update(),this._currentX=l,this._currentY=h,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(e,n)}get pageTextures(){return L(N,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){const s=this._measureCache;for(let r=0;r<t.length;r++){const n=t[r];for(let o=0;o<this._currentChars.length;o++){const a=this._currentChars[o];let l=s[n];l||(l=s[n]=e.measureText(n).width);let h=s[a];h||(h=s[a]=e.measureText(a).width);let c=e.measureText(n+a).width,u=c-(l+h);u&&(this.chars[n].kerning[a]=u),c=e.measureText(n+a).width,u=c-(l+h),u&&(this.chars[a].kerning[n]=u)}}}_nextPage(){this._currentPageIndex++;const t=this.resolution,e=je.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);const s=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new j({source:new qt({resource:e.canvas,resolution:s,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(r.source.style=this._textureStyle);const n={canvasAndContext:e,texture:r};return this.pages[this._currentPageIndex]=n,n}_setupContext(t,e,s){e.fontSize=this.baseRenderedFontSize,t.scale(s,s),t.font=Ss(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;const r=e._stroke,n=r?.width??0;if(r&&(t.lineWidth=n,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=Ts(r,t)),e._fill&&(t.fillStyle=Ts(e._fill,t)),e.dropShadow){const o=e.dropShadow,a=K.shared.setValue(o.color).toArray(),l=o.blur*s,h=o.distance*s;t.shadowColor=`rgba(${a[0]*255},${a[1]*255},${a[2]*255},${o.alpha})`,t.shadowBlur=l,t.shadowOffsetX=Math.cos(o.angle)*h,t.shadowOffsetY=Math.sin(o.angle)*h}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,s,r,n,o){const a=e.text,l=e.fontProperties,c=(o._stroke?.width??0)*n,u=s+c/2,d=r-c/2,f=l.descent*n,p=e.lineHeight*n;let y=!1;o.stroke&&c&&(y=!0,t.strokeText(a,u,d+p-f));const{shadowBlur:m,shadowOffsetX:g,shadowOffsetY:x}=t;o._fill&&(y&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(a,u,d+p-f)),y&&(t.shadowBlur=m,t.shadowOffsetX=g,t.shadowOffsetY=x)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{canvasAndContext:e,texture:s}=this.pages[t];je.returnCanvasAndContext(e),s.destroy(!0)}this.pages=null}};ua.defaultOptions={textureSize:512,style:new Oe,mipmap:!0};let Cn=ua;function Md(i,t,e,s){const r={width:0,height:0,offsetY:0,scale:t.fontSize/e.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};r.offsetY=e.baseLineOffset;let n=r.lines[0],o=null,a=!0;const l={width:0,start:0,index:0,positions:[],chars:[]},h=e.baseMeasurementFontSize/t.fontSize,c=t.letterSpacing*h,u=t.wordWrapWidth*h,d=t.lineHeight?t.lineHeight*h:e.lineHeight,f=t.wordWrap&&t.breakWords,p=g=>{const x=n.width;for(let _=0;_<l.index;_++){const b=g.positions[_];n.chars.push(g.chars[_]),n.charPositions.push(b+x)}n.width+=g.width,a=!1,l.width=0,l.index=0,l.chars.length=0},y=()=>{let g=n.chars.length-1;if(s){let x=n.chars[g];for(;x===" ";)n.width-=e.chars[x].xAdvance,x=n.chars[--g]}r.width=Math.max(r.width,n.width),n={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},a=!0,r.lines.push(n),r.height+=d},m=g=>g-c>u;for(let g=0;g<i.length+1;g++){let x;const _=g===i.length;_||(x=i[g]);const b=e.chars[x]||e.chars[" "];if(/(?:\s)/.test(x)||x==="\r"||x===`
`||_){if(!a&&t.wordWrap&&m(n.width+l.width)?(y(),p(l),_||n.charPositions.push(0)):(l.start=n.width,p(l),_||n.charPositions.push(0)),x==="\r"||x===`
`)y();else if(!_){const T=b.xAdvance+(b.kerning[o]||0)+c;n.width+=T,n.spaceWidth=T,n.spacesIndex.push(n.charPositions.length),n.chars.push(x)}}else{const w=b.kerning[o]||0,T=b.xAdvance+w+c;f&&m(n.width+l.width+T)&&(p(l),y()),l.positions[l.index++]=l.width+w,l.chars.push(x),l.width+=T}o=x}return y(),t.align==="center"?kd(r):t.align==="right"?Ed(r):t.align==="justify"&&Id(r),r}function kd(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width/2-e.width/2;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function Ed(i){for(let t=0;t<i.lines.length;t++){const e=i.lines[t],s=i.width-e.width;for(let r=0;r<e.charPositions.length;r++)e.charPositions[r]+=s}}function Id(i){const t=i.width;for(let e=0;e<i.lines.length;e++){const s=i.lines[e];let r=0,n=s.spacesIndex[r++],o=0;const a=s.spacesIndex.length,h=(t-s.width)/a;for(let c=0;c<s.charPositions.length;c++)c===n&&(n=s.spacesIndex[r++],o+=h),s.charPositions[c]+=o}}function Rd(i){if(i==="")return[];typeof i=="string"&&(i=[i]);const t=[];for(let e=0,s=i.length;e<s;e++){const r=i[e];if(Array.isArray(r)){if(r.length!==2)throw new Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);if(r[0].length===0||r[1].length===0)throw new Error("[BitmapFont]: Invalid character delimiter.");const n=r[0].charCodeAt(0),o=r[1].charCodeAt(0);if(o<n)throw new Error("[BitmapFont]: Invalid character range.");for(let a=n,l=o;a<=l;a++)t.push(String.fromCharCode(a))}else t.push(...Array.from(r))}if(t.length===0)throw new Error("[BitmapFont]: Empty set when resolving characters.");return t}let os=0;class Bd{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=qo(1e3)}getFont(t,e){let s=`${e.fontFamily}-bitmap`,r=!0;if(e._fill.fill&&!e._stroke?(s+=e._fill.fill.styleKey,r=!1):(e._stroke||e.dropShadow)&&(s=`${e.styleKey}-bitmap`,r=!1),!V.has(s)){const o=Object.create(e);o.lineHeight=0;const a=new Cn({style:o,overrideFill:r,overrideSize:!0,...this.defaultOptions});os++,os>50&&U("BitmapText",`You have dynamically created ${os} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),a.once("destroy",()=>{os--,V.remove(s)}),V.set(s,a)}const n=V.get(s);return n.ensureCharacters?.(t),n}getLayout(t,e,s=!0){const r=this.getFont(t,e),n=`${t}-${e.styleKey}-${s}`;if(this.measureCache.has(n))return this.measureCache.get(n);const o=wt.graphemeSegmenter(t),a=Md(o,e,r,s);return this.measureCache.set(n,a),a}measureText(t,e,s=!0){return this.getLayout(t,e,s)}install(...t){let e=t[0];typeof e=="string"&&(e={name:e,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},L(N,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));const s=e?.name;if(!s)throw new Error("[BitmapFontManager] Property `name` is required.");e={...this.defaultOptions,...e};const r=e.style,n=r instanceof Oe?r:new Oe(r),o=e.dynamicFill??this._canUseTintForStyle(n),a=new Cn({style:n,overrideFill:o,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),l=Rd(e.chars);return a.ensureCharacters(l.join("")),V.set(`${s}-bitmap`,a),a.once("destroy",()=>V.remove(`${s}-bitmap`)),a}uninstall(t){const e=`${t}-bitmap`,s=V.get(e);s&&s.destroy()}_canUseTintForStyle(t){return!t._stroke&&(!t.dropShadow||t.dropShadow.color===0)&&!t._fill.fill&&t._fill.color===16777215}}const Tn=new Bd;class fa extends Ho{constructor(t,e){super();const{textures:s,data:r}=t;Object.keys(r.pages).forEach(n=>{const o=r.pages[parseInt(n,10)],a=s[o.id];this.pages.push({texture:a})}),Object.keys(r.chars).forEach(n=>{const o=r.chars[n],{frame:a,source:l,rotate:h}=s[o.page],c=D.transformRectCoords(o,a,h,new H),u=new j({frame:c,orig:new H(0,0,o.width,o.height),source:l,rotate:h});this.chars[n]={id:n.codePointAt(0),xOffset:o.xOffset,yOffset:o.yOffset,xAdvance:o.xAdvance,kerning:o.kerning??{},texture:u}}),this.baseRenderedFontSize=r.fontSize,this.baseMeasurementFontSize=r.fontSize,this.fontMetrics={ascent:0,descent:0,fontSize:r.fontSize},this.baseLineOffset=r.baseLineOffset,this.lineHeight=r.lineHeight,this.fontFamily=r.fontFamily,this.distanceField=r.distanceField??{type:"none",range:0},this.url=e}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){const{texture:e}=this.pages[t];e.destroy(!0)}this.pages=null}static install(t){Tn.install(t)}static uninstall(t){Tn.uninstall(t)}}const ni={test(i){return typeof i=="string"&&i.startsWith("info face=")},parse(i){const t=i.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const d=t[u].match(/^[a-z]+/gm)[0],f=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const y in f){const m=f[y].split("="),g=m[0],x=m[1].replace(/"/gm,""),_=parseFloat(x),b=isNaN(_)?x:_;p[g]=b}e[d].push(p)}const s={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[r]=e.info,[n]=e.common,[o]=e.distanceField??[];o&&(s.distanceField={range:parseInt(o.distanceRange,10),type:o.fieldType}),s.fontSize=parseInt(r.size,10),s.fontFamily=r.face,s.lineHeight=parseInt(n.lineHeight,10);const a=e.page;for(let u=0;u<a.length;u++)s.pages.push({id:parseInt(a[u].id,10)||0,file:a[u].file});const l={};s.baseLineOffset=s.lineHeight-parseInt(n.base,10);const h=e.char;for(let u=0;u<h.length;u++){const d=h[u],f=parseInt(d.id,10);let p=d.letter??d.char??String.fromCharCode(f);p==="space"&&(p=" "),l[f]=p,s.chars[p]={id:f,page:parseInt(d.page,10)||0,x:parseInt(d.x,10),y:parseInt(d.y,10),width:parseInt(d.width,10),height:parseInt(d.height,10),xOffset:parseInt(d.xoffset,10),yOffset:parseInt(d.yoffset,10),xAdvance:parseInt(d.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const d=parseInt(c[u].first,10),f=parseInt(c[u].second,10),p=parseInt(c[u].amount,10);s.chars[l[f]].kerning[l[d]]=p}return s}},Mn={test(i){const t=i;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(i){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=i.getElementsByTagName("info")[0],s=i.getElementsByTagName("common")[0],r=i.getElementsByTagName("distanceField")[0];r&&(t.distanceField={type:r.getAttribute("fieldType"),range:parseInt(r.getAttribute("distanceRange"),10)});const n=i.getElementsByTagName("page"),o=i.getElementsByTagName("char"),a=i.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(s.getAttribute("lineHeight"),10);for(let h=0;h<n.length;h++)t.pages.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});const l={};t.baseLineOffset=t.lineHeight-parseInt(s.getAttribute("base"),10);for(let h=0;h<o.length;h++){const c=o[h],u=parseInt(c.getAttribute("id"),10);let d=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);d==="space"&&(d=" "),l[u]=d,t.chars[d]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<a.length;h++){const c=parseInt(a[h].getAttribute("first"),10),u=parseInt(a[h].getAttribute("second"),10),d=parseInt(a[h].getAttribute("amount"),10);t.chars[l[u]].kerning[l[c]]=d}return t}},kn={test(i){return typeof i=="string"&&i.match(/<font(\s|>)/)?Mn.test($.get().parseXML(i)):!1},parse(i){return Mn.parse($.get().parseXML(i))}},Ld=[".xml",".fnt"],Fd={extension:{type:I.CacheParser,name:"cacheBitmapFont"},test:i=>i instanceof fa,getCacheableAssets(i,t){const e={};return i.forEach(s=>{e[s]=t,e[`${s}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},Od={extension:{type:I.LoadParser,priority:Lt.Normal},name:"loadBitmapFont",id:"bitmap-font",test(i){return Ld.includes(ot.extname(i).toLowerCase())},async testParse(i){return ni.test(i)||kn.test(i)},async parse(i,t,e){const s=ni.test(i)?ni.parse(i):kn.parse(i),{src:r}=t,{pages:n}=s,o=[],a=s.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let u=0;u<n.length;++u){const d=n[u].file;let f=ot.join(ot.dirname(r),d);f=Ai(f,r),o.push({src:f,data:a})}const l=await e.load(o),h=o.map(u=>l[u.src]);return new fa({data:s,textures:h},r)},async load(i,t){return await(await $.get().fetch(i)).text()},async unload(i,t,e){await Promise.all(i.pages.map(s=>e.unload(s.texture.source._sourceOrigin))),i.destroy()}};class jd{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let s=0;s<e;s++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Gd={extension:{type:I.CacheParser,name:"cacheTextureArray"},test:i=>Array.isArray(i)&&i.every(t=>t instanceof j),getCacheableAssets:(i,t)=>{const e={};return i.forEach(s=>{t.forEach((r,n)=>{e[s+(n===0?"":n+1)]=r})}),e}};async function pa(i){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=i});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(i)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const zd={extension:{type:I.DetectionParser,priority:1},test:async()=>pa("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async i=>[...i,"avif"],remove:async i=>i.filter(t=>t!=="avif")},En=["png","jpg","jpeg"],Nd={extension:{type:I.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async i=>[...i,...En],remove:async i=>i.filter(t=>!En.includes(t))},Dd="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function Rs(i){return Dd?!1:document.createElement("video").canPlayType(i)!==""}const Wd={extension:{type:I.DetectionParser,priority:0},test:async()=>Rs("video/mp4"),add:async i=>[...i,"mp4","m4v"],remove:async i=>i.filter(t=>t!=="mp4"&&t!=="m4v")},$d={extension:{type:I.DetectionParser,priority:0},test:async()=>Rs("video/ogg"),add:async i=>[...i,"ogv"],remove:async i=>i.filter(t=>t!=="ogv")},Vd={extension:{type:I.DetectionParser,priority:0},test:async()=>Rs("video/webm"),add:async i=>[...i,"webm"],remove:async i=>i.filter(t=>t!=="webm")},Ud={extension:{type:I.DetectionParser,priority:0},test:async()=>pa("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async i=>[...i,"webp"],remove:async i=>i.filter(t=>t!=="webp")},ma=class ys{constructor(){this.loadOptions={...ys.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,s)=>(this._parsersValidated=!1,t[e]=s,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const s={promise:null,parser:null};return s.promise=(async()=>{let r=null,n=null;if((e.parser||e.loadParser)&&(n=this._parserHash[e.parser||e.loadParser],e.loadParser&&U(`[Assets] "loadParser" is deprecated, use "parser" instead for ${t}`),n||U(`[Assets] specified load parser "${e.parser||e.loadParser}" not found while loading ${t}`)),!n){for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];if(a.load&&a.test?.(t,e,this)){n=a;break}}if(!n)return U(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}r=await n.load(t,e,this),s.parser=n;for(let o=0;o<this.parsers.length;o++){const a=this.parsers[o];a.parse&&a.parse&&await a.testParse?.(r,e,this)&&(r=await a.parse(r,e,this)||r,s.parser=a)}return r})(),s}async load(t,e){this._parsersValidated||this._validateParsers();const s=typeof e=="function"?{...ys.defaultOptions,...this.loadOptions,onProgress:e}:{...ys.defaultOptions,...this.loadOptions,...e||{}},{onProgress:r,onError:n,strategy:o,retryCount:a,retryDelay:l}=s;let h=0;const c={},u=As(t),d=dt(t,y=>({alias:[y],src:y,data:{}})),f=d.reduce((y,m)=>y+(m.progressSize||1),0),p=d.map(async y=>{const m=ot.toAbsolute(y.src);c[y.src]||(await this._loadAssetWithRetry(m,y,{onProgress:r,onError:n,strategy:o,retryCount:a,retryDelay:l},c),h+=y.progressSize||1,r&&r(h/f))});return await Promise.all(p),u?c[d[0].src]:c}async unload(t){const s=dt(t,r=>({alias:[r],src:r})).map(async r=>{const n=ot.toAbsolute(r.src),o=this.promiseCache[n];if(o){const a=await o.promise;delete this.promiseCache[n],await o.parser?.unload?.(a,r,this)}});await Promise.all(s)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name||t.id).reduce((t,e)=>(!e.name&&!e.id?U("[Assets] parser should have an id"):(t[e.name]||t[e.id])&&U(`[Assets] parser id conflict "${e.id}"`),t[e.name]=e,e.id&&(t[e.id]=e),t),{})}async _loadAssetWithRetry(t,e,s,r){let n=0;const{onError:o,strategy:a,retryCount:l,retryDelay:h}=s,c=u=>new Promise(d=>setTimeout(d,u));for(;;)try{this.promiseCache[t]||(this.promiseCache[t]=this._getLoadPromiseAndParser(t,e)),r[e.src]=await this.promiseCache[t].promise;return}catch(u){delete this.promiseCache[t],delete r[e.src],n++;const d=a!=="retry"||n>l;if(a==="retry"&&!d){o&&o(u,e),await c(h);continue}if(a==="skip"){o&&o(u,e);return}throw o&&o(u,e),new Error(`[Loader.load] Failed to load ${t}.
${u}`)}}};ma.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let Hd=ma;function ae(i,t){if(Array.isArray(t)){for(const e of t)if(i.startsWith(`data:${e}`))return!0;return!1}return i.startsWith(`data:${t}`)}function le(i,t){const e=i.split("?")[0],s=ot.extname(e).toLowerCase();return Array.isArray(t)?t.includes(s):s===t}const qd=".json",Yd="application/json",Xd={extension:{type:I.LoadParser,priority:Lt.Low},name:"loadJson",id:"json",test(i){return ae(i,Yd)||le(i,qd)},async load(i){return await(await $.get().fetch(i)).json()}},Kd=".txt",Jd="text/plain",Zd={name:"loadTxt",id:"text",extension:{type:I.LoadParser,priority:Lt.Low,name:"loadTxt"},test(i){return ae(i,Jd)||le(i,Kd)},async load(i){return await(await $.get().fetch(i)).text()}},Qd=["normal","bold","100","200","300","400","500","600","700","800","900"],tf=[".ttf",".otf",".woff",".woff2"],ef=["font/ttf","font/otf","font/woff","font/woff2"],sf=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function rf(i){const t=ot.extname(i),r=ot.basename(i,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(a=>a.charAt(0).toUpperCase()+a.slice(1));let n=r.length>0;for(const a of r)if(!a.match(sf)){n=!1;break}let o=r.join(" ");return n||(o=`"${o.replace(/[\\"]/g,"\\$&")}"`),o}const nf=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function of(i){return nf.test(i)?i:encodeURI(i)}const af={extension:{type:I.LoadParser,priority:Lt.Low},name:"loadWebFont",id:"web-font",test(i){return ae(i,ef)||le(i,tf)},async load(i,t){const e=$.get().getFontFaceSet();if(e){const s=[],r=t.data?.family??rf(i),n=t.data?.weights?.filter(a=>Qd.includes(a))??["normal"],o=t.data??{};for(let a=0;a<n.length;a++){const l=n[a],h=new FontFace(r,`url(${of(i)})`,{...o,weight:l});await h.load(),e.add(h),s.push(h)}return V.has(`${r}-and-url`)?V.get(`${r}-and-url`).entries.push({url:i,faces:s}):V.set(`${r}-and-url`,{entries:[{url:i,faces:s}]}),s.length===1?s[0]:s}return U("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(i){const t=Array.isArray(i)?i:[i],e=t[0].family,s=V.get(`${e}-and-url`),r=s.entries.find(n=>n.faces.some(o=>t.indexOf(o)!==-1));r.faces=r.faces.filter(n=>t.indexOf(n)===-1),r.faces.length===0&&(s.entries=s.entries.filter(n=>n!==r)),t.forEach(n=>{$.get().getFontFaceSet().delete(n)}),s.entries.length===0&&V.remove(`${e}-and-url`)}};function Zi(i,t=1){const e=oe.RETINA_PREFIX?.exec(i);return e?parseFloat(e[1]):t}function Qi(i,t,e){i.label=e,i._sourceOrigin=e;const s=new j({source:i,label:e}),r=()=>{delete t.promiseCache[e],V.has(e)&&V.remove(e)};return s.source.once("destroy",()=>{t.promiseCache[e]&&(U("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),r())}),s.once("destroy",()=>{i.destroyed||(U("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),r())}),s}const lf=".svg",hf="image/svg+xml",cf={extension:{type:I.LoadParser,priority:Lt.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(i){return ae(i,hf)||le(i,lf)},async load(i,t,e){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?df(i):uf(i,t,e,this.config.crossOrigin)},unload(i){i.destroy(!0)}};async function uf(i,t,e,s){const r=await $.get().fetch(i),n=$.get().createImage();n.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await r.text())}`,n.crossOrigin=s,await n.decode();const o=t.data?.width??n.width,a=t.data?.height??n.height,l=t.data?.resolution||Zi(i),h=Math.ceil(o*l),c=Math.ceil(a*l),u=$.get().createCanvas(h,c),d=u.getContext("2d");d.imageSmoothingEnabled=!0,d.imageSmoothingQuality="high",d.drawImage(n,0,0,o*l,a*l);const{parseAsGraphicsContext:f,...p}=t.data??{},y=new qt({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:l,...p});return Qi(y,e,i)}async function df(i){const e=await(await $.get().fetch(i)).text(),s=new at;return s.svg(e),s}const ff=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function")
          return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let te=null,Li=class{constructor(){te||(te=URL.createObjectURL(new Blob([ff],{type:"application/javascript"}))),this.worker=new Worker(te)}};Li.revokeObjectURL=function(){te&&(URL.revokeObjectURL(te),te=null)};const pf=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let ee=null;class ga{constructor(){ee||(ee=URL.createObjectURL(new Blob([pf],{type:"application/javascript"}))),this.worker=new Worker(ee)}}ga.revokeObjectURL=function(){ee&&(URL.revokeObjectURL(ee),ee=null)};let In=0,oi;class mf{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new Li;e.addEventListener("message",s=>{e.terminate(),Li.revokeObjectURL(),t(s.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){return this._run("loadImageBitmap",[t,e?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){oi===void 0&&(oi=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<oi&&(this._createdWorkers++,t=new ga().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){this._resolveHash[t.uuid]&&(t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),delete this._resolveHash[t.uuid])}async _run(t,e){await this._initWorkers();const s=new Promise((r,n)=>{this._queue.push({id:t,arguments:e,resolve:r,reject:n})});return this._next(),s}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),s=e.id;this._resolveHash[In]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:In++,id:s})}reset(){this._workerPool.forEach(t=>t.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:t})=>{t?.(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const Rn=new mf,gf=[".jpeg",".jpg",".png",".webp",".avif"],yf=["image/jpeg","image/png","image/webp","image/avif"];async function xf(i,t){const e=await $.get().fetch(i);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${i}: ${e.status} ${e.statusText}`);const s=await e.blob();return t?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(s,{premultiplyAlpha:"none"}):createImageBitmap(s)}const ya={name:"loadTextures",id:"texture",extension:{type:I.LoadParser,priority:Lt.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(i){return ae(i,yf)||le(i,gf)},async load(i,t,e){let s=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Rn.isImageBitmapSupported()?s=await Rn.loadImageBitmap(i,t):s=await xf(i,t):s=await new Promise((n,o)=>{s=$.get().createImage(),s.crossOrigin=this.config.crossOrigin,s.src=i,s.complete?n(s):(s.onload=()=>{n(s)},s.onerror=o)});const r=new qt({resource:s,alphaMode:"premultiply-alpha-on-upload",resolution:t.data?.resolution||Zi(i),...t.data});return Qi(r,e,i)},unload(i){i.destroy(!0)}},_f=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let ai,li;function bf(i,t,e){e===void 0&&!t.startsWith("data:")?i.crossOrigin=vf(t):e!==!1&&(i.crossOrigin=typeof e=="string"?e:"anonymous")}function wf(i){return new Promise((t,e)=>{i.addEventListener("canplaythrough",s),i.addEventListener("error",r),i.load();function s(){n(),t()}function r(o){n(),e(o)}function n(){i.removeEventListener("canplaythrough",s),i.removeEventListener("error",r)}})}function vf(i,t=globalThis.location){if(i.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(i,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function Af(){const i=[],t=[];for(const e of _f){const s=Ce.MIME_TYPES[e.substring(1)]||`video/${e.substring(1)}`;Rs(s)&&(i.push(e),t.includes(s)||t.push(s))}return{validVideoExtensions:i,validVideoMime:t}}const Sf={name:"loadVideo",id:"video",extension:{type:I.LoadParser,name:"loadVideo"},test(i){if(!ai||!li){const{validVideoExtensions:s,validVideoMime:r}=Af();ai=s,li=r}const t=ae(i,li),e=le(i,ai);return t||e},async load(i,t,e){const s={...Ce.defaultOptions,resolution:t.data?.resolution||Zi(i),alphaMode:t.data?.alphaMode||await vo(),...t.data},r=document.createElement("video"),n={preload:s.autoLoad!==!1?"auto":void 0,"webkit-playsinline":s.playsinline!==!1?"":void 0,playsinline:s.playsinline!==!1?"":void 0,muted:s.muted===!0?"":void 0,loop:s.loop===!0?"":void 0,autoplay:s.autoPlay!==!1?"":void 0};Object.keys(n).forEach(l=>{const h=n[l];h!==void 0&&r.setAttribute(l,h)}),s.muted===!0&&(r.muted=!0),bf(r,i,s.crossorigin);const o=document.createElement("source");let a;if(s.mime)a=s.mime;else if(i.startsWith("data:"))a=i.slice(5,i.indexOf(";"));else if(!i.startsWith("blob:")){const l=i.split("?")[0].slice(i.lastIndexOf(".")+1).toLowerCase();a=Ce.MIME_TYPES[l]||`video/${l}`}return o.src=i,a&&(o.type=a),new Promise(l=>{const h=async()=>{const c=new Ce({...s,resource:r});r.removeEventListener("canplay",h),t.data.preload&&await wf(r),l(Qi(c,e,i))};s.preload&&!s.autoPlay&&r.load(),r.addEventListener("canplay",h),r.appendChild(o)})},unload(i){i.destroy(!0)}},xa={extension:{type:I.ResolveParser,name:"resolveTexture"},test:ya.test,parse:i=>({resolution:parseFloat(oe.RETINA_PREFIX.exec(i)?.[1]??"1"),format:i.split(".").pop(),src:i})},Pf={extension:{type:I.ResolveParser,priority:-2,name:"resolveJson"},test:i=>oe.RETINA_PREFIX.test(i)&&i.endsWith(".json"),parse:xa.parse};class Cf{constructor(){this._detections=[],this._initialized=!1,this.resolver=new oe,this.loader=new Hd,this.cache=V,this._backgroundLoader=new jd(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){U("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let n=t.manifest;typeof n=="string"&&(n=await this.load(n)),this.resolver.addManifest(n)}const e=t.texturePreference?.resolution??1,s=typeof e=="number"?[e]:e,r=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:r,resolution:s}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const s=As(t),r=dt(t).map(a=>{if(typeof a!="string"){const l=this.resolver.getAlias(a);return l.some(h=>!this.resolver.hasKey(h))&&this.add(a),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(a)||this.add({alias:a,src:a}),a}),n=this.resolver.resolve(r),o=await this._mapLoadToResolve(n,e);return s?o[r[0]]:o}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let s=!1;typeof t=="string"&&(s=!0,t=[t]);const r=this.resolver.resolveBundle(t),n={},o=Object.keys(r);let a=0;const l=[],h=()=>{e?.(l.reduce((u,d)=>u+d,0)/a)},c=o.map((u,d)=>{const f=r[u],p=Object.values(f),m=[...new Set(p.flat())].reduce((g,x)=>g+(x.progressSize||1),0);return l.push(0),a+=m,this._mapLoadToResolve(f,g=>{l[d]=g*m,h()}).then(g=>{n[u]=g})});return await Promise.all(c),s?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(s=>{this._backgroundLoader.add(Object.values(s))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return V.get(t);const e={};for(let s=0;s<t.length;s++)e[s]=V.get(t[s]);return e}async _mapLoadToResolve(t,e){const s=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const r=await this.loader.load(s,e);this._backgroundLoader.active=!0;const n={};return s.forEach(o=>{const a=r[o.src],l=[o.src];o.alias&&l.push(...o.alias),l.forEach(h=>{n[h]=a}),V.set(l,a)}),n}async unload(t){this._initialized||await this.init();const e=dt(t).map(r=>typeof r!="string"?r.src:r),s=this.resolver.resolve(e);await this._unloadFromResolved(s)}async unloadBundle(t){this._initialized||await this.init(),t=dt(t);const e=this.resolver.resolveBundle(t),s=Object.keys(e).map(r=>this._unloadFromResolved(e[r]));await Promise.all(s)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(s=>{V.remove(s.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const s of t.detections)t.skipDetections||await s.test()?e=await s.add(e):t.skipDetections||(e=await s.remove(e));return e=e.filter((s,r)=>e.indexOf(s)===r),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(s=>s in t).forEach(s=>{e.config[s]=t[s]})})}}const Qt=new Cf;Q.handleByList(I.LoadParser,Qt.loader.parsers).handleByList(I.ResolveParser,Qt.resolver.parsers).handleByList(I.CacheParser,Qt.cache.parsers).handleByList(I.DetectionParser,Qt.detections);Q.add(Gd,Nd,zd,Ud,Wd,$d,Vd,Xd,Zd,af,cf,ya,Sf,Od,Fd,xa,Pf);const Bn={loader:I.LoadParser,resolver:I.ResolveParser,cache:I.CacheParser,detection:I.DetectionParser};Q.handle(I.Asset,i=>{const t=i.ref;Object.entries(Bn).filter(([e])=>!!t[e]).forEach(([e,s])=>Q.add(Object.assign(t[e],{extension:t[e].extension??s})))},i=>{const t=i.ref;Object.keys(Bn).filter(e=>!!t[e]).forEach(e=>Q.remove(t[e]))});class Xt extends Di{constructor(t){t instanceof at&&(t={context:t});const{context:e,roundPixels:s,...r}=t||{};super({label:"Graphics",...r}),this.renderPipeId="graphics",e?this._context=e:this._context=this._ownedContext=new at,this._context.on("update",this.onViewUpdate,this),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=s??!1}set context(t){t!==this._context&&(this._context.off("update",this.onViewUpdate,this),this._context=t,this._context.on("update",this.onViewUpdate,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||t?.context===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Xt(this._context.clone()):(this._ownedContext=null,new Xt(this._context))}lineStyle(t,e,s){L(N,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const r={};return t&&(r.width=t),e&&(r.color=e),s&&(r.alpha=s),this.context.strokeStyle=r,this}beginFill(t,e){L(N,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const s={};return t!==void 0&&(s.color=t),e!==void 0&&(s.alpha=e),this.context.fillStyle=s,this}endFill(){L(N,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==at.defaultStrokeStyle.width||t.color!==at.defaultStrokeStyle.color||t.alpha!==at.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return L(N,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return L(N,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return L(N,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return L(N,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return L(N,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return L(N,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Tf extends Di{constructor(t,e){const{text:s,resolution:r,style:n,anchor:o,width:a,height:l,roundPixels:h,...c}=t;super({...c}),this.batched=!0,this._resolution=null,this._autoResolution=!0,this._didTextUpdate=!0,this._styleClass=e,this.text=s??"",this.style=n,this.resolution=r??null,this.allowChildren=!1,this._anchor=new Z({_onUpdate:()=>{this.onViewUpdate()}}),o&&(this.anchor=o),this.roundPixels=h??!1,a!==void 0&&(this.width=a),l!==void 0&&(this.height=l)}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}set text(t){t=t.toString(),this._text!==t&&(this._text=t,this.onViewUpdate())}get text(){return this._text}set resolution(t){this._autoResolution=t===null,this._resolution=t,this.onViewUpdate()}get resolution(){return this._resolution}get style(){return this._style}set style(t){t||(t={}),this._style?.off("update",this.onViewUpdate,this),t instanceof this._styleClass?this._style=t:this._style=new this._styleClass(t),this._style.on("update",this.onViewUpdate,this),this.onViewUpdate()}get width(){return Math.abs(this.scale.x)*this.bounds.width}set width(t){this._setWidth(t,this.bounds.width)}get height(){return Math.abs(this.scale.y)*this.bounds.height}set height(t){this._setHeight(t,this.bounds.height)}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this.bounds.width,t.height=Math.abs(this.scale.y)*this.bounds.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this.bounds.width),e!==void 0&&this._setHeight(e,this.bounds.height)}containsPoint(t){const e=this.bounds.width,s=this.bounds.height,r=-e*this.anchor.x;let n=0;return t.x>=r&&t.x<=r+e&&(n=-s*this.anchor.y,t.y>=n&&t.y<=n+s)}onViewUpdate(){this.didViewUpdate||(this._didTextUpdate=!0),super.onViewUpdate()}destroy(t=!1){super.destroy(t),this.owner=null,this._bounds=null,this._anchor=null,(typeof t=="boolean"?t:t?.style)&&this._style.destroy(t),this._style=null,this._text=null}get styleKey(){return`${this._text}:${this._style.styleKey}:${this._resolution}`}}function Mf(i,t){let e=i[0]??{};return(typeof e=="string"||i[1])&&(L(N,`use new ${t}({ text: "hi!", style }) instead`),e={text:e,style:i[1]}),e}let Nt=null,At=null;function kf(i,t){Nt||(Nt=$.get().createCanvas(256,128),At=Nt.getContext("2d",{willReadFrequently:!0}),At.globalCompositeOperation="copy",At.globalAlpha=1),(Nt.width<i||Nt.height<t)&&(Nt.width=se(i),Nt.height=se(t))}function Ln(i,t,e){for(let s=0,r=4*e*t;s<t;++s,r+=4)if(i[r+3]!==0)return!1;return!0}function Fn(i,t,e,s,r){const n=4*t;for(let o=s,a=s*n+4*e;o<=r;++o,a+=n)if(i[a+3]!==0)return!1;return!0}function Ef(...i){let t=i[0];t.canvas||(t={canvas:i[0],resolution:i[1]});const{canvas:e}=t,s=Math.min(t.resolution??1,1),r=t.width??e.width,n=t.height??e.height;let o=t.output;if(kf(r,n),!At)throw new TypeError("Failed to get canvas 2D context");At.drawImage(e,0,0,r,n,0,0,r*s,n*s);const l=At.getImageData(0,0,r,n).data;let h=0,c=0,u=r-1,d=n-1;for(;c<n&&Ln(l,r,c);)++c;if(c===n)return H.EMPTY;for(;Ln(l,r,d);)--d;for(;Fn(l,r,h,c,d);)++h;for(;Fn(l,r,u,c,d);)--u;return++u,++d,At.globalCompositeOperation="source-over",At.strokeRect(h,c,u-h,d-c),At.globalCompositeOperation="copy",o??(o=new H),o.set(h/s,c/s,(u-h)/s,(d-c)/s),o}const On=new H;class If{getCanvasAndContext(t){const{text:e,style:s,resolution:r=1}=t,n=s._getFinalPadding(),o=wt.measureText(e||" ",s),a=Math.ceil(Math.ceil(Math.max(1,o.width)+n*2)*r),l=Math.ceil(Math.ceil(Math.max(1,o.height)+n*2)*r),h=je.getOptimalCanvasAndContext(a,l);this._renderTextToCanvas(e,s,n,r,h);const c=s.trim?Ef({canvas:h.canvas,width:a,height:l,resolution:1,output:On}):On.set(0,0,a,l);return{canvasAndContext:h,frame:c}}returnCanvasAndContext(t){je.returnCanvasAndContext(t)}_renderTextToCanvas(t,e,s,r,n){const{canvas:o,context:a}=n,l=Ss(e),h=wt.measureText(t||" ",e),c=h.lines,u=h.lineHeight,d=h.lineWidths,f=h.maxLineWidth,p=h.fontProperties,y=o.height;if(a.resetTransform(),a.scale(r,r),a.textBaseline=e.textBaseline,e._stroke?.width){const _=e._stroke;a.lineWidth=_.width,a.miterLimit=_.miterLimit,a.lineJoin=_.join,a.lineCap=_.cap}a.font=l;let m,g;const x=e.dropShadow?2:1;for(let _=0;_<x;++_){const b=e.dropShadow&&_===0,A=b?Math.ceil(Math.max(1,y)+s*2):0,v=A*r;if(b){a.fillStyle="black",a.strokeStyle="black";const P=e.dropShadow,S=P.color,M=P.alpha;a.shadowColor=K.shared.setValue(S).setAlpha(M).toRgbaString();const B=P.blur*r,F=P.distance*r;a.shadowBlur=B,a.shadowOffsetX=Math.cos(P.angle)*F,a.shadowOffsetY=Math.sin(P.angle)*F+v}else{if(a.fillStyle=e._fill?Ts(e._fill,a,h,s*2):null,e._stroke?.width){const P=e._stroke.width*.5+s*2;a.strokeStyle=Ts(e._stroke,a,h,P)}a.shadowColor="black"}let w=(u-p.fontSize)/2;u-p.fontSize<0&&(w=0);const T=e._stroke?.width??0;for(let P=0;P<c.length;P++)m=T/2,g=T/2+P*u+p.ascent+w,e.align==="right"?m+=f-d[P]:e.align==="center"&&(m+=(f-d[P])/2),e._stroke?.width&&this._drawLetterSpacing(c[P],e,n,m+s,g+s-A,!0),e._fill!==void 0&&this._drawLetterSpacing(c[P],e,n,m+s,g+s-A)}}_drawLetterSpacing(t,e,s,r,n,o=!1){const{context:a}=s,l=e.letterSpacing;let h=!1;if(wt.experimentalLetterSpacingSupported&&(wt.experimentalLetterSpacing?(a.letterSpacing=`${l}px`,a.textLetterSpacing=`${l}px`,h=!0):(a.letterSpacing="0px",a.textLetterSpacing="0px")),l===0||h){o?a.strokeText(t,r,n):a.fillText(t,r,n);return}let c=r;const u=wt.graphemeSegmenter(t);let d=a.measureText(t).width,f=0;for(let p=0;p<u.length;++p){const y=u[p];o?a.strokeText(y,c,n):a.fillText(y,c,n);let m="";for(let g=p+1;g<u.length;++g)m+=u[g];f=a.measureText(m).width,c+=d-f+l,d=f}}}const jn=new If;class Ee extends Tf{constructor(...t){const e=Mf(t,"Text");super(e,Oe),this.renderPipeId="text",e.textureStyle&&(this.textureStyle=e.textureStyle instanceof ie?e.textureStyle:new ie(e.textureStyle))}updateBounds(){const t=this._bounds,e=this._anchor;let s=0,r=0;if(this._style.trim){const{frame:n,canvasAndContext:o}=jn.getCanvasAndContext({text:this.text,style:this._style,resolution:1});jn.returnCanvasAndContext(o),s=n.width,r=n.height}else{const n=wt.measureText(this._text,this._style);s=n.width,r=n.height}t.minX=-e._x*s,t.maxX=t.minX+s,t.minY=-e._y*r,t.maxY=t.minY+r}}Q.add(jl,Gl);const Rf={Space:"space"};class Bf{constructor(){this.keys={space:{pressed:!1,doubleTap:!1,timestamp:0}},window.addEventListener("keydown",t=>this.keydownHandler(t))}keydownHandler(t){const e=Rf[t.code];e&&(this.keys[e].pressed=!0)}}var Lf=(function(i){const t={name:"{coin-task}",version:"1.0.0",parameters:{velocity:{type:i.ParameterType.INT,default:5}},data:{data1:{type:C.FLOAT},data2:{type:C.STRING}}};class e{constructor(r){this.jsPsych=r}trial(r,n){var o=0,a=0,l=[];const h=new Vi,c=new Bf;h.init({resizeTo:window}).then(()=>{r.appendChild(h.canvas)});const u=["/images/bg001.png","/images/chest.png","/images/Coin.png","/images/magnet_rotated.png"];Qt.load(u).then(d=>{const f=d["/images/bg001.png"],p=d["/images/chest.png"],y=d["/images/Coin.png"],m=d["/images/magnet_rotated.png"],g=new pt(f),x=new pt(p),_=new pt(y),b=new pt(m);g.width=h.screen.width,g.height=h.screen.height,g.x=0,g.y=0;const A=g.height-.08*g.height,v=new Xt().moveTo(0,.08*g.height).lineTo(g.width,.08*g.height).stroke({color:0}),w=new Ee({text:"Victory :)"}),T=new Ee({text:"Failure :/"});x.scale.set(.5,.5),x.x=.65*g.width,x.y=A-x.height,b.scale.set(1,1),b.x=v.bounds.minX,b.y=v.bounds.maxY,_.scale.set(.05,.05),_.x=b.x+.8*b.width,_.y=b.y+b.height,w.x=h.screen.width/2,w.y=h.screen.height/2,T.x=h.screen.width/2,T.y=h.screen.height/2,h.stage.addChild(g,x,v,b,_),console.log("All assets loaded and added to stage."),console.log("Animation starts from here on!"),h.ticker.add(S=>{if(c.keys.space.pressed==!0){if(l.push(x.x-_.x),_.y+_.height>=A)_.y=A-_.height,_.x-=n.velocity*S.deltaTime,a==1?h.stage.addChild(w):h.stage.addChild(T);else{const B=new Xt().moveTo(_.x,_.y).lineTo(_.x+3,_.y+3).stroke({color:0});o+=S.elapsedMS,_.y+=n.velocity*o*o/6e5,h.stage.addChild(B)}_.x>=x.x&&_.x+_.width<=x.x+x.width&&_.y>=x.y&&_.y<A-_.height&&(a=1)}console.log(`press position: ${l[0]}`),_.x+=n.velocity*S.deltaTime,b.x+=n.velocity*S.deltaTime,b.x>h.screen.width&&(h.ticker.stop(),h.destroy(!0,!0),P())});const P=()=>{var S={data1:l[0],data2:"hello world!"};r.innerHTML="",this.jsPsych.finishTrial(S)}})}}return e.info=t,e})(jsPsychModule),Ff=(function(i){const t={name:"{response-task}",version:"1.0.0",parameters:{jump_position:{type:i.ParameterType.INT,default:void 0}},data:{data1:{type:C.FLOAT},data2:{type:C.STRING}}};class e{constructor(r){this.jsPsych=r}trial(r,n){function o(h,c,u){const d=new Xt,f=100,p=40;d.roundRect(0,0,f,p,10).fill(6737151);const g=new Ee({text:u,style:{fill:"#ffffff",fontSize:14,fontWeight:"bold"}});return g.anchor.set(.5),g.x=f/2,g.y=p/2,d.addChild(g),d.x=h,d.y=c,d.eventMode="static",d.cursor="pointer",d}const a=new Vi;a.init({background:"ffffff",resizeTo:window}).then(()=>{r.appendChild(a.canvas)});const l=["/images/Bus.png","/images/Jumping_down.png"];Qt.load(l).then(h=>{const c=h["/images/Bus.png"],u=h["/images/Jumping_down.png"],d=new pt(c),f=new pt(u),p=a.screen.height,y=a.screen.width;d.scale.set(.47,.55),f.scale.set(.2,.2),d.x=y/2-d.width/2,d.y=p/2-d.height/2,n.jump_position==1?f.x=d.x+.05*d.width:n.jump_position==2?f.x=d.x+.25*d.width:n.jump_position==3?f.x=d.x+.35*d.width:n.jump_position==4&&(f.x=d.x+.65*d.width),f.y=d.y,a.stage.addChild(d),a.stage.addChild(f);const m=new Xt().rect(f.x+f.width/2,f.y+f.height,5,5).fill({color:16771584,alpha:1});a.stage.addChild(m);var g=f.x-d.x;console.log(`Jumper Position rel to Bus before keypress: ${g}`),console.log(typeof g);const x=new Ee({text:"Drcken Sie die rechte Pfeiltaste, um sich nach rechts zu bewegen.-->",style:{fontSize:11,fontStyle:"italic"}});x.anchor.set(.5,.5);const _=new Ee({text:"<--Drcken Sie die linke Pfeiltaste, um sich nach links zu bewegen.",style:{fontSize:11,fontStyle:"italic"}});_.anchor.set(.5,.5),x.x=d.x+d.width,x.y=100,a.stage.addChild(x),_.x=d.x,_.y=100,a.stage.addChild(_),window.addEventListener("keyup",function(w){switch(w.key){case"ArrowRight":{f.x+=10,g+=10,console.log(`Jumper Position rel to Bus: ${g}`);break}case"ArrowLeft":{f.x-=10,g-=10,console.log(`Jumper Position rel to Bus: ${g}`);break}}});const b=o((a.screen.width-120)/2,d.y+d.height+40,"Einreichen");a.stage.addChild(b),b.on("pointerdown",A);function A(){console.log("Submit Button clicked!"),a.destroy(!0,!0),v(g)}const v=w=>{var T={data1:w,data2:"hello world!"};r.innerHTML="",this.jsPsych.finishTrial(T)}})}}return e.info=t,e})(jsPsychModule);const Ge=Sl({on_finish:function(){Ge.data.displayData()},default_iti:500});var Tt=[],_a=Math.random(),Of={type:ws,stimulus:"Willkommen zum Experiment. Drcken Sie eine beliebige Taste, um zu beginnen.",post_trial_gap:500};Tt.push(Of);var jf={type:Ht,stimulus:`<p><strong>Inhalt des Experiments:</strong></p> 

      <p> Willkommen zu unserem Experiment ber intuitive Physik. 
      Wir danken Ihnen fr Ihr Interesse und Ihre Bereitschaft, an unserer Studie 
      teilzunehmen. </p>

      <p>Nehmen Sie nur an der Studie teil, wenn Sie mindestens 18 Jahre alt sind und 
      flieende Deutschkenntnisse besitzen.</p>

      <p>Bitte machen Sie nur weiter, wenn Sie an einem <strong>Laptop</strong> oder <strong>Computer</strong> teilnehmen.</p>

      <p>Beantworten Sie die folgenden Fragen bitte in einem Durchgang und versuchen Sie 
      dies in einer ruhigen, ungestrten Umgebung zu tun. 
      Das Experiment dauert etwa 15 Minuten und wird bei einer Teilnahme ber SONA 
      mit 0,25 CP vergtet.</p>

      <p>Bitte sprechen Sie nicht mit anderen ber das Experiment oder die Ihnen 
      gezeigte Aufgabe.</p>

      <p>Drcken Sie eine beliebige Taste, um fortzufahren.</p>
      `,choices:["Weiter"],post_trial_gap:500};Tt.push(jf);var Gf={type:Ht,stimulus:`<p><strong>Datenschutz:</strong></p> 
      <p><strong>Freiwilligkeit & Rcktritt</strong></p>
      <p>Die Teilnahme ist freiwillig. 
      Sie knnen Ihre Teilnahme jederzeit und ohne Angabe von Grnden beenden, 
      ohne dass Ihnen daraus Nachteile entstehen. Bereits erhobene Daten werden in 
      diesem Fall nicht weiterverwendet. Eine Lschung der Daten nach Zustimmung und 
      Durchfhrung des Experiments ist aufgrund der anonymen Erhebung nicht mglich.</p>

        <p><strong>Datenschutz</strong> </p> 
      <p> Ihre Angaben werden streng vertraulich behandelt. 
      Die Daten werden ausschlielich in anonymisierter Form gespeichert und ausgewertet, 
      sodass kein Rckschluss auf Ihre Person mglich ist. Nur die Studienleitung hat 
      Zugriff auf die Rohdaten. </p>

        <p><strong>Ablauf und Dauer</strong> </p>
        <p>Die Beantwortung des Fragebogens dauert ca. 15 Minuten. 
        Bitte bearbeiten Sie das folgende Experiment am Stck und achten Sie auf eine 
        Vermeidung von ueren Ablenkungen.</p>

      <p>Indem Sie auf weiter klicken, stimmen Sie der Datenschutzerklrung zu.</p>
      `,choices:["Weiter"],post_trial_gap:500};Tt.push(Gf);var Gn={type:Ht,stimulus:`<p><strong>Anweisungen</strong></p> 

      <p>Im nchsten Schritt sehen Sie vier leicht unterschiedliche Bilder. </p>

      <p>Zu Beginn sehen Sie ein statisches Bild einer Person, die auf dem Bus steht. 
      Bitte versuchen Sie, sich in die gegebene Position und Situation der Person auf dem 
      Bildschirm zu versetzen. </p>

      <p>Die Person, die auf dem Bus steht, springt senkrecht, circa 30 cm in die Hhe 
      (30 cm = circa die Lnge von Ellenbogen bis Fingerspitzen), whrend der Bus mit einer
       konstanten Geschwindigkeit von 30 km/h fhrt. </p>

      <p><strong>Bitte ignorieren Sie den Luftwiderstand</strong>  und versuchen Sie, die 
      folgende Frage richtig zu beantworten. </p>

      <p>Wo werden Sie nach dem Sprung auf dem<strong> Dach des Busses</strong> landen? 
      Schtzen Sie Ihre Landeposition in Bezug auf den <strong>Bus</strong> ein

      <p><i>Bitte benutzen Sie den Schieberegler, um Ihre Antwort zu geben, indem Sie die 
      springende Person an die Stelle bewegen, an der Sie <strong>nach</strong> dem 
      Sprung landen wrden, also Ihre geschtzte Landeposition.</i></p>
      
      <p>Das Einzige, was sich bei den verschiedenen Versuchen ndert, ist Ihre 
      Startposition auf dem Bus bevor Sie abspringen. <i>Zwischen den einzelnen Versuchen 
      wird ein schwarzer Bildschirm eingeblendet.</i> </p>     
      `,choices:["Weiter"],post_trial_gap:500},zf={type:ws,stimulus:'<div style="font-size:60px;">+</div>',choices:"NO_KEYS",trial_duration:750,data:{task:"fixation"}},zn={timeline:[{type:fi,stimulus:Ge.timelineVariable("img"),stimulus_width:763,data:{task:"presentation"},choices:["Weiter"]},zf,{type:Ff,jump_position:Ge.timelineVariable("position")}],timeline_variables:[{img:"/images/Bus_image_1.png",position:1},{img:"/images/Bus_image_2.png",position:2},{img:"/images/Bus_image_3.png",position:3},{img:"/images/Bus_image_4.png",position:4}],randomize_order:!0},Nn={type:Ht,stimulus:`<p><strong>Anweisungen:</strong></p> 

      <p>Auf der nchsten Seite sehen Sie eine Landschaft, ber der ein Frderband 
      (die horizontale Linie) gespannt wurde. An diesem Frderband ist ein Magnet 
      befestigt, an dessen Ende sich eine Mnze befindet. Das Frderband bewegt sich 
      mit einer konstanten Geschwindigkeit (etwa 30 km/h), sodass die Mnze und der Magnet 
      mit dieser Geschwindigkeit mitgefhrt werden. </p>

      <p>Unter dem Frderband steht eine Schatzbox, in die die Mnze fallen soll. </p>

      <p>Sobald Sie die Leertaste drcken, wird die Mnze losgelassen, whrend sich der 
      Magnet weiterhin vorwrts bewegt.</p>

      <p>Sie haben 4 Versuche.</p>

      <p>Sobald Sie die Leertaste drcken, wird die Mnze freigegeben. 
      Ihre Aufgabe besteht darin, so viele Mnzen wie mglich zu sammeln, 
      indem Sie die Mnze im richtigen Moment loslassen, damit sie in der Schatzbox landet. 
      Nutzen Sie das Feedback nach jedem Versuch, um den Zeitpunkt des Loslassens besser zu 
      kalibrieren.</p>
      
      <p>Klicken Sie auf Weiter, um fortzufahren.</p>     
      `,choices:["Weiter"],post_trial_gap:500},Dn={timeline:[{type:Lf,velocity:Ge.timelineVariable("velocity")}],timeline_variables:[{velocity:5},{velocity:5},{velocity:5},{velocity:5}],randomize_order:!0};console.log(`Condition value: ${_a}`);_a<.5?Tt.push(Gn,zn,Nn,Dn):Tt.push(Nn,Dn,Gn,zn);var Nf={type:Ht,stimulus:`<p><strong>Aufklrung des Studienziels</strong></p> 
      
      <p>Worum ging es in der Studie?</p> 

      <p>In dieser Studie wollen wir das Verstndnis fr fallende Objekte aus sich 
      bewegenden Trgern untersuchen.</p>

      <p>Ein weit verbreitetes Misskonzept ist der straight-down belief, eine 
      systematische intuitive Theorie ber Bewegung, die mit den fundamentalen 
      Newton'schen Gesetzen nicht vereinbar ist.</p>

      <p>Menschen neigen dazu, zu glauben, dass ein Objekt vertikal herunterfllt, 
      wenn es von einem sich bewegenden Trger fallen gelassen wird und unterhalb des 
      Abwurfpunkts auftreffen soll. Dabei wird nicht bercksichtigt, dass sich das Objekt 
      aufgrund seiner Trgheit mit der Geschwindigkeit des sich bewegenden Trgers 
      zustzlich zum Fall weiter nach vorne bewegt und somit in einer Parabel fllt.</p>

      <p>Ihre Antworten helfen uns dieses Misskonzept genauer zu verstehen.</p>

      <p>Vielen Dank fr Ihre Teilnahme!</p>
      `,choices:["Weiter"],post_trial_gap:500};Tt.push(Nf);var Df={type:mi,questions:[{prompt:"Was ist Ihr Geschlecht?",options:["Mnnlich","Weiblich","Divers","Keine Angabe"],name:"Geschlecht",required:!0}],preamble:"<h3>Demografische Informationen</h3><p>Bitte beantworten Sie die folgenden Fragen.</p>"};Tt.push(Df);var Wf={type:pi,questions:[{prompt:"Wie alt sind Sie?",name:"Alter",placeholder:"Zahl eingeben",required:!0},{prompt:"Welchen Studiengang belegen Sie?",name:"Studiengang",placeholder:"Studiengang eingeben",required:!0}],preamble:"<h3>Demografische Informationen</h3><p>Bitte beantworten Sie die folgenden Fragen.</p>"};Tt.push(Wf);Ge.run(Tt);export{Th as $,Wo as A,rt as B,Bt as C,$ as D,I as E,fo as F,ks as G,Or as H,pt as I,Kh as J,nc as K,Ne as L,O as M,X as N,H as O,et as P,Ac as Q,Pi as R,$i as S,Je as T,wi as U,Gr as V,Hs as W,zr as X,kh as Y,ie as Z,K as _,Eo as a,lo as a0,$o as a1,L as a2,N as a3,Mc as a4,Zc as a5,Uc as a6,yu as a7,_u as a8,Su as a9,Cu as aa,Tu as ab,ia as ac,tn as ad,Zr as ae,Tn as af,wt as ag,Md as ah,V as ai,Xt as aj,Kl as ak,Oe as al,jn as am,oa as an,gt as b,Wc as c,Le as d,Q as e,Qr as f,zc as g,gs as h,Wi as i,zo as j,bo as k,yt as l,Lo as m,je as n,gu as o,xu as p,vu as q,ch as r,Pu as s,j as t,Xl as u,Mu as v,U as w,ht as x,no as y,mt as z};
